(this.webpackJsonpcnaviz=this.webpackJsonpcnaviz||[]).push([[0],{112:function(e,t,a){},192:function(e,t,a){},193:function(e,t,a){},194:function(e,t,a){},217:function(e,t,a){},231:function(e,t){},233:function(e,t){},244:function(e,t,a){},246:function(e,t,a){},247:function(e,t,a){},358:function(e,t,a){},359:function(e,t,a){},361:function(e,t,a){"use strict";a.r(t);var r=a(1),s=a.n(r),n=a(196),i=a.n(n),o=(a(217),a(28)),l=a(18),c=a(33),h=a(10),u=a(11),d=a(8),p=a(15),v=a(14),f=a(9),g=a(17),b=a.n(g),m=a(135),S=a.n(m),C=a(6),y=a.n(C),j=function(e){function t(e,a){if(Object(h.a)(this,t),this.start=e,this.end=a,a<e)throw new RangeError("End cannot be less than start");this.start=e,this.end=a}return Object(u.a)(t,[{key:e,value:b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.start;case 2:return e.next=4,this.end;case 4:case"end":return e.stop()}}),e,this)}))},{key:"getLength",value:function(){return this.end-this.start}},{key:"getCenter",value:function(){return.5*(this.start+this.end)}},{key:"hasOverlap",value:function(e){return Math.max(this.start,e.start)<Math.min(this.end,e.end)}},{key:"toString",value:function(){return"[".concat(this.start,", ").concat(this.end,")")}}]),t}(Symbol.iterator),A=function(){function e(t,a,r){if(Object(h.a)(this,e),this.chr=void 0,this._interval=void 0,a<0)throw new RangeError("Start cannot be negative");this.chr=t,this._interval=new j(a,r)}return Object(u.a)(e,[{key:"start",get:function(){return this._interval.start}},{key:"end",get:function(){return this._interval.end}},{key:"getLength",value:function(){return this._interval.getLength()}},{key:"hasOverlap",value:function(e){return this.chr===e.chr&&this._interval.hasOverlap(e._interval)}},{key:"toString",value:function(){return"".concat(this.chr,":").concat(this.start,"-").concat(this.end)}},{key:"endsRoundedToMultiple",value:function(t){if(t<=0)throw new RangeError("Cannot round to a multiple <= 0 (got ".concat(t,")"));return new e(this.chr,Math.floor(this.start/t)*t,Math.ceil(this.end/t)*t)}}],[{key:"parse",value:function(t){var a=t.match(/([\w:]+)\W+(\d+)\W+(\d+)/);if(a)return new e(a[1],Number.parseInt(a[2],10),Number.parseInt(a[3],10));throw new RangeError("Could not parse interval")}}]),e}(),x=a(63),O={toChromosomeInterval:function(e){return new A(e["#CHR"],e.START,e.END)},flattenNestedBins:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=0,r=e.length;a<r;a++){var s=e[a];Array.isArray(s)?this.flattenNestedBins(s,t):t.push(s)}return t}},_=a(51),k=a(59),w=a(5);function D(e,t){t||(t=e.currentTarget);var a=t.getBoundingClientRect();return{x:e.clientX-a.left,y:e.clientY-a.top}}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,r=e;if(a&&(r-=a),r<0)return"";var s=Math.floor(r);return s>=75e4?"".concat((s/1e6).toFixed(t)," Mb"):s>=1e4?"".concat((s/1e3).toFixed(t)," kb"):"".concat(s," bp")}function L(e,t,a){if(e.length!==t.length)throw Error("Calculate Euclidean Distance - pointOne dim does not match pointTwo dim");for(var r=0,s=0;s<e.length;s++){var n=Number(e[s])-Number(t[s]);r+=n*n}return!0===a?Math.sqrt(r):r}var R=function(e){var t=w.e(e);if(null!==t){var a=t.rgb();return[a.r/255,a.g/255,a.b/255,a.opacity]}},T=function(e,t){var a,r=[],s=Object(f.a)(t);try{for(s.s();!(a=s.n()).done;){var n=a.value;r.push(L(e,n,!0))}}catch(i){s.e(i)}finally{s.f()}return y.a.mean(r)},E=function(e,t){var a=[];if(1===t.length)return 0;var r,s=Object(f.a)(t);try{for(s.s();!(r=s.n()).done;){var n=L(e,r.value,!0);0!==n&&a.push(n)}}catch(i){s.e(i)}finally{s.f()}return y.a.mean(a)};function M(e,t,a,r){var s=Object(l.a)(t.keys()),n=new Map;if(1===s.length)return[];for(var i=e.length>0?.01:1,o=0;o<e.length;o++){var c=e[o],h=a[o],u=new Map,d=t.get(h);if(!d)throw new Error("Key error: Cluster not found");if(1!==d.length){var p,v=N(d,i),g=E(c,v),b=1/0,m=Object(f.a)(s);try{for(m.s();!(p=m.n()).done;){var S=p.value;if(S!==h){var C=t.get(S);if(!C)throw new Error("Key error: Cluster not found");var j=N(C,i),A=T(c,j);u.set(Number(S),A),A<b&&(b=A)}}}catch(P){m.e(P)}finally{m.f()}var x=y.a.max([b,g]);if(x){var O=(b-g)/x;if(n.has(h)){var _=n.get(h);_&&(_.push(O),n.set(h,_))}else n.set(h,[O])}r.set(h,u)}else if(n.has(h)){var k=n.get(h);k&&(k.push(0),n.set(h,k))}else n.set(h,[0])}var w,D=[],B=Object(f.a)(s);try{for(B.s();!(w=B.n()).done;){var L=w.value,R=n.get(Number(L));if(void 0!==R){var M={cluster:Number(L),avg:y.a.mean(R)};D.push(M)}}}catch(P){B.e(P)}finally{B.f()}return y.a.sortBy(D,"cluster")}function N(e,t){for(var a=new Set,r=e.length,s=t*r;a.size<s;){var n=e[Math.floor(Math.random()*r)];a.add(n)}return Object(l.a)(a)}var P=function(e){return Array.isArray(e)&&e.every((function(e){return"object"===typeof e&&!(e instanceof Array)}))},F=function(e,t){var a,r=t=t||(a=e,Array.from(a.map((function(e){return Object.keys(e)})).reduce((function(e,t){return new Set([].concat(Object(l.a)(e),Object(l.a)(t)))}),[]))),s=t;P(t)&&(r=t.map((function(e){return e.label})),s=t.map((function(e){return e.key})));var n=e.map((function(e){return s.map((function(t){return I(t,e)}))}));return[r].concat(Object(l.a)(n))},I=function(e,t){var a=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce((function(e,t,a,r){return void 0===e[t]?(r.splice(1),null):e[t]}),t);return void 0===a?e in t?t[e]:"":a},U=function(e){return"undefined"===typeof e||null===e?"":e},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.filter((function(e){return e})).map((function(e){return e.map((function(e){return U(e)})).map((function(e){return"".concat(e)})).join(t)})).join("\n")},G=function(e,t,a,r){if(P(e))return function(e,t,a,r){return Y(F(e,t),a,r)}(e,t,a,r);if(s=e,Array.isArray(s)&&s.every((function(e){return Array.isArray(e)})))return function(e,t,a,r){return Y(t?[t].concat(Object(l.a)(e)):e,a,r)}(e,t,a,r);var s;if("string"===typeof e)return function(e,t,a,r){return t?"".concat(t.join(a),"\n").concat(e):e}(e,t,a);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};function H(e,t,a){return new Promise((function(r,s){for(var n=[],i=[],o=new Map,l=t?"logRD":"RD",c=0;c<a.length;c+=e.length){for(var h=[],u=a[c].CLUSTER,d=c;d<c+e.length;d++){if(!(d<a.length))throw Error("Out of Range Error. There are bins missing in the data (bin must exist across all samples).");var p=a[d];d===c&&i.push(u),h.push(p.reverseBAF),h.push(p[l])}if(n.push(h),o.has(u)){var v=o.get(u);void 0!==v&&(v.push(h),o.set(u,v))}else o.set(u,[h])}r({multiDimData:n,clusterToData:o,labels:i})}))}var z=function(){function e(t){Object(h.a)(this,e),this._rdRanges=void 0,this._logRdRanges=void 0,this._locationGroupedData=void 0,this.brushedBins=void 0,this.brushedCrossfilter=void 0,this.brushedClusterDim=void 0,this._ndx=void 0,this._sample_dim=void 0,this._cluster_dim=void 0,this._chr_dim=void 0,this._genomic_pos_dim=void 0,this._samples=void 0,this._clusters=void 0,this._chrs=void 0,this._sampleGroupedData=void 0,this.clusterTableInfo=void 0,this.allRecords=void 0,this._cluster_filters=void 0,this.historyStack=void 0,this._clusterAmounts=void 0,this.logOfActions=void 0,this.centroids=void 0,this.centroidPts=void 0,this.chrToClusters=void 0,this.centroidDistances=void 0,this.shouldCalculateSilhouttes=void 0,this.currentSilhouttes=void 0,this.overallSilhoutte=void 0,this.clusterDistanceMatrix=void 0,this._locationGroupedData={},this.initializeLocationGroupedData(t),this._sampleGroupedData={},this._rdRanges={},this._logRdRanges={},this._samples=[],this._chrs=[],this._clusters=[],this.brushedBins=[],this.brushedCrossfilter=Object(_.a)(this.brushedBins),this.brushedClusterDim=this.brushedCrossfilter.dimension((function(e){return e.CLUSTER})),this._cluster_filters=[],this.historyStack=[],this._ndx=Object(_.a)(t),this.logOfActions=[],this.centroidPts={},this.centroids=[],this.chrToClusters={},this.centroidDistances={},this.shouldCalculateSilhouttes=!0,this.currentSilhouttes=[],this.clusterDistanceMatrix=new Map,this.overallSilhoutte=0;var a,r=Object(f.a)(t);try{for(r.s();!(a=r.n()).done;){var s=a.value;this.chrToClusters[s["#CHR"]]?this.chrToClusters[s["#CHR"]].add(String(s.CLUSTER)):this.chrToClusters[s["#CHR"]]=new Set([String(s.CLUSTER)])}}catch(K){r.e(K)}finally{r.f()}for(var n=y.a.groupBy(t,"SAMPLE"),i=0,o=Object.entries(n);i<o.length;i++){var l=Object(x.a)(o[i],2),c=l[0],u=l[1];this._samples.push(c);var d=y.a.groupBy(u,"CLUSTER");this._clusters=y.a.union(this._clusters,Object.keys(d));for(var p=0,v=Object.values(d);p<v.length;p++){var g=v[p],b=y.a.groupBy(g,"#CHR");this._chrs=y.a.union(this._chrs,Object.keys(b))}}for(var m=y.a.groupBy(t,"CLUSTER"),S=0,C=Object.entries(m);S<C.length;S++){for(var j=Object(x.a)(C[S],2),A=j[0],O=j[1],w=y.a.groupBy(O,"SAMPLE"),D={},B=0,L=Object.entries(w);B<L.length;B++){var R=Object(x.a)(L[B],2),T=R[0],E=R[1],M=this.calculateCentroid(E,"RD"),N={cluster:parseInt(A),point:M};if(this.centroidPts[T]&&this.centroidPts[A])this.centroidPts[T][A].push(N);else if(this.centroidPts[T])this.centroidPts[T][A]=[N];else{var P={};P[A]=[N],this.centroidPts[T]=P}var F="("+M[0].toFixed(2)+","+M[1].toFixed(2)+")";D[T]=F}var I={key:A,sample:D};this.centroids.push(I)}if(this._cluster_filters=this._clusters,this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this._genomic_pos_dim=this._ndx.dimension((function(e){return e.genomicPosition})),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE"),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),t.length>0){var U,Y=Object(f.a)(this._samples);try{for(Y.s();!(U=Y.n()).done;){var G=U.value,H=this._sampleGroupedData[G],z=[y.a.minBy(H,"RD").RD,y.a.maxBy(H,"RD").RD],X=[y.a.minBy(H,"logRD").logRD,y.a.maxBy(H,"logRD").logRD];this._rdRanges[G]=z,this._logRdRanges[G]=X}}catch(K){Y.e(K)}finally{Y.f()}}this.initializeCentroidDistMatrix(),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.filterRecordsByScales=Object(k.a)(this.filterRecordsByScales)}return Object(u.a)(e,[{key:"setShouldRecalculateSilhouttes",value:function(e){this.shouldCalculateSilhouttes=e}},{key:"getClusterDistanceMatrix",value:function(){return this.clusterDistanceMatrix}},{key:"getAvgSilhoutte",value:function(){return this.overallSilhoutte}},{key:"recalculateSilhouttes",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldCalculateSilhouttes){e.next=16;break}return a=null,e.prev=2,e.next=5,H(this._samples,t,this.allRecords);case 5:a=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return");case 12:r=M(a.multiDimData,a.clusterToData,a.labels,this.clusterDistanceMatrix),this.overallSilhoutte=Number((s=r,y.a.meanBy(s,"avg")).toFixed(3)),this.currentSilhouttes=r,this.shouldCalculateSilhouttes=!1;case 16:return e.abrupt("return",this.currentSilhouttes);case 17:case"end":return e.stop()}var s}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeCentroidDistMatrix",value:function(){var e,t=Object(f.a)(this._samples);try{for(t.s();!(e=t.n()).done;){var a=e.value;this.centroidDistances[a]=[];var r,s=this.getCentroidPoints(a),n=Object(f.a)(s);try{for(n.s();!(r=n.n()).done;){var i,o=r.value,l=Object(f.a)(s);try{for(l.s();!(i=l.n()).done;){var c=i.value,h=L(o.point,c.point);this.centroidDistances[a].push({cluster1:o.cluster,cluster2:c.cluster,dist:h})}}catch(u){l.e(u)}finally{l.f()}}}catch(u){n.e(u)}finally{n.f()}}}catch(u){t.e(u)}finally{t.f()}}},{key:"getCentroidDistMatrix",value:function(e){return this.centroidDistances[e]}},{key:"calculateCentroid",value:function(e,t){return[y.a.meanBy(e,(function(e){return e.reverseBAF})),y.a.meanBy(e,(function(e){return e[t]}))]}},{key:"getCentroidData",value:function(){return this.centroids}},{key:"getCentroidPoints",value:function(e,t){var a,r=this.centroidPts[e],s=this._cluster_filters;a=t?this.chrToClusters[t]:new Set(s);var n,i=[],o=Object(f.a)(s);try{for(o.s();!(n=o.n()).done;){var l=n.value;a.has(l)&&r[l.valueOf()]&&i.push(r[l.valueOf()][0])}}catch(c){o.e(c)}finally{o.f()}return i}},{key:"calculateClusterTableInfo",value:function(){var e,t=this._cluster_dim.group().all(),a=[],r=Object(f.a)(t);try{for(r.s();!(e=r.n()).done;){var s=e.value,n=Number((Number(s.value)/this.allRecords.length*100).toFixed(2));a.push({key:Number(s.key),value:n})}}catch(i){r.e(i)}finally{r.f()}return a}},{key:"initializeLocationGroupedData",value:function(e){this._locationGroupedData={};var t,a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value,s=O.toChromosomeInterval(r).toString();this._locationGroupedData[s]?this._locationGroupedData[s].push(r):this._locationGroupedData[s]=[r]}}catch(n){a.e(n)}finally{a.f()}}},{key:"isEmpty",value:function(){return 0===this.getSampleList().length}},{key:"getRdRange",value:function(e,t){var a=t?this._logRdRanges[e]:this._rdRanges[e];return[a[0],a[1]]}},{key:"getSampleList",value:function(){return this._samples}},{key:"getAllChromosomes",value:function(){return this._chrs}},{key:"getAllClusters",value:function(){return this._clusters}},{key:"setFilters",value:function(e,t,a){t&&this._chr_dim.filter((function(e){return e===t})),a&&this._cluster_dim.filter((function(e){return-1!==a.indexOf(String(e))}))}},{key:"setChrFilter",value:function(e){e?(this._chr_dim.filterAll(),this._chr_dim.filter((function(t){return t===e}))):this._chr_dim.filterAll(),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"setChrFilters",value:function(t){t&&1===t.length&&t[0]===e.ALL_CHRS_KEY?this._chr_dim.filterAll():t&&(this._chr_dim.filterAll(),this._chr_dim.filter((function(e){return-1!==t.indexOf(String(e))})))}},{key:"setClusterFilters",value:function(t){t&&1===t.length&&t[0]===e.ALL_CLUSTERS_KEY?this._cluster_dim.filterAll():t&&(this._cluster_dim.filterAll(),this._cluster_dim.filter((function(e){return-1!==t.indexOf(String(e))}))),t&&(this._cluster_filters=t),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"setGenomicPositionFilter",value:function(e){this._genomic_pos_dim.filterAll(),this._genomic_pos_dim.filter((function(t){return t>e[0]&&t<e[1]})),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"clearAllFilters",value:function(){this._sample_dim.filterAll(),this._cluster_dim.filterAll(),this._chr_dim.filterAll(),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"getActions",value:function(){return this.logOfActions}},{key:"updateCluster",value:function(e){if(this.brushedBins&&0!==this.brushedBins.length){this.historyStack.push(JSON.parse(JSON.stringify(this.brushedBins)));var t=this.brushedTableData(),a="Assigned to cluster "+e+" | ";a+="Clusters selected: ";var r,s=Object(f.a)(t);try{for(s.s();!(r=s.n()).done;){var n=r.value;a+=String(n.key)+" ("+String(n.value)+"%), "}}catch(I){s.e(I)}finally{s.f()}a+=" | ";var i=[y.a.minBy(this.brushedBins,"RD").RD,y.a.maxBy(this.brushedBins,"RD").RD],o=[y.a.minBy(this.brushedBins,"reverseBAF").reverseBAF,y.a.maxBy(this.brushedBins,"reverseBAF").reverseBAF];a+="RD Range of Selected: ["+i[0].toFixed(2)+", "+i[1].toFixed(2)+"] | ",a+="Allelic Imbalance Range of Selected: ["+o[0].toFixed(2)+", "+o[1].toFixed(2)+"]",this.logOfActions.unshift({action:a});for(var l=0;l<this.brushedBins.length;l++){var c=O.toChromosomeInterval(this.brushedBins[l]).toString();if(this._locationGroupedData[c])for(var h=0;h<this._locationGroupedData[c].length;h++)this._locationGroupedData[c][h].CLUSTER=e}var u=Object.values(this._locationGroupedData),d=O.flattenNestedBins(u);this.centroids=[],this.centroidPts={},this.chrToClusters={};var p,v=Object(f.a)(d);try{for(v.s();!(p=v.n()).done;){var g=p.value;this.chrToClusters[g["#CHR"]]?this.chrToClusters[g["#CHR"]].add(String(g.CLUSTER)):this.chrToClusters[g["#CHR"]]=new Set([String(g.CLUSTER)])}}catch(I){v.e(I)}finally{v.f()}for(var b=y.a.groupBy(d,"CLUSTER"),m=0,S=Object.entries(b);m<S.length;m++){for(var C=Object(x.a)(S[m],2),j=C[0],A=C[1],k=y.a.groupBy(A,"SAMPLE"),w={},D=0,B=Object.entries(k);D<B.length;D++){var L=Object(x.a)(B[D],2),R=L[0],T=L[1],E=this.calculateCentroid(T,"RD"),M={cluster:parseInt(j),point:E};if(this.centroidPts[R]&&this.centroidPts[j])this.centroidPts[R][j].push(M);else if(this.centroidPts[R])this.centroidPts[R][j]=[M];else{var N={};N[j]=[M],this.centroidPts[R]=N}var P="("+E[0].toFixed(2)+","+E[1].toFixed(2)+")";w[R]=P}var F={key:j,sample:w};this.centroids.push(F)}this.initializeCentroidDistMatrix(),this._ndx.remove(),this._ndx=Object(_.a)(d),this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this.brushedBins=[],this.brushedCrossfilter.remove(),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.allRecords=this.allRecords.filter((function(e){return-2!==e.CLUSTER})),this._cluster_filters.includes(String(e))||this._cluster_filters.push(String(e)),this.setClusterFilters(this._cluster_filters),this.shouldCalculateSilhouttes=!0}}},{key:"clearClustering",value:function(){this.brushedBins=Object(l.a)(this.allRecords),this.updateCluster(-1)}},{key:"undoClusterUpdate",value:function(){if(0!==this.historyStack.length){var e=this.historyStack[this.historyStack.length-1];this.historyStack.pop();for(var t=0;t<e.length;t++){var a=e[t],r=O.toChromosomeInterval(a).toString(),s=a.CLUSTER;if(this._cluster_filters.includes(String(s))||this._cluster_filters.push(String(s)),this._locationGroupedData[r])for(var n=0;n<this._locationGroupedData[r].length;n++)this._locationGroupedData[r][n].CLUSTER=s}var i=Object.values(this._locationGroupedData),o=O.flattenNestedBins(i);this.initializeCentroidDistMatrix(),this._ndx.remove(),this._ndx=Object(_.a)(o),this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this.brushedBins=[],this.brushedCrossfilter.remove(),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.allRecords=this.allRecords.filter((function(e){return-2!==e.CLUSTER})),this.setClusterFilters(this._cluster_filters),this.setShouldRecalculateSilhouttes(!0)}}},{key:"brushedTableData",value:function(){var e=this._samples.length,t=this._clusterAmounts,a={};t.forEach((function(t){return a[Number(t.key)]=Number(t.value)/e}));var r,s=this.brushedBins.length,n=this.brushedClusterDim.group().all(),i=[],o=this._ndx.all().length,l=Object(f.a)(n);try{for(l.s();!(r=l.n()).done;){var c=r.value;i.push({key:Number(c.key),value:Number((Number(c.value)/Number(a[Number(c.key)])*100).toFixed(2)),selectPerc:Number((Number(c.value)/Number(s)*100).toFixed(2)),binPerc:Number((Number(c.value)/Number(o/e)*100).toFixed(2))})}}catch(h){l.e(h)}finally{l.f()}return i}},{key:"getRecords",value:function(e,t,a,r,s,n){return e in this._sampleGroupedData?this.filterRecordsByScales(this._sampleGroupedData[e],t,a,r,s,n):[]}},{key:"filterRecordsByScales",value:function(e,t,a,r,s,n){var i=t?"logRD":"RD";return a&&r&&s&&n?e.filter((function(e){return e.genomicPosition>a&&e.genomicPosition<r&&e.reverseBAF>s[0]&&e.reverseBAF<s[1]&&e[i]>n[0]&&e[i]<n[1]})):a&&r&&s?e.filter((function(e){return e.genomicPosition>a&&e.genomicPosition<r&&e.reverseBAF>s[0]&&e.reverseBAF<s[1]})):a&&r&&n?e.filter((function(e){return e.genomicPosition>a&&e.genomicPosition<r&&e[i]>n[0]&&e[i]<n[1]})):s&&n?e.filter((function(e){return e.reverseBAF>s[0]&&e.reverseBAF<s[1]&&e[i]>n[0]&&e[i]<n[1]})):s?e.filter((function(e){return e.reverseBAF>s[0]&&e.reverseBAF<s[1]})):n?e.filter((function(e){return e[i]>n[0]&&e[i]<n[1]})):e}},{key:"getAllRecords",value:function(){return this.allRecords}},{key:"getClusterTableInfo",value:function(){return this.clusterTableInfo}},{key:"getFilteredClusters",value:function(){return this._cluster_filters}},{key:"setbrushedBins",value:function(e){console.log("Setting Brushed Bins: ",e.length),this.brushedBins=[],this.brushedBins=e,this.brushedCrossfilter.remove(),this.brushedCrossfilter=Object(_.a)(e),this.brushedClusterDim=this.brushedCrossfilter.dimension((function(e){return e.CLUSTER}))}},{key:"getBrushedBins",value:function(){return this.brushedBins}},{key:"getClusterDim",value:function(){return this._cluster_dim}},{key:"_getData",value:function(e,t,a,r){return(e[t][r]||{})[a]||[]}}]),e}();z.ALL_CHRS_KEY="",z.ALL_CLUSTERS_KEY="";var X=a(61),K=(a(244),a(2)),Q=60,Z=20,V=35,J=60,W="#999999",q="rgba(232, 232, 232, 1)",$="-1",ee="-2",te="scatterplot-scale",ae="circles",re=0,se=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;Object(h.a)(this,a),(r=t.call(this,e))._svg=void 0,r._circleIdPrefix=void 0,r._clusters=void 0,r.brushedNodes=void 0,r.previous_brushed_nodes=void 0,r.quadTree=void 0,r._canvas=void 0,r._currXScale=void 0,r._currYScale=void 0,r._original_XScale=void 0,r._original_YScale=void 0,r._original_transform=void 0,r._current_transform=void 0,r.scatter=void 0,r.zoom=void 0,r.onTrigger=function(e){r.props.parentCallBack(e)},r.onBrushedBinsUpdated=function(e){r.props.onBrushedBinsUpdated(e)},r._svg=null,r._canvas=null,r.scatter=null,r._circleIdPrefix=re,re++,r.computeScales=Object(k.a)(r.computeScales),r.handleMouseMove=r.handleMouseMove.bind(Object(d.a)(r)),r.onTrigger=r.onTrigger.bind(Object(d.a)(r)),r.onBrushedBinsUpdated=r.onBrushedBinsUpdated.bind(Object(d.a)(r)),r._clusters=r.initializeListOfClusters(),r.state={selectedCluster:r._clusters.length>0?r._clusters[0]:$},r.brushedNodes=new Set,r.previous_brushed_nodes=new Set,r.onZoom=r.onZoom.bind(Object(d.a)(r)),r.resetZoom=r.resetZoom.bind(Object(d.a)(r)),r.zoom=null;var s=r.computeScales(r.props.rdRange,e.width,e.height),n=s.bafScale,i=s.rdrScale;r._currXScale=n,r._currYScale=i,r._original_XScale=r._currXScale,r._original_YScale=r._currYScale;var o=e.data;return r.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(t){return t[e.yAxisToPlot]})).addAll(o),r._original_transform=w.o.translate(0,0).scale(1),r._current_transform=r._original_transform,r}return Object(u.a)(a,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;e.sort((function(e,t){return e.key>t.key?1:e.key<t.key?-1:0})),this._clusters=[];var t,a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(s){a.e(s)}finally{a.f()}for(;this._clusters.length>0&&(this._clusters[0]===$||this._clusters[0]===ee);)this._clusters.shift();return this._clusters}},{key:"handleMouseMove",value:function(e){var t=D(e),a=t.x,r=t.y,s={rd:this._currYScale.invert(r),baf:this._currXScale.invert(a)};if(s.baf>this._currXScale.domain()[0]&&s.baf<this._currXScale.domain()[1]&&s.rd>this._currYScale.domain()[0]&&s.rd<this._currYScale.domain()[1]){var n=Math.abs(this._currXScale.invert(a)-this._currXScale.invert(a-20));this.props.onRecordsHovered(this.quadTree.find(s.baf,s.rd,n)||null)}else this.props.onRecordsHovered(null)}},{key:"renderTooltipAtRdBaf",value:function(e,t,a){if(!a)return null;var r=this._currYScale(e)||0,s=(this._currXScale(t)||0)+10;return Object(K.jsx)("div",{className:"Scatterplot-tooltip",style:{position:"absolute",top:r-150,left:s,width:275,height:150,pointerEvents:"none"},children:a})}},{key:"renderTooltip",value:function(){var e=this.props,t=e.data,a=e.hoveredLocation,r=e.yAxisToPlot;if(!a)return null;var n=[];if(0===(n=t.filter((function(e){var t=O.toChromosomeInterval(e);return a.chr===t.chr&&a.start===t.start&&a.end===t.end}))).length&&(n=t.filter((function(e){return O.toChromosomeInterval(e).hasOverlap(a)}))),n[0]){var i=this._currXScale(n[0].reverseBAF),o=this._currYScale(n[0][r]),l=this._currXScale.range(),c=this._currYScale.range();if(1===n.length&&i&&o&&i>l[0]&&i<l[1]&&o<c[0]&&o>c[1]){var h=n[0],u=O.toChromosomeInterval(h);return this.renderTooltipAtRdBaf(h[r],h.reverseBAF,Object(K.jsxs)(s.a.Fragment,{children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{children:u.toString()}),Object(K.jsx)("br",{}),"(",B(u.getLength()),")"]}),Object(K.jsxs)("div",{children:[" RDR: ",h[r].toFixed(2)]}),Object(K.jsxs)("div",{children:[" 0.5 - BAF: ",h.reverseBAF.toFixed(2)]}),Object(K.jsxs)("div",{children:[" Cluster ID: ",h.CLUSTER]})]}))}}return null}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,r=t.height,s=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));return s.unshift(Object(K.jsx)("option",{value:$,children:$},$)),s.unshift(Object(K.jsx)("option",{value:ee,children:ee},ee)),Object(K.jsxs)("div",{ref:function(t){return e.scatter=t},className:"Scatterplot",style:{width:a,height:r},children:[Object(K.jsx)("canvas",{ref:function(t){return e._canvas=t},width:a,height:r,className:"canvas",style:{position:"absolute",top:V,zIndex:-4,left:Q,width:a-Q-Z,height:r-V-J}}),Object(K.jsx)("svg",{ref:function(t){return e._svg=t},style:{zIndex:100},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+a+" "+r,onMouseMove:this.handleMouseMove}),Object(K.jsx)("div",{className:"Scatterplot-tools",children:Object(K.jsx)("button",{className:"custom-button",onClick:this.resetZoom,children:"Reset View"})}),this.renderTooltip()]})}},{key:"resetZoom",value:function(){if(this._svg){this._currXScale=this._original_XScale,this._currYScale=this._original_YScale;var e={xScale:this._currXScale.domain(),yScale:this._currYScale.domain()};this.props.onZoom(e),this.redraw()}}},{key:"componentDidMount",value:function(){this.redraw(),this.forceHover(this.props.hoveredLocation)}},{key:"propsDidChange",value:function(e,t){var a=this;return t.some((function(t){return a.props[t]!==e[t]}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(!this.props.scales.xScale&&!this.props.scales.yScale&&e.scales.xScale&&e.scales.yScale)this.resetZoom();else if(this.props.scales.xScale&&e.scales.xScale&&this.props.scales.xScale[0]!==e.scales.xScale[0]&&this.props.scales.xScale[1]!==e.scales.xScale[1]||this.props.scales.xScale&&!e.scales.xScale)this._currXScale.domain(this.props.scales.xScale),this.props.scales.yScale&&this._currYScale.domain(this.props.scales.yScale),this.redraw();else if(this.props.scales.yScale&&e.scales.yScale&&this.props.scales.yScale[0]!==e.scales.yScale[0]&&this.props.scales.yScale[1]!==e.scales.yScale[1]||this.props.scales.yScale&&!e.scales.yScale)this.props.scales.xScale&&this._currXScale.domain(this.props.scales.xScale),this._currYScale.domain(this.props.scales.yScale),this.redraw();else if(this.props.assignCluster)this.onTrigger(this.state.selectedCluster),this.brushedNodes=new Set;else if(this.props.hoveredLocation!==e.hoveredLocation)this.forceUnhover(),this.forceHover(this.props.hoveredLocation);else if(this.propsDidChange(e,["showCentroids","displayMode","colors","brushedBins","width","height"])){var a=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(a),this.redraw(),this.forceHover(this.props.hoveredLocation)}else if(!y.a.isEqual(this.props.data,e.data)||this.props.yAxisToPlot!==e.yAxisToPlot){var r=this.computeScales(this.props.rdRange,this.props.width,this.props.height),s=r.bafScale,n=r.rdrScale;if(this._currXScale.domain()[0]===this._original_XScale.domain()[0]&&this._currXScale.domain()[1]===this._original_XScale.domain()[1]&&this._currYScale.domain()[0]===this._original_YScale.domain()[0]&&this._currYScale.domain()[1]===this._original_YScale.domain()[1])this._currXScale=s,this._currYScale=n,this._original_XScale=this._currXScale,this._original_YScale=this._currYScale;else{if(this.props.yAxisToPlot!==e.yAxisToPlot){var i=this._currYScale.domain();if("logRD"===this.props.yAxisToPlot){i[0]<=0&&(i[0]=.1),i[1]<=0&&(i[1]=.1);var o=[Math.log2(i[0]),Math.log2(i[1])];this._currYScale=w.i().domain(o).range(this._currYScale.range())}else{var l=[Math.pow(2,i[0]),Math.pow(2,i[1])];this._currYScale=w.i().domain(l).range(this._currYScale.range())}}this._original_XScale=s,this._original_YScale=n}var c=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(c);var h={xScale:this._currXScale.domain(),yScale:this._currYScale.domain()};this.props.onZoom(h),this.redraw(),this.forceHover(this.props.hoveredLocation)}this.props.clusterTableData!==e.clusterTableData&&this.initializeListOfClusters()}},{key:"computeScales",value:function(e,t,a,r,s){var n=[Q,t-Z],i=[a-J,V],o=s?e[0]:this.props.applyLog?-2:0,l=r||[-1e-4,.5001];return{bafScale:w.i().domain(l).range(n),rdrScale:w.i().domain([o,e[1]]).range(i)}}},{key:"onZoom",value:function(e){this.props.onZoom(e)}},{key:"redraw",value:function(){var e=this;if(this._svg&&this._canvas&&this.scatter){var t=this,a=this.props,r=a.width,s=a.height,n=a.customColor,i=a.brushedBins,o=a.data,c=a.colors,h=a.yAxisToPlot,u=a.centroidPts,d=this.props.displayMode,p=this._currXScale,v=this._currYScale,g="RD"===h?"RDR":"log RDR",b=w.j(this._svg);b.selectAll(".scatterplot-scale").remove(),b.append("text").classed(te,!0).attr("text-anchor","middle").attr("x",y.a.mean(this._currXScale.range())).attr("y",s-J+40).style("text-anchor","middle").text("Allelic Imbalance (0.5 - BAF)"),b.append("text").classed(te,!0).attr("y",Q-40).attr("x",0-y.a.mean(this._currYScale.range())).attr("transform","rotate(-90)").style("text-anchor","middle").text(g);var m=function(e,t){return e.classed(te,!0).attr("transform","translate(0, ".concat(s-J,")")).call(w.a(t))},S=function(e,t){return e.classed(te,!0).attr("transform","translate(".concat(Q,", 0)")).call(w.b(t))},C=[];i.forEach((function(e){return C.push(O.toChromosomeInterval(e).toString())})),this.previous_brushed_nodes=new Set(C);var j=this.previous_brushed_nodes,A=b.append("g"),x=b.append("g"),_=w.o,k=w.n().scaleExtent([0,100]),D=w.n().scaleExtent([0,100]),B=function(){return w.p(A.node())},L=function(){return w.p(x.node())};A.call(k).attr("pointer-events","none"),x.call(D).attr("pointer-events","none");var T=w.n().on("zoom",(function(){try{var e=w.f.transform,t=e.k/_.k,a=function(e){if(e.sourceEvent)return[e.sourceEvent.layerX,e.sourceEvent.layerY];return[r/2,s/2]}(w.f),n=a[0]>p.range()[0],i=a[1]<v.range()[0];d!==st.zoom&&n&&i||(1===t?(n&&k&&t&&a&&A&&A.call(k.translateBy,(e.x-_.x)/B().k,0),i&&D&&t&&a&&x&&x.call(D.translateBy,0,(e.y-_.y)/L().k)):(n&&k&&t&&a&&A&&A.call(k.scaleBy,t,a),i&&D&&t&&a&&x&&x.call(D.scaleBy,t,a))),_=e,$()}catch(o){console.log("Error: ",o)}})).on("end",(function(){var e={xScale:t._currXScale.domain(),yScale:t._currYScale.domain()};t.props.onZoom(e)})),E=this._canvas.getContext("webgl");E.clearColor(0,0,0,1);var M,N=[],P=Object(f.a)(o);try{for(P.s();!(M=P.n()).done;){var F=M.value;j.has(O.toChromosomeInterval(F).toString())||N.push(F)}}catch(ee){P.e(ee)}finally{P.f()}var I,U=Object(f.a)(o);try{for(U.s();!(I=U.n()).done;){var Y=I.value;j.has(O.toChromosomeInterval(Y).toString())&&N.push(Y)}}catch(ee){U.e(ee)}finally{U.f()}var G=X.webglFillColor().value((function(e){return R(function(e){if(j.has(O.toChromosomeInterval(e).toString()))return n;if(-1===e.CLUSTER)return W;if(-2===e.CLUSTER)return q;var t=e.CLUSTER%c.length;return c[t]}(e))})).data(N),H=X.seriesWebglPoint().xScale(t._currXScale).yScale(t._currYScale).size(3).crossValue((function(e){return e.reverseBAF})).mainValue((function(e){return e[h]})).context(E);if(H.decorate((function(e){G(e),E.depthFunc(E.NEVER),E.disable(E.DEPTH_TEST)})),b.append("clipPath").attr("id","clip").append("rect").attr("x",Q).attr("y",V).attr("width",r-Z-Q).attr("height",s-J-V),b.append("g").classed("eventrect",!0).append("rect").attr("x",Q).attr("y",V).attr("width",r-Z-Q).attr("height",s-J-V).style("fill","none").style("pointer-events","all").attr("clip-path","url(#clip)"),this._canvas.width=r,this._canvas.height=s,$(),d===st.select||d===st.erase){var z=w.c().keyModifiers(!1).extent([[Q-2,V-2],[this.props.width-Z+2,this.props.height-J+2]]).on("end",(function(){e.updatePoints(w.f),b.selectAll(".brush").remove(),e.onBrushedBinsUpdated(Object(l.a)(e.brushedNodes))}));b.append("g").attr("class","brush").call(z)}else if(d===st.zoom)b.selectAll(".brush").remove();else if(d===st.boxzoom){var K=w.c().keyModifiers(!1).extent([[Q-2,V-2],[this.props.width-Z+2,this.props.height-J+2]]).on("start brush",(function(){return e.updatePoints(w.f)})).on("end",(function(){b.selectAll(".brush").remove(),function(){if(!t._svg)return;if(t.props.data){var e=w.f.selection;if(e){var a=[Number(t._currYScale.invert(e[1][1])),Number(t._currYScale.invert(e[0][1]))],n=[Number(t._currXScale.invert(e[0][0])),Number(t._currXScale.invert(e[1][0]))],i=t.computeScales(a,r,s,n,!0),o=i.bafScale,l=i.rdrScale;t._currXScale=o,t._currYScale=l,t.redraw();var c={xScale:t._currXScale.domain(),yScale:t._currYScale.domain()};t.props.onZoom(c)}}}()}));b.append("g").attr("class","brush").call(K)}b.call(T).call(T.transform,w.o.scale(1))}function $(){E.clear(E.COLOR_BUFFER_BIT),E.clearColor(255,255,255,1);var e=B().rescaleX(p),a=L().rescaleY(v);A.call(m,e),x.call(S,a),t._currXScale=e,t._currYScale=a,t._canvas&&(H.xScale(t._currXScale).yScale(t._currYScale),H(N)),b.select(".Centroids").remove(),t.props.showCentroids&&b.select(".eventrect").append("g").attr("clip-path","url(#clip)").classed("Centroids",!0).selectAll("path").data(u).enter().append("path").attr("class","point").attr("d",w.k().type(w.m)).attr("fill",(function(e){return function(e){if(-1===e)return W;if(-2===e)return q;var t=e%c.length;return c[t]}(e.cluster)})).attr("fill-opacity",1).attr("stroke-width",2).attr("stroke","black").attr("transform",(function(e){return"translate("+t._currXScale(e.point[0])+","+t._currYScale(e.point[1])+")"}))}}},{key:"updatePoints",value:function(e){var t=this;if(this._svg){var a=this.props,r=a.brushedBins,s=a.data,n=a.yAxisToPlot,i=a.displayMode;if(s){var o=w.f.selection;if(o){var l=s.filter((function(e){return a=o,r=[t._currXScale(e.reverseBAF),t._currYScale(e[n])],a[0][0]<=r[0]&&r[0]<=a[1][0]&&a[0][1]<=r[1]&&r[1]<=a[1][1];var a,r}));l&&(i===st.select?l=y.a.uniqBy(y.a.union(l,r),(function(e){return e["#CHR"]+"_"+e.START})):i===st.erase&&(l=y.a.difference(r,l)),this.brushedNodes=new Set(l))}else this.brushedNodes=new Set([])}}}},{key:"getElementsForGenomeLocation",value:function(e){var t=this;if(!this._svg||!e||!this._canvas)return[];var a=this.props,r=a.data,s=a.yAxisToPlot,n=[];n=r.filter((function(t){var a=O.toChromosomeInterval(t);return e.chr===a.chr&&e.start===a.start&&e.end===a.end}));var i=this._currXScale.range(),o=this._currYScale.range();0===n.length&&(n=(n=r.filter((function(t){return O.toChromosomeInterval(t).hasOverlap(e)}))).filter((function(e){var a=t._currXScale(e.reverseBAF),r=t._currYScale(e[s]);return a&&r&&a>i[0]&&a<i[1]&&r<o[0]&&r>o[1]})));var l=w.j(this._svg);l.select(".circles").remove(),l.select(".eventrect").append("g").classed(ae,!0).selectAll("circle").data(n).enter().append("circle").attr("id",(function(e){return t._circleIdPrefix+O.toChromosomeInterval(e).toString()})).attr("cx",(function(e){return t._currXScale(e.reverseBAF)||0})).attr("cy",(function(e){return t._currYScale(e[s])||0})).attr("r",3).attr("fill",(function(e){if(t.previous_brushed_nodes.has(O.toChromosomeInterval(e).toString()))return t.props.customColor;if(-1===e.CLUSTER)return W;if(-2===e.CLUSTER)return q;var a=e.CLUSTER%t.props.colors.length;return t.props.colors[a]})).attr("fill-opacity",1).attr("stroke-width",2).attr("stroke","black")}},{key:"forceHover",value:function(e){this.getElementsForGenomeLocation(e)}},{key:"forceUnhover",value:function(){this._svg&&w.j(this._svg).select(".circles").remove()}}]),a}(s.a.Component);se.defaultProps={width:400,height:302,onNewCurveState:y.a.noop,onRecordHovered:y.a.noop};var ne=a(208),ie=(a(246),["onMouseMove","onMouseLeave","style","children"]),oe=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={mouseCoordinates:null},r.storeMouseCoordinates=r.storeMouseCoordinates.bind(Object(d.a)(r)),r.clearMouseCoordinates=r.clearMouseCoordinates.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"storeMouseCoordinates",value:function(e){this.setState({mouseCoordinates:D(e)}),this.props.onMouseMove&&this.props.onMouseMove(e)}},{key:"clearMouseCoordinates",value:function(e){this.setState({mouseCoordinates:null}),this.props.onMouseLeave&&this.props.onMouseLeave(e)}},{key:"render",value:function(){var e=this.props,t=(e.onMouseMove,e.onMouseLeave,e.style),a=e.children,r=Object(ne.a)(e,ie),s=Object.assign({position:"relative"},t);return Object(K.jsxs)("div",Object(o.a)(Object(o.a)({onMouseMove:this.storeMouseCoordinates,onMouseLeave:this.clearMouseCoordinates,style:s},r),{},{children:[a,this.state.mouseCoordinates&&Object(K.jsx)(le,{where:this.state.mouseCoordinates})]}))}}]),a}(s.a.Component);function le(e){var t=e.where,a=t.x,r={top:t.y-1,willChange:"top"},n={left:a-1,willChange:"left"};return Object(K.jsxs)(s.a.Fragment,{children:[Object(K.jsx)("div",{className:"Bullseye-horizontal-line",style:r}),Object(K.jsx)("div",{className:"Bullseye-vertical-line",style:n})]})}a(112);var ce=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).handleCallBack=function(e){r.props.parentCallBack(e)},r.state={selectedSample:e.initialSelectedSample},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleRecordsHovered=r.handleRecordsHovered.bind(Object(d.a)(r)),r.handleCallBack=r.handleCallBack.bind(Object(d.a)(r)),r.handleUpdatedBrushedBins=r.handleUpdatedBrushedBins.bind(Object(d.a)(r)),r.onRemovePlot=r.onRemovePlot.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e.target.value}),this.props.onSelectedSample(e.target.value)}},{key:"handleRecordsHovered",value:function(e){var t=e?O.toChromosomeInterval(e):null;this.props.onLocationHovered(t)}},{key:"handleUpdatedBrushedBins",value:function(e){this.props.onBrushedBinsUpdated(e)}},{key:"onRemovePlot",value:function(){this.props.onRemovePlot(this.props.plotId)}},{key:"render",value:function(){var e=this.props,t=e.data,a=e.width,r=e.height,s=e.hoveredLocation,n=e.invertAxis,i=e.customColor,o=e.assignCluster,l=e.brushedBins,c=e.updatedBins,h=e.dispMode,u=e.onZoom,d=e.rdRange,p=e.clusterTableData,v=e.applyLog,f=e.scales,g=e.centroidPts,b=e.showCentroids;return Object(K.jsx)("div",{className:"SampleViz-scatter",children:Object(K.jsx)(oe,{className:"SampleViz-pane",children:Object(K.jsx)(se,{parentCallBack:this.handleCallBack,data:t,rdRange:d,width:a,height:r,hoveredLocation:s,onRecordsHovered:this.handleRecordsHovered,invertAxis:n||!1,customColor:i,colors:this.props.colors,col:this.props.colors[0],assignCluster:o,onBrushedBinsUpdated:this.handleUpdatedBrushedBins,brushedBins:l,updatedBins:c,displayMode:h,onZoom:u,clusterTableData:p,applyLog:v,yAxisToPlot:v?"logRD":"RD",onClusterSelected:this.props.onClusterSelected,scales:f,centroidPts:g,showCentroids:b})})})}}]),a}(s.a.Component);ce.defaultProps={onLocationHovered:y.a.noop,invertAxis:!1,customColor:"#1b9e77"};a(247);var he="linearplot-scale",ue="#999999",de="rgba(232, 232, 232, 1)",pe=50,ve=10,fe=10,ge=35;var be=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e))._svg=void 0,r._canvas=void 0,r._clusters=void 0,r.brushedNodes=void 0,r._currXScale=void 0,r._currYScale=void 0,r._original_XScale=void 0,r._original_YScale=void 0,r.previewDriver=void 0,r.lockedDrivers=void 0,r._svg=null,r._canvas=null,r.getXScale=Object(k.a)(r.getXScale),r.handleMouseMove=r.handleMouseMove.bind(Object(d.a)(r)),r.handleMouseLeave=r.handleMouseLeave.bind(Object(d.a)(r)),r._clusters=r.initializeListOfClusters(),r.brushedNodes=new Set,r._currXScale=r.getXScale(e.width,e.genome,e.chr,r.props.implicitStart,r.props.implicitEnd),r._currYScale=w.i().domain([r.props.yMin,r.props.yMax]).range([r.props.height-ge,fe]),r._original_XScale=r._currXScale,r._original_YScale=r._currYScale,r.previewDriver=null,r.lockedDrivers=new Set,r}return Object(u.a)(a,[{key:"initializeListOfClusters",value:function(){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),t=Object(l.a)(new Set(this.props.data.map((function(e){return String(e.CLUSTER)})))).sort(e.compare);return"-2"===t[0]&&t.shift(),"-1"===t[0]&&t.shift(),t}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"propsDidChange",value:function(e,t){var a=this;return t.some((function(t){return a.props[t]!==e[t]}))}},{key:"componentDidUpdate",value:function(e){null!==this.props.driverGeneUpdate.gene&&this.props.driverGeneUpdate.destination===this.props.dataKeyToPlot&&(this.lockedDrivers.has(this.props.driverGeneUpdate.gene)?this.lockedDrivers.delete(this.props.driverGeneUpdate.gene):this.lockedDrivers.add(this.props.driverGeneUpdate.gene),this.props.handleDriverGenesChange({gene:null,destination:null})),this.propsDidChange(e,["chr"])?"RD"===this.props.dataKeyToPlot||"logRD"===this.props.dataKeyToPlot?this.props.onLinearPlotZoom(null,null,!0):this.props.onLinearPlotZoom(null,null,!1):this.propsDidChange(e,["driverGenes","displayMode","implicitEnd","implicitStart","yMin","yMax","colors","brushedBins","width","height","chr"])?(0===this.props.brushedBins.length&&(this._clusters=this.initializeListOfClusters()),this.redraw()):y.a.isEqual(this.props.data,e.data)&&this.props.dataKeyToPlot===e.dataKeyToPlot||this.redraw()}},{key:"getXScale",value:function(e,t,a,r,s){var n=[0,0];return null!=r&&null!=s?(n[0]=r,n[1]=s):a?(n[0]=t.getChrStartMap()[a],n[1]=n[0]+t.getLength(a)):n[1]=t.getLength(),w.i().domain(n).range([pe,e-ve])}},{key:"createNewBrush",value:function(){var e=w.j(this._svg),t=w.c().keyModifiers(!0).extent([[pe,fe],[this.props.width-ve,this.props.height-ge]]).on("end",(function(){e.selectAll(".brush").remove()}));e.append("g").attr("class","brush").call(t)}},{key:"redraw",value:function(){var e=this;if(this._svg){var t,a=this,r=this.props,s=r.data,n=r.width,i=r.height,o=r.genome,c=r.chr,h=r.dataKeyToPlot,u=r.yMin,d=r.yMax,p=r.yLabel,v=r.customColor,g=r.brushedBins,b=r.colors,m=r.displayMode,S=r.driverGenes,C=this.getXScale(n,o,c,this.props.implicitStart,this.props.implicitEnd),j=w.i().domain([u,d]).range([i-ge,fe]),A=o.getChromosomeList(),x=[],_=o.getChrStartMap(),k=Object(f.a)(A);try{for(k.s();!(t=k.n()).done;){var D=t.value,L=_[D.name];L>=C.domain()[0]&&L<=C.domain()[1]&&x.push(D)}}catch(te){k.e(te)}finally{k.f()}var T=w.j(this._svg);T.selectAll(".linearplot-scale").remove(),T.append("text").classed(he,!0).attr("text-anchor","middle").attr("font-size",11).attr("x",y.a.mean(C.range())).attr("y",i-ge+30).text(c||o.getName()),T.append("text").classed(he,!0).attr("transform","rotate(-90, ".concat(pe,", ").concat(y.a.mean(j.range()),")")).text(p||h).attr("x",(i-ge-fe)/2-1).attr("y",pe/2+5).attr("text-anchor","middle");var E=function(e,t){return e.classed(he,!0).attr("transform","translate(0, ".concat(i-ge,")")).call(w.a(t).tickValues(o.getChromosomeStarts2(x,t.domain()[0],t.domain()[1])).tickFormat((function(e,t){return function(e){var t=e.match(/\d+/);return t?t[0]:e}(x[t].name)})))},M=function(e,t){return e.classed(he,!0).attr("transform","translate(0, ".concat(i-ge,")")).call(w.a(t).tickFormat((function(e){return B(Number(e.valueOf()),0,_[c])})))},N=function(e,t){return e.classed(he,!0).attr("transform","translate(".concat(pe,", 0)")).call(w.b(t).ticks((t.range()[0]-t.range()[1])/15))},P=T.append("g"),F=T.append("g"),I=w.o,U=w.n().scaleExtent([0,100]),Y=w.n().scaleExtent([0,100]),G=function(){return w.p(P.node())},H=function(){return w.p(F.node())};P.call(U).attr("pointer-events","none"),F.call(Y).attr("pointer-events","none");var z=w.n().on("zoom",(function(){try{var e=w.f.transform,t=e.k/I.k,a=function(e){if(e.sourceEvent)return[e.sourceEvent.layerX,e.sourceEvent.layerY];return[n/2,i/2]}(w.f),r=a[0]>C.range()[0],s=a[1]<j.range()[0];m!==st.zoom&&r&&s||(1===t?(r&&U&&t&&a&&P&&P.call(U.translateBy,(e.x-I.x)/G().k,0),s&&Y&&t&&a&&F&&F.call(Y.translateBy,0,(e.y-I.y)/H().k)):(r&&U&&t&&a&&P&&P.call(U.scaleBy,t,a),s&&Y&&t&&a&&F&&F.call(Y.scaleBy,t,a))),I=e,ee()}catch(o){console.log("Error: ",o)}})).on("end",(function(){"RD"===e.props.dataKeyToPlot||"logRD"===e.props.dataKeyToPlot?a.props.onLinearPlotZoom([a._currXScale.domain()[0],a._currXScale.domain()[1]],[a._currYScale.domain()[0],a._currYScale.domain()[1]],!0):a.props.onLinearPlotZoom([a._currXScale.domain()[0],a._currXScale.domain()[1]],[a._currYScale.domain()[0],a._currYScale.domain()[1]],!1)}));if(this._canvas){this._canvas.width=800,this._canvas.height=150;var K=[];g.forEach((function(e){return K.push(O.toChromosomeInterval(e).toString())}));var Q=new Set(K),Z=this._canvas.getContext("webgl");Z.clearColor(0,0,0,1);var V=X.webglFillColor().value((function(e){return R(function(e){if(Q.has(O.toChromosomeInterval(e).toString()))return v;if(-1===e.CLUSTER)return ue;if(-2===e.CLUSTER)return de;var t=e.CLUSTER%b.length;return b[t]}(e))})).data(this.props.data),J=X.seriesWebglPoint().size(3).crossValue((function(e){return o.getImplicitCoordinates(O.toChromosomeInterval(e)).getCenter()})).mainValue((function(e){return e[h]})).context(Z);J.decorate((function(e){return V(e)})),T.append("clipPath").attr("id","clip2").append("rect").attr("x",pe).attr("y",fe).attr("width",n).attr("height",i).attr("fill","red"),T.append("g").classed("eventrect",!0).append("rect").attr("x",pe).attr("y",fe).attr("width",n-ve-pe).attr("height",i-ge-fe).style("fill","none").style("pointer-events","all").attr("clip-path","url(#clip2)");var W=function(e){a.previewDriver=e},q=function(e){a.previewDriver=null};ee();var $=null;m===st.select||m===st.erase?($=w.c().keyModifiers(!1).extent([[pe,fe],[this.props.width,this.props.height-ge]]).on("start brush",(function(){var t=w.f.selection;if(t&&t[0][0]!==t[1][0]&&t[0][1]!==t[1][1]){var a=s.filter((function(e){var a,r,s=O.toChromosomeInterval(e),n=o.getImplicitCoordinates(s);return a=t,r=[C(n.getCenter()),j(e[h])],a[0][0]<=r[0]&&r[0]<=a[1][0]&&a[0][1]<=r[1]&&r[1]<=a[1][1]}));a&&(m===st.select?a=y.a.uniqBy(y.a.union(a,g),(function(e){return e["#CHR"]+"_"+e.START})):m===st.erase&&(a=y.a.difference(g,a)),e.brushedNodes=new Set(a))}else e.brushedNodes=new Set([])})).on("end",(function(){T.selectAll(".brush").remove(),e.props.onBrushedBinsUpdated(Object(l.a)(e.brushedNodes))})),T.append("g").attr("class","brush").call($)):m!==st.boxzoom&&m!==st.zoom||($=w.d().extent([[pe,fe],[this.props.width,this.props.height-ge]]).on("end",(function(){T.selectAll(".brush").remove();var t=w.f.selection;try{var r={start:t[0],end:t[1]},s=C.invert(r.start),n=C.invert(r.end);"RD"===e.props.dataKeyToPlot||"logRD"===e.props.dataKeyToPlot?e.props.onLinearPlotZoom([s,n],[a._currYScale.domain()[0],a._currYScale.domain()[1]],!0):e.props.onLinearPlotZoom([s,n],[a._currYScale.domain()[0],a._currYScale.domain()[1]],!1)}catch(i){}})),T.append("g").attr("class","brush").call($)),T.call(z).call(z.transform,w.o.scale(1))}}function ee(){Z.clear(Z.COLOR_BUFFER_BIT),Z.clearColor(255,255,255,1);var e=H().rescaleY(j);if(F.call(N,e),a._currYScale=e,c){var t=G().rescaleX(C);P.call(M,t),a._currXScale=t,J.xScale(t).yScale(e)}else{var r=G().rescaleX(C);P.call(E,r),a._currXScale=r,J.xScale(r).yScale(e)}J(s),S&&(T.select(".Drivers").remove(),T.select(".eventrect").append("g").attr("clip-path","url(#clip2)").classed("Drivers",!0).selectAll("circle").data(S).enter().append("circle").attr("class","point").attr("d",w.k().type(w.l)).attr("fill","red").attr("fill-opacity",1).attr("stroke-width",2).attr("r",2).attr("transform",(function(t){return"translate("+a._currXScale(o.getImplicitCoordinates(t.location).getCenter())+","+((a._currYScale(e.domain()[0])||0)+3)+")"})).on("mouseover",W).on("mouseleave",q).on("click",(function(e){var t="";t="reverseBAF"===h&&a.props.applyLog?"logRD":"reverseBAF"===h?"RD":"reverseBAF",a.lockedDrivers.has(e)?a.lockedDrivers.delete(e):a.lockedDrivers.add(e),a.props.handleDriverGenesChange({gene:e,destination:t})})))}}},{key:"renderHighlight",value:function(){var e=this.props,t=e.width,a=e.genome,r=e.chr,s=e.hoveredLocation;if(!s)return null;if(null!=this.previewDriver)return null;var n=this.getXScale(t,a,r,this.props.implicitStart,this.props.implicitEnd),i=a.getImplicitCoordinates(s),o=n(i.start),l=Math.ceil((n(i.end)||0)-(o||0));return Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:o,width:l,height:"100%",backgroundColor:"rgba(0,0,0,1)",border:"1px solid rgba(0,0,0,1)",zIndex:1}})}},{key:"handleMouseMove",value:function(e){var t=this.props,a=t.width,r=t.genome,s=t.chr,n=t.onLocationHovered,i=this.getXScale(a,r,s,this.props.implicitStart,this.props.implicitEnd),o=i.range(),l=D(e).x;if(l<o[0]||l>o[1])this.handleMouseLeave();else{var c=i.invert(l);n(r.getChromosomeLocation(c))}}},{key:"handleMouseLeave",value:function(){this.props.onLocationHovered(null)}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,r=t.height,s=t.dataKeyToPlot;return Object(K.jsxs)("div",{className:"LinearPlot",style:{position:"relative",width:a,height:r},onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[this.renderLockedDrivers(),this.renderTooltip(),this.renderHighlight(),Object(K.jsx)("canvas",{ref:function(t){return e._canvas=t},width:a,height:r,className:"canvas",style:{position:"absolute",top:fe,zIndex:-1,left:pe,width:a-pe-ve,height:r-fe-ge}}),Object(K.jsx)("svg",{ref:function(t){return e._svg=t},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+a+" "+r}),Object(K.jsx)("div",{className:"LinearPlot-tools",children:("RD"===s||"logRD"===s)&&Object(K.jsx)("button",{className:"custom-button linear-plot-button",onClick:function(){e.props.onLinearPlotZoom(null,null,!0,!0)},children:"Reset View"})})]})}},{key:"renderLockedDrivers",value:function(){var e=this,t=this.props,a=t.width,r=t.genome,n=t.chr,i=t.height,o=!1;null!=this.previewDriver&&this.lockedDrivers.has(this.previewDriver)&&(this.lockedDrivers.delete(this.previewDriver),o=!0);var c=Object(l.a)(this.lockedDrivers).sort((function(e,t){return e.location.start-t.location.start}));null!=this.previewDriver&&o&&this.lockedDrivers.add(this.previewDriver);var h=[];return c.map((function(t,o){var l,c=e.getXScale(a,r,n,e.props.implicitStart,e.props.implicitEnd),u=r.getImplicitCoordinates(t.location),d=c(u.start)||0,p=Math.ceil((c(u.end)||0)-(d||0)),v=t.symbol,g=Object(K.jsx)(s.a.Fragment,{children:Object(K.jsxs)("div",{children:[" ",v," "]})}),b=!0,m=v.length>4?40+5*(v.length-4):40,S=[d-m/2,d+m/2],C=Object(f.a)(h);try{for(C.s();!(l=C.n()).done;){var y=l.value;if(y[0]>S[0]&&y[0]<S[1]){b=!1;break}if(S[0]>y[0]&&S[0]<y[1]){b=!1;break}}}catch(j){C.e(j)}finally{C.f()}return b&&h.push(S),d>pe&&d<a-ve?Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{style:{position:"absolute",left:d-m/2,width:m,bottom:i,border:"1px solid rgba(0,0,0,0)",zIndex:o,pointerEvents:"none",display:b?"":"none"},children:g}),Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:d,width:p,height:"75%",backgroundColor:"rgba(255,165,0,1)",border:"1px solid rgba(255,165,0,1)",zIndex:o}})]},e.props.dataKeyToPlot+v):null}))}},{key:"renderTooltip",value:function(){var e=this.props,t=e.driverGenes,a=e.hoveredLocation,r=e.width,n=e.genome,i=e.chr,o=e.height;if(!a)return null;if(!t)return null;if(!this.previewDriver)return null;var l=this.getXScale(r,n,i,this.props.implicitStart,this.props.implicitEnd),c=n.getImplicitCoordinates(this.previewDriver.location),h=l(c.start)||0,u=Math.ceil((l(c.end)||0)-(h||0)),d=this.previewDriver.symbol,p=Object(K.jsx)(s.a.Fragment,{children:Object(K.jsxs)("div",{children:[" ",d," "]})}),v=d.length>4?40+5*(d.length-4):40;return Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{style:{position:"absolute",left:h-v/2,bottom:o,border:"1px solid rgba(0,0,0,0)",zIndex:0},children:p}),Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:h,width:u+1,height:"75%",backgroundColor:this.lockedDrivers.has(this.previewDriver)?"red":"rgba(0, 200 , 0, 1)",zIndex:0}})]})}}]),a}(s.a.PureComponent);function me(e){var t=e.data,a=e.chr,r=e.rdRange,s=e.hoveredLocation,n=e.onLocationHovered,i=e.onBrushedBinsUpdated,o=e.brushedBins,l=e.customColor,c=e.colors,h=e.yScale,u=e.clusterTableData,d=e.applyLog,p=e.displayMode,v=e.width,f=e.onLinearPlotZoom,g=e.implicitStart,b=e.implicitEnd,m=e.onZoom,S=e.driverGenes;return Object(K.jsx)(be,{data:t,dataKeyToPlot:d?"logRD":"RD",applyLog:d,genome:at,chr:a,hoveredLocation:s,onLocationHovered:n,onBrushedBinsUpdated:i,yMin:h?h[0]:d?-2:0,yMax:h?h[1]:r[1],yLabel:d?"log RDR":"RDR",brushedBins:o,customColor:l,colors:c,clusterTableData:u,displayMode:p,width:v,onZoom:m,onLinearPlotZoom:f,implicitStart:g,implicitEnd:b,driverGenes:S,driverGeneUpdate:e.driverGeneUpdate,handleDriverGenesChange:e.handleDriverGenesChange})}function Se(e){var t=e.data,a=e.chr,r=e.hoveredLocation,s=e.onLocationHovered,n=e.onBrushedBinsUpdated,i=e.brushedBins,o=e.customColor,l=e.colors,c=e.xScale,h=e.clusterTableData,u=e.displayMode,d=e.width,p=e.onLinearPlotZoom,v=e.implicitStart,f=e.implicitEnd,g=e.onZoom,b=e.driverGenes,m=e.applyLog;return Object(K.jsx)(be,{data:t,chr:a,dataKeyToPlot:"reverseBAF",applyLog:m,genome:at,hoveredLocation:r,onLocationHovered:s,onBrushedBinsUpdated:n,yMin:c?c[0]:0,yMax:c?c[1]:.5,yLabel:"0.5 - BAF",brushedBins:i,customColor:o,colors:l,clusterTableData:h,displayMode:u,width:d,onLinearPlotZoom:p,implicitStart:v,implicitEnd:f,onZoom:g,driverGenes:b,driverGeneUpdate:e.driverGeneUpdate,handleDriverGenesChange:e.handleDriverGenesChange})}be.defaultProps={width:600,height:150,onLocationHovered:y.a.noop};var Ce=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).state={selectedSample:e.initialSelectedSample,sentDriver:{gene:null,destination:null}},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleDriverGenesChange=r.handleDriverGenesChange.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e.target.value})}},{key:"handleDriverGenesChange",value:function(e){this.setState({sentDriver:e})}},{key:"render",value:function(){var e,t=this.props,a=t.data,r=t.chr,s=t.hoveredLocation,n=t.onLocationHovered,i=t.onBrushedBinsUpdated,o=t.brushedBins,l=t.customColor,c=t.yScale,h=t.xScale,u=t.rdRange,d=t.clusterTableData,p=t.applyLog,v=t.displayMode,f=t.width,g=t.onLinearPlotZoom,b=t.implicitRange,m=t.onZoom,S=t.driverGenes;return e=Object(K.jsxs)(oe,{className:"SampleViz-pane",children:[Object(K.jsx)(me,{data:a,chr:r,rdRange:u,hoveredLocation:s,onLocationHovered:n,onBrushedBinsUpdated:i,brushedBins:o,customColor:l,colors:this.props.colors,yScale:c,xScale:h,clusterTableData:d,applyLog:p,displayMode:v,width:f,onLinearPlotZoom:g,implicitStart:b?b[0]:b,implicitEnd:b?b[1]:b,onZoom:m,driverGenes:S,handleDriverGenesChange:this.handleDriverGenesChange,driverGeneUpdate:this.state.sentDriver}),Object(K.jsx)("div",{className:"SampleViz-separator"}),Object(K.jsx)(Se,{data:a,chr:r,hoveredLocation:s,onLocationHovered:n,onBrushedBinsUpdated:i,brushedBins:o,customColor:l,colors:this.props.colors,yScale:c,xScale:h,clusterTableData:d,applyLog:p,displayMode:v,width:f,onLinearPlotZoom:g,onZoom:m,implicitStart:b?b[0]:b,implicitEnd:b?b[1]:b,driverGenes:S,handleDriverGenesChange:this.handleDriverGenesChange,driverGeneUpdate:this.state.sentDriver})]}),Object(K.jsx)("div",{className:"SampleViz-linear",children:e})}}]),a}(s.a.Component),ye=a(62),je=a.n(ye),Ae=a(207),xe=(a(192),function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).table_data=void 0,r.table_data=e.data,r.handleColorChange=r.handleColorChange.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"shouldComponentUpdate",value:function(e){return this.props.data!==e.data||this.props.colors!==e.colors}},{key:"handleColorChange",value:function(e,t){this.props.colors[t]=e.hex;var a=y.a.cloneDeep(this.props.colors);this.props.onClusterColorChange(a),this.forceUpdate()}},{key:"componentDidUpdate",value:function(e){this.props.updatedClusterTable&&this.props.updatedClusterTable()}},{key:"render",value:function(){var e=this,t=this.props,a=t.colOneName,r=t.colTwoName,s=t.colThreeName,n=t.colFourName,i=t.data,o=t.expandable,l=t.selectable,c=t.colors,h=function(t){return Object(K.jsx)("div",{children:Object(K.jsx)(Ae.a,{width:"100%",color:e.props.colors[t.data.key],onChangeComplete:function(a){return e.handleColorChange(a,t.data.key)}})})},u=[{when:function(e){return e},style:function(e){return{backgroundColor:-1===Number(e.key)?"#999999":c[Number(e.key)%c.length],alignItems:"center",justifyContent:"center",innerWidth:50,outerWidth:50}}}],d=[{name:a,selector:"key",sortable:!0,compact:!0,wrap:!0,innerWidth:40,outerWidth:40,width:"50",center:!0},{name:r,selector:"value",sortable:!0,right:!0,compact:!0,wrap:!0,innerWidth:40,outerWidth:40,width:"50",center:!0}],p=[{name:a,selector:"key",sortable:!0,compact:!0,wrap:!0,center:!0},{name:r,selector:"value",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0},{name:s,selector:"selectPerc",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0},{name:n,selector:"binPerc",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0}];if(t.centroidTable){var v=[];if(null!==i&&void 0!==i&&i.length>0){v.push({name:"Cluster ID",type:"key"});for(var f=0,g=Object.keys(i[0].sample);f<g.length;f++){var b=g[f];v.push({name:b,type:"sample."+b})}}for(var m=[],S=0,C=v;S<C.length;S++){var y=C[S],j={name:y.name,selector:y.type,sortable:!0,compact:!0,wrap:!0,center:!0};m.push(j)}return Object(K.jsx)(je.a,{columns:m,data:i,pagination:!0,dense:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0,conditionalRowStyles:u})}return o||l?Object(K.jsx)("div",{className:"scroll",children:Object(K.jsx)(je.a,{columns:d,data:i,selectableRows:!0,onSelectedRowsChange:this.props.onClusterRowsChange,selectableRowSelected:function(t){if(e.props.currentFilters.includes(String(t.key)))return t},expandableRows:!0,expandableRowsComponent:Object(K.jsx)(h,{}),expandableRowDisabled:function(e){return-1===e.key||-2===e.key},pagination:!0,dense:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0,conditionalRowStyles:u})}):Object(K.jsx)(je.a,{columns:p,data:i,pagination:!0,dense:!0,paginationPerPage:3,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[3,5,10,20],noContextMenu:!0,noHeader:!0,noDataComponent:Object(K.jsx)("div",{style:{padding:10},children:"No Records Selected"}),conditionalRowStyles:u})}}]),a}(s.a.Component)),Oe="-1",_e="-2",ke=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e))._clusters=void 0,r._clusters=r.initializeListOfClusters(),r.state={selectedSample:e.initialSelectedSample||e.data.getSampleList()[0],scales:{xScale:null,yScale:null},selectedCluster:r._clusters.length>0?r._clusters[0]:Oe,implicitRange:null},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleSelectedSampleChange=r.handleSelectedSampleChange.bind(Object(d.a)(r)),r.handleZoom=r.handleZoom.bind(Object(d.a)(r)),r.handleLinearPlotZoom=r.handleLinearPlotZoom.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;this._clusters=[];var t,a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(s){a.e(s)}finally{a.f()}for(;this._clusters.length>0&&(Number(this._clusters[0])===Number(Oe)||Number(this._clusters[0])===Number(_e));)this._clusters.shift();return this._clusters}},{key:"componentDidUpdate",value:function(e){if(this.props.clusterTableData!==e.clusterTableData)this.initializeListOfClusters();else if(this.props.applyLog!==e.applyLog){var t={xScale:this.state.scales.xScale,yScale:null};this.setState({scales:t})}}},{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e})}},{key:"handleSelectedSampleChange",value:function(e){this.setState({selectedSample:e.target.value})}},{key:"handleZoom",value:function(e){var t=this.props,a=t.syncScales,r=t.handleZoom;a?r(e):this.setState({scales:e})}},{key:"handleLinearPlotZoom",value:function(e,t,a,r){if(r){this.setState({implicitRange:null});this.setState({scales:{xScale:null,yScale:null}})}else{this.setState({implicitRange:e});var s=a?{xScale:this.state.scales.xScale,yScale:t}:{xScale:t,yScale:this.state.scales.yScale};this.setState({scales:s})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.data,r=t.initialSelectedSample,s=t.applyLog,n=t.showLinearPlot,i=t.showScatterPlot,l=t.dispMode,c=(t.showSidebar,t.sampleAmount),h=t.syncScales,u=this.state.implicitRange,d=this.state.selectedSample,p=a.getRdRange(d,s),v=a.getSampleList().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)})),f=[],g=h?this.props.scales:this.state.scales;if(null!==u||null!==g.xScale||null!==g.yScale){var b=u?u[0]:null,m=u?u[1]:null;f=a.getRecords(d,s,b,m,g.xScale,g.yScale)}else f=a.getRecords(d,s,null,null,null,null);p[1]+=.5;var S=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));S.unshift(Object(K.jsx)("option",{value:Oe,children:Oe},Oe)),S.unshift(Object(K.jsx)("option",{value:_e,children:_e},_e));var C=0===a.getBrushedBins().length;return Object(K.jsxs)("div",{className:"SampleViz-wrapper",children:[Object(K.jsxs)("div",{style:{verticalAlign:"middle"},children:[(n||i)&&Object(K.jsxs)("div",{className:"SampleViz-select",children:[Object(K.jsx)("span",{children:"Sample: "}),Object(K.jsx)("select",{value:d,onChange:this.handleSelectedSampleChange,children:v}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onAddSample,disabled:c>=v.length,children:" Add Sample "}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onRemovePlot,disabled:c<=1,children:" Remove Sample "})]}),(n||i)&&Object(K.jsxs)("div",{className:"SampleViz-select",children:[Object(K.jsx)("span",{children:"Cluster: "}),Object(K.jsx)("select",{name:"Select Cluster",title:"Cluster",className:"Sampleviz-cluster-select",value:this.state.selectedCluster,disabled:C,onChange:function(t){e.setState({selectedCluster:t.target.value})},children:S}),Object(K.jsx)("button",{className:"custom-button",onClick:function(){e.props.parentCallBack(e.state.selectedCluster),e.props.onBrushedBinsUpdated([])},disabled:C,children:"Assign Cluster"}),Object(K.jsx)("button",{className:"custom-button",onClick:function(){e.initializeListOfClusters();var t=e._clusters;t.sort((function(e,t){return Number(e)-Number(t)}));for(var a=(t.length>0?Number(t[t.length-1]):-1)+1,r=0;r<t.length;r++)if(Number(t[r])!==r){a=r;break}e.props.parentCallBack(a),e.props.onBrushedBinsUpdated([])},disabled:C,children:"New Cluster"}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onUndoClick,children:" Undo"})]})]}),Object(K.jsxs)("div",{className:"SampleViz-plots",children:[i&&Object(K.jsx)(ce,Object(o.a)(Object(o.a)({},this.props),{},{data:f,onSelectedSample:this.handleSelectedSampleChanged,selectedSample:d,initialSelectedSample:r,onZoom:this.handleZoom,rdRange:p,implicitRange:this.state.implicitRange,scales:h?this.props.scales:this.state.scales,centroidPts:a.getCentroidPoints(d,this.props.chr)})),n&&Object(K.jsx)(Ce,Object(o.a)(Object(o.a)({},this.props),{},{data:f,onLinearPlotZoom:this.handleLinearPlotZoom,onZoom:this.handleZoom,yScale:this.state.scales.yScale,xScale:this.state.scales.xScale,selectedSample:this.state.selectedSample,initialSelectedSample:r,rdRange:p,displayMode:l,width:600,implicitRange:this.state.implicitRange}))]}),(n||i)&&Object(K.jsx)("div",{className:n&&i?"SampleViz-clusters":"",children:Object(K.jsx)(xe,{data:a.brushedTableData(),onClusterRowsChange:function(){},onClusterColorChange:function(){},currentFilters:["-1"],colOneName:"Cluster ID",colTwoName:"Cluster (%)",colThreeName:"Selection (%)",colFourName:"Bin (%)",cols:"",expandable:!1,selectable:!1,colors:this.props.colors})})]})}}]),a}(s.a.Component),we="data:image/gif;base64,R0lGODlhEAAQAPQAAP///wAAAPDw8IqKiuDg4EZGRnp6egAAAFhYWCQkJKysrL6+vhQUFJycnAQEBDY2NmhoaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFdyAgAgIJIeWoAkRCCMdBkKtIHIngyMKsErPBYbADpkSCwhDmQCBethRB6Vj4kFCkQPG4IlWDgrNRIwnO4UKBXDufzQvDMaoSDBgFb886MiQadgNABAokfCwzBA8LCg0Egl8jAggGAA1kBIA1BAYzlyILczULC2UhACH5BAkKAAAALAAAAAAQABAAAAV2ICACAmlAZTmOREEIyUEQjLKKxPHADhEvqxlgcGgkGI1DYSVAIAWMx+lwSKkICJ0QsHi9RgKBwnVTiRQQgwF4I4UFDQQEwi6/3YSGWRRmjhEETAJfIgMFCnAKM0KDV4EEEAQLiF18TAYNXDaSe3x6mjidN1s3IQAh+QQJCgAAACwAAAAAEAAQAAAFeCAgAgLZDGU5jgRECEUiCI+yioSDwDJyLKsXoHFQxBSHAoAAFBhqtMJg8DgQBgfrEsJAEAg4YhZIEiwgKtHiMBgtpg3wbUZXGO7kOb1MUKRFMysCChAoggJCIg0GC2aNe4gqQldfL4l/Ag1AXySJgn5LcoE3QXI3IQAh+QQJCgAAACwAAAAAEAAQAAAFdiAgAgLZNGU5joQhCEjxIssqEo8bC9BRjy9Ag7GILQ4QEoE0gBAEBcOpcBA0DoxSK/e8LRIHn+i1cK0IyKdg0VAoljYIg+GgnRrwVS/8IAkICyosBIQpBAMoKy9dImxPhS+GKkFrkX+TigtLlIyKXUF+NjagNiEAIfkECQoAAAAsAAAAABAAEAAABWwgIAICaRhlOY4EIgjH8R7LKhKHGwsMvb4AAy3WODBIBBKCsYA9TjuhDNDKEVSERezQEL0WrhXucRUQGuik7bFlngzqVW9LMl9XWvLdjFaJtDFqZ1cEZUB0dUgvL3dgP4WJZn4jkomWNpSTIyEAIfkECQoAAAAsAAAAABAAEAAABX4gIAICuSxlOY6CIgiD8RrEKgqGOwxwUrMlAoSwIzAGpJpgoSDAGifDY5kopBYDlEpAQBwevxfBtRIUGi8xwWkDNBCIwmC9Vq0aiQQDQuK+VgQPDXV9hCJjBwcFYU5pLwwHXQcMKSmNLQcIAExlbH8JBwttaX0ABAcNbWVbKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICSRBlOY7CIghN8zbEKsKoIjdFzZaEgUBHKChMJtRwcWpAWoWnifm6ESAMhO8lQK0EEAV3rFopIBCEcGwDKAqPh4HUrY4ICHH1dSoTFgcHUiZjBhAJB2AHDykpKAwHAwdzf19KkASIPl9cDgcnDkdtNwiMJCshACH5BAkKAAAALAAAAAAQABAAAAV3ICACAkkQZTmOAiosiyAoxCq+KPxCNVsSMRgBsiClWrLTSWFoIQZHl6pleBh6suxKMIhlvzbAwkBWfFWrBQTxNLq2RG2yhSUkDs2b63AYDAoJXAcFRwADeAkJDX0AQCsEfAQMDAIPBz0rCgcxky0JRWE1AmwpKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICKZzkqJ4nQZxLqZKv4NqNLKK2/Q4Ek4lFXChsg5ypJjs1II3gEDUSRInEGYAw6B6zM4JhrDAtEosVkLUtHA7RHaHAGJQEjsODcEg0FBAFVgkQJQ1pAwcDDw8KcFtSInwJAowCCA6RIwqZAgkPNgVpWndjdyohACH5BAkKAAAALAAAAAAQABAAAAV5ICACAimc5KieLEuUKvm2xAKLqDCfC2GaO9eL0LABWTiBYmA06W6kHgvCqEJiAIJiu3gcvgUsscHUERm+kaCxyxa+zRPk0SgJEgfIvbAdIAQLCAYlCj4DBw0IBQsMCjIqBAcPAooCBg9pKgsJLwUFOhCZKyQDA3YqIQAh+QQJCgAAACwAAAAAEAAQAAAFdSAgAgIpnOSonmxbqiThCrJKEHFbo8JxDDOZYFFb+A41E4H4OhkOipXwBElYITDAckFEOBgMQ3arkMkUBdxIUGZpEb7kaQBRlASPg0FQQHAbEEMGDSVEAA1QBhAED1E0NgwFAooCDWljaQIQCE5qMHcNhCkjIQAh+QQJCgAAACwAAAAAEAAQAAAFeSAgAgIpnOSoLgxxvqgKLEcCC65KEAByKK8cSpA4DAiHQ/DkKhGKh4ZCtCyZGo6F6iYYPAqFgYy02xkSaLEMV34tELyRYNEsCQyHlvWkGCzsPgMCEAY7Cg04Uk48LAsDhRA8MVQPEF0GAgqYYwSRlycNcWskCkApIyEAOwAAAAAAAAAAAA==",De=(a(193),function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).table_data=void 0,r.table_data=e.data,r}return Object(u.a)(a,[{key:"shouldComponentUpdate",value:function(e){return this.props.data!==e.data}},{key:"render",value:function(){var e,t=this.props,a=t.colName,r=t.data,s=[{name:a,selector:"action",compact:!0,wrap:!0}],n=[],i=Object(f.a)(r);try{for(i.s();!(e=i.n()).done;){var o=e.value;n.push(o)}}catch(l){i.e(l)}finally{i.f()}return Object(K.jsx)("div",{children:Object(K.jsx)(je.a,{columns:s,data:n,pagination:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0})})}}]),a}(s.a.Component)),Be=function(){function e(t,a){Object(h.a)(this,e),this._name=void 0,this._chromosomes=void 0,this._chrStarts=void 0,this._length=void 0,this.nameToChr=void 0,this._name=a||"",this._chromosomes=t,this._chrStarts={},this._length=0;var r,s=Object(f.a)(t);try{for(s.s();!(r=s.n()).done;){var n=r.value,i=n.name;if(void 0!==this._chrStarts[i])throw new Error('Duplicate chromosome name "'.concat(i,'" in genome "').concat(a,'"'));this._chrStarts[i]=this._length,this._length+=n.length}}catch(u){s.e(u)}finally{s.f()}this.nameToChr={};var o,l=Object(f.a)(this._chromosomes);try{for(l.s();!(o=l.n()).done;){var c=o.value;this.nameToChr[c.name]=c}}catch(u){l.e(u)}finally{l.f()}}return Object(u.a)(e,[{key:"getName",value:function(){return this._name}},{key:"getChromosomeList",value:function(){return this._chromosomes}},{key:"getChromosomeStarts",value:function(){var e=this;return this._chromosomes.map((function(t){return e._chrStarts[t.name]}))}},{key:"getChrStartMap",value:function(){return this._chrStarts}},{key:"getChromosomeStarts2",value:function(e,t,a){var r=this;return e.map((function(e){return r._chrStarts[e.name]}))}},{key:"getLength",value:function(e){return e?e in this._chrStarts?this._chromosomes.find((function(t){return t.name===e})).length:0:this._length}},{key:"getLength2",value:function(e){var t,a=0,r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){a+=t.value.length}}catch(s){r.e(s)}finally{r.f()}return a}},{key:"getImplicitCoordinates",value:function(e){var t=e.chr,a=e.start,r=e.end;if(!(t in this._chrStarts))throw new Error('Chromosome "'.concat(t,'" not in this genome'));var s=this._chrStarts[t];return new j(s+a,s+r)}},{key:"getChromosomeLocation",value:function(e){e<0?e=0:e>=this.getLength()&&(e=this.getLength()-1);var t=Object.values(this._chrStarts).sort((function(e,t){return e-t})),a=y.a.sortedLastIndex(t,e)-1,r=e-t[a];return new A(this._chromosomes[a].name,r,r+1)}},{key:"getChrs",value:function(e){var t,a=[],r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push(this.nameToChr[s])}}catch(n){r.e(n)}finally{r.f()}return a}}]),e}();new Be([{name:"chr1",length:248956422},{name:"chr2",length:242193529},{name:"chr3",length:198295559},{name:"chr4",length:190214555},{name:"chr5",length:181538259},{name:"chr6",length:170805979},{name:"chr7",length:159345973},{name:"chr8",length:145138636},{name:"chr9",length:138394717},{name:"chr10",length:133797422},{name:"chr11",length:135086622},{name:"chr12",length:133275309},{name:"chr13",length:114364328},{name:"chr14",length:107043718},{name:"chr15",length:101991189},{name:"chr16",length:90338345},{name:"chr17",length:83257441},{name:"chr18",length:80373285},{name:"chr19",length:58617616},{name:"chr20",length:64444167},{name:"chr21",length:46709983},{name:"chr22",length:50818468}],"hg38"),a(358);function Le(e){return new Promise((function(t,a){var r=Object.keys(e[0]),s=r.slice(0,r.length-3);t(G(e,s,"\t"," "))}))}var Re=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e)).csvLink=void 0,r.csvLink=s.a.createRef(),r.state={loading:!1},r.handleFileDownload=r.handleFileDownload.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"handleFileDownload",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t,a,r,s,n,i,o,l,c,h,u,d,p,v,g,m,S,C,y,j,A;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t="",e.prev=2,e.next=5,Le(this.props.data);case 5:t=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return");case 12:for((a=document.createElement("a")).href="data:text/tab-separated-values,"+encodeURIComponent(t),r=this.props.fileName,s=r.split("."),n="",i=0;i<s.length-1;i++)n+=s[i],i!==s.length-2&&(n+=".");o=n.split("_"),l=new Date,(c=String(l.getMonth()+1)).length<2&&(c="0"+c),(h=String(l.getDate())).length<2&&(h="0"+h),u=l.getFullYear()+c+h,d=String(l.getHours()),p=String(l.getMinutes()),v=String(l.getSeconds()),d.length<2&&(d="0"+d),p.length<2&&(p="0"+p),v.length<2&&(v="0"+v),g=d+p+v,a.download=o[0]+"_"+u+g+".tsv",a.click(),m=[],S=Object(f.a)(this.props.logData);try{for(S.s();!(C=S.n()).done;)y=C.value,m.push(y.action)}catch(b){S.e(b)}finally{S.f()}"",j=m.join("\n"),(A=document.createElement("a")).href="data:text/plain,"+encodeURIComponent(j),A.download=o[0]+"-log_"+u+"_"+g,A.click(),this.setState({loading:!1});case 44:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(K.jsxs)("div",{children:[Object(K.jsx)("button",{type:"button",onClick:this.handleFileDownload,style:{display:"none"},children:"Export"}),this.state.loading&&Object(K.jsxs)("div",{children:["Reading file... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]})]})}}]),a}(s.a.Component),Te=a(27),Ee=a(206);var Me=function(e){var t=e.chosenFile;return t.length>35&&(t=t.substring(0,34)+"..."),Object(K.jsxs)("div",{className:e.show?"sidebar active":"sidebar",children:[Object(K.jsxs)("div",{className:"closemenu",onClick:function(){e.onSidebarChange(!e.show)},children:[Object(K.jsx)("div",{children:" "}),e.show?Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.a,{})}):Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.b,{})})]}),Object(K.jsx)("div",{className:"closemenu2",onClick:function(){return e.setDisplayMode(st.select)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.c,{color:e.currentDisplayMode===st.select?"red":"black"})})}),Object(K.jsx)("div",{className:"closemenu3",onClick:function(){return e.setDisplayMode(st.zoom)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.e,{color:e.currentDisplayMode===st.zoom||e.currentDisplayMode===st.boxzoom?"red":"black"})})}),Object(K.jsx)("div",{className:"closemenu4",onClick:function(){return e.setDisplayMode(st.erase)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Ee.a,{color:e.currentDisplayMode===st.erase?"red":"black"})})}),Object(K.jsxs)("div",{className:"contents",children:[Object(K.jsxs)("div",{className:"row-contents",children:[" ",Object(K.jsx)("h1",{children:"CNAViz"})," "]}),Object(K.jsx)("div",{className:"title-bar"}),Object(K.jsxs)("div",{className:"row-contents",children:[" Chosen File: ",t]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"file",id:"fileUpload",onChange:function(t){return e.onFileChosen(t,!0)}}),"Import"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)(Re,{data:e.data,logData:e.logData,fileName:e.chosenFile}),"Export"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:function(t){return e.handleDemoFileInput(!0)}}),"Demo"]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"file",id:"fileUpload",onChange:function(t){return e.onDriverFileChosen(t,!0)}}),"Import Driver Genes"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:function(t){return e.handleDemoDrivers()}}),"CGC Drivers"]})]}),Object(K.jsx)("div",{className:"row-contents",children:Object(K.jsxs)("div",{children:[Object(K.jsx)("label",{htmlFor:"Select Chromosome",style:{margin:10},children:" Chromosome: "}),Object(K.jsx)("select",{name:"Select Chromosome",id:"Select Chromosome",value:e.selectedChr,onChange:e.onChrSelected,children:e.chrOptions})]})}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Log RDR: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleLog})]}),Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Centroids: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleShowCentroids,checked:e.showCentroids,readOnly:!0})]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Scatterplots: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleScatter,checked:e.showScatter,readOnly:!0})]}),Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Linear Plots: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleLinear,checked:e.showLinear,readOnly:!0})]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onToggleSilhouttes}),"Analytics (s)"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onToggleShowCentroidTable}),"Centroids (c)"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onToggleDirections}),"Usage (?)"]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onClearClustering}),"Clear Clustering"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onTogglePreviousActionLog}),"Previous Actions (l)"]})]})]}),Object(K.jsx)("div",{className:"contents2",children:Object(K.jsx)(xe,{data:e.tableData,onClusterRowsChange:e.onClusterRowsChange,onClusterColorChange:e.onClusterColorChange,currentFilters:e.currentClusterFilters,colOneName:"Cluster ID",colTwoName:"Bin (%)",cols:"",expandable:!0,selectable:!0,colors:e.colors})})]})},Ne=(a(194),0),Pe=0,Fe=0,Ie=0,Ue=0,Ye=0,Ge=0,He=50,ze=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e))._svg=void 0,r.state={showTooltip:!1,tooltipX:0,tooltipY:0},r._svg=null,r}return Object(u.a)(a,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"componentDidUpdate",value:function(e){this.propsDidChange(e,[])&&this.redraw()}},{key:"propsDidChange",value:function(e,t){var a=this;return t.some((function(t){return a.props[t]!==e[t]}))}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"renderTooltipContent",value:function(e){var t=this.props,a=(t.width,t.height,this.state),r=a.showTooltip;a.tooltipX,a.tooltipY;if(!e)return null;if(!r)return null;return Object(K.jsx)("div",{className:"Scatterplot-tooltip",style:{position:"absolute",top:"90%",left:"1%",pointerEvents:"none"},children:e})}},{key:"renderTooltip",value:function(){return this.renderTooltipContent(Object(K.jsx)(s.a.Fragment,{children:Object(K.jsx)("div",{children:"Note: The Silhoutte coefficient ranges from -1 to 1 where the larger the number the more tightly grouped the cluster "})}))}},{key:"render",value:function(){return Object(K.jsx)("div",{id:"chart-container",children:this.renderTooltip()})}},{key:"redraw",value:function(){var e=this,t=this.props,a=t.width,r=t.height,s=t.data,n=t.colors,i=y.a.sortBy(s,"avg"),o=Ie/a*100+"%",l=Ne/a*100+"%",c=Pe/a*100+"%",h=Fe/a*100+"%",u=w.j("div#chart-container").append("svg").style("padding",l+" "+c+" "+h+" "+o+" ").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+(a+Ue+Ge)+" "+(r+Ye+He)),d=w.i().domain([-1,1]).range([15,a-10]);u.append("text").classed("scale",!0).attr("text-anchor","middle").attr("font-size",20).attr("x",y.a.mean([15,a-10])).attr("y",r+40).text("Approximate Average Silhoutte Coefficient").on("mouseover",(function(){e.setState({showTooltip:!0}),e.setState({tooltipX:w.f.offsetX,tooltipY:w.f.offsetY})})).on("mouseleave",(function(){e.setState({showTooltip:!1})})),u.append("g").attr("transform","translate(0,"+r+")").call(w.a(d)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var p=w.h().range([0,r]).domain(i.map((function(e){return String(e.cluster)}))).padding(.1);u.selectAll("myRect").data(i).enter().append("rect").attr("class",(function(e){return"bar bar--"+(e.avg<0?"negative":"positive")})).attr("x",(function(e){return d(Math.min(0,e.avg))||0})).attr("y",(function(e){return p(String(e.cluster))||0})).attr("width",(function(e){return Math.abs((d(e.avg)||0)-(d(0)||0))})).attr("height",p.bandwidth()).attr("fill",(function(e){return-1===e.cluster?"#999999":n[e.cluster%n.length]})),u.append("g").call(w.b(p).tickSize(0).tickPadding(6)).attr("transform","translate("+d(0)+",0)")}}]),a}(s.a.Component),Xe=0,Ke=0,Qe=0,Ze=0,Ve=10,Je=0,We=0,qe=50,$e=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e))._svg=void 0,r._svg=null,r}return Object(u.a)(a,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"componentDidUpdate",value:function(e){this.propsDidChange(e,["selectedCluster"])&&this.redraw()}},{key:"propsDidChange",value:function(e,t){var a=this;return t.some((function(t){return a.props[t]!==e[t]}))}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,r=t.height,s=Ze/a*100+"%",n=Xe/a*100+"%",i=Ke/a*100+"%",o=Qe/a*100+"%";return Object(K.jsx)("div",{id:"chart-container2",children:Object(K.jsx)("svg",{ref:function(t){return e._svg=t},style:{padding:n+" "+i+" "+o+" "+s+" "},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+(a+Ve+We)+" "+(r+Je+qe)})})}},{key:"redraw",value:function(){var e=this.props,t=e.width,a=e.height,r=e.data,s=e.colors;if(this._svg){var n=[];void 0!==r&&(n=Array.from(r,(function(e){return{key:e[0],value:e[1]}}))),n=y.a.sortBy(n,"value");var i=w.j(this._svg);i.selectAll(".scales").remove();var o=y.a.maxBy(n,"value"),l=w.i().domain([0,o?o.value:1]).range([30,t-10]);i.append("text").classed("scales",!0).attr("text-anchor","middle").attr("font-size",20).attr("x",y.a.mean([0,t])).attr("y",a+40).text("Approximate Average Euclidean Distance"),i.append("g").classed("scales",!0).attr("transform","translate(0,"+a+")").call(w.a(l)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var c=w.h().range([0,a]).domain(n.map((function(e){return String(e.key)}))).padding(.1);i.selectAll(".bar").remove(),i.selectAll("myRect").classed("bars",!0).data(n).enter().append("rect").attr("class",(function(e){return"bar bar--"+(e.value<0?"negative":"positive")})).attr("x",(function(e){return l(Math.min(0,e.value))||0})).attr("y",(function(e){return c(String(e.key))||0})).attr("width",(function(e){return Math.abs((l(e.value)||0)-(l(0)||0))})).attr("height",c.bandwidth()).attr("fill",(function(e){return-1===e.key?"#999999":s[e.key%s.length]})),i.append("g").classed("scales",!0).call(w.b(c).tickSize(0).tickPadding(6)).attr("transform","translate("+l.range()[0]+",0)")}}}]),a}(s.a.Component),et=(a(359),function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;return Object(h.a)(this,a),(r=t.call(this,e))._clusters=void 0,r._clusters=r.initializeListOfClusters(),r.state={selectedCluster:r._clusters[0]},r}return Object(u.a)(a,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;this._clusters=[];var t,a=Object(f.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(s){a.e(s)}finally{a.f()}for(;this._clusters.length>0&&(Number(this._clusters[0])===Number("-1")||Number(this._clusters[0])===Number("-2"));)this._clusters.shift();return this._clusters}},{key:"componentDidUpdate",value:function(e){this.props.clusterTableData!==e.clusterTableData&&this.initializeListOfClusters()}},{key:"render",value:function(){var e=this,t=this.props,a=t.silhoutteData,r=t.clusterDistances,s=t.colors,n=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));return Object(K.jsxs)("div",{className:"Directions2",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Cluster Analytics "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:this.props.onToggleSilhoutteBarPlot,children:Object(K.jsx)(Te.d,{})}),Object(K.jsxs)("div",{className:"Bar-Select",children:[Object(K.jsxs)("div",{className:"ClusterDistances-Select",children:[Object(K.jsxs)("div",{className:"Overall-Average",children:[" Average Cluster Silhoutte Score: ",Object(K.jsx)("b",{children:this.props.avgClusterSilhoutte||0})," "]}),Object(K.jsxs)("label",{className:"cluster-select",children:[" Cluster:",Object(K.jsx)("select",{name:"Select Cluster",title:"Cluster",value:this.state.selectedCluster,onChange:function(t){e.setState({selectedCluster:t.target.value})},children:n})]})]}),Object(K.jsxs)("div",{className:"BarPlots",children:[Object(K.jsx)(ze,{width:700,height:700,data:a,avgClusterSilhoutte:this.props.avgClusterSilhoutte,colors:s}),Object(K.jsx)($e,{data:r.get(Number(this.state.selectedCluster)),selectedCluster:Number(this.state.selectedCluster),width:700,height:700,colors:s})]})]})]})}}]),a}(s.a.Component));function tt(e){return new Promise((function(t,a){var r=new FileReader;r.readAsText(e),r.onload=function(){t(r.result)},r.onerror=a,r.onabort=a}))}var at,rt,st,nt=["#d3fe14","#c9080a","#fec7f8","#0b7b3e","#3957ff","#0bf0e9","#c203c8","#fd9b39","#906407","#98ba7f","#fe6794","#10b0ff","#ac7bff","#fee7c0","#964c63","#1da49c","#0ad811","#bbd9fd","#fe6cfe","#d1a09c","#78579e","#81ffad","#739400","#ca6949","#d9bf01","#646a58","#d5097e","#bb73a9","#ccf6e9","#9cb4b6","#b6a7d4","#9e8c62","#6e83c8","#01af64","#a71afd","#cfe589","#d4ccd1","#fd4109","#bf8f0e","#2f786e","#4ed1a5","#d8bb7d","#a54509","#6a9276","#a4777a","#fc12c9","#606f15","#3cc4d9","#f31c4e","#73616f","#f097c6","#fc8772","#92a6fe","#875b44","#699ab3","#94bc19","#7d5bf0","#d24dfe","#c85b74","#68ff57","#b62347","#994b91","#646b8c","#977ab4","#d694fd","#c4d5b5","#fdc4bd","#1cae05","#7bd972","#e9700a","#d08f5d","#8bb9e1","#fde945","#a29d98","#1682fb","#9ad9e0","#d6cafe","#8d8328","#b091a7","#647579","#1f8d11","#e7eafd","#b9660b","#a4a644","#fec24c","#b1168c","#188cc1","#7ab297","#c949a6","#d48295","#eb6dc2","#d5b0cb","#ff9ffb","#fdb082","#af4d44","#a759c4","#a9e03a","#0d906b","#9ee3bd","#5b8846","#0d8995","#f25c58","#70ae4f","#847f74","#9094bb","#ffe2f1","#a67149","#936c8e","#d04907","#c3b8a6","#cef8c4","#7a9293","#fda2ab","#2ef6c5","#807242","#cb94cc","#b6bdd0","#b5c75d","#fde189","#b7ff80","#fa2d8e","#839a5f","#28c2b5","#e5e9e1","#bc79d8","#7ed8fe","#9f20c3","#4f7a5b","#f511fd","#09c959","#bcd0ce","#8685fd","#98fcff","#afbff9","#6d69b4","#aaa87e","#b59dfb","#d9a742","#ac5c86","#9468d5","#a4a2b2","#b1376e","#d43f3d","#05a9d1","#c38375","#24b58e","#6eabaf","#66bf7f","#92cbbb","#ddb1ee","#1be895","#c7ecf9","#a6baa6","#8045cd","#a9d796","#ce62cb","#0e954d","#a97d2f","#fcb8d3","#9bfee3","#4e8d84","#fc6d3f","#7b9fd4","#8c6165","#72805e","#d53762","#f00a1b","#de5c97","#8ea28b","#fccd95","#ba9c57","#b79a82","#7c5a82","#7d7ca4","#958ad6","#cd8126","#bdb0b7","#10e0f8","#dccc69","#d6de0f","#616d3d","#985a25","#30c7fd","#0aeb65","#e3cdb4","#bd1bee","#ad665d","#d77070","#8ea5b8","#76655e","#598100","#86757e","#5ea068","#a590b8","#c1a707","#85c0cd","#e2cde9","#dcd79c","#d8a882","#b256f9","#b13323","#519b3b","#dd80de","#f1884b","#74b2fe","#a0acd2","#d199b0","#f68392","#8ccaa0","#64d6cb","#e0f86a","#75671b","#796e87","#6d8075","#9b8a8d","#f04c71","#61bd29","#bcc18f","#fecd0f","#1e7ac9","#927261","#dc27cf","#979605","#ec9c88","#8c48a3","#676769","#546e64","#8f63a2","#b35b2d","#7b8ca2","#b87188","#4a9bda","#eb7dab","#f6a602","#cab3fe","#ddb8bb","#107959","#885973","#5e858e","#b15bad","#e107a7","#2f9dad","#4b9e83","#b992dc","#6bb0cb","#bdb363","#ccd6e4","#a3ee94","#9ef718","#fbe1d9","#a428a5","#93514c","#487434","#e8f1b6","#d00938","#fb50e1","#fa85e1","#7cd40a","#f1ade1","#b1485d","#7f76d6","#d186b3","#90c25e","#b8c813","#a8c9de","#7d30fe","#815f2d","#737f3b","#c84486","#946cfe","#e55432","#a88674","#c17a47","#b98b91","#fc4bb3","#da7f5f","#df920b","#b7bbba","#99e6d9","#a36170","#c742d8","#947f9d","#a37d93","#889072","#9b924c","#23b4bc","#e6a25f","#86df9c","#a7da6c","#3fee03","#eec9d8","#aafdcb","#7b9139","#92979c","#72788a","#994cff","#c85956","#7baa1a","#de72fe","#c7bad8","#85ebfe","#6e6089","#9b4d31","#297a1d","#9052c0","#698eba","#d46222","#6da095","#b483bb","#04d183","#9bcdfe","#2ffe8c","#9d4279","#c909aa","#826cae"];function it(e,t,a){return new Promise((function(t,r){S()(e,{cast:!0,columns:!0,delimiter:"\t",skip_empty_lines:!0},(function(e,s){if(e)r(e);else{var n,i=0,o=s[0]["#CHR"],l=[],c=Object(f.a)(s);try{for(c.s();!(n=c.n()).done;){var h=n.value;a&&void 0!==h.CLUSTER||(h.CLUSTER=-1),h.logRD=Math.log2(h.RD),o!==h["#CHR"]&&(l.push({name:o,length:i-0}),o=h["#CHR"]),i=Number(h.END),h.reverseBAF=.5-h.BAF}}catch(v){c.e(v)}finally{c.f()}l.push({name:o,length:i-0}),l.sort((function(e,t){return e.name.localeCompare(t.name,void 0,{numeric:!0,sensitivity:"base"})})),at=new Be(l);var u,d=Object(f.a)(s);try{for(d.s();!(u=d.n()).done;){var p=u.value;p.genomicPosition=at.getImplicitCoordinates(new A(p["#CHR"],p.START,p.END)).start}}catch(v){d.e(v)}finally{d.f()}t(s)}}))}))}function ot(e){return new Promise((function(t,a){S()(e,{cast:!0,columns:!0,delimiter:"\t",skip_empty_lines:!0,skip_lines_with_error:!0},(function(e,r){if(e)a(e);else{var s,n=Object(f.a)(r);try{for(n.s();!(s=n.n()).done;){var i=s.value,o=i["Genome Location"].split(":"),l=o[1].split("-"),c=new A(o[0],Number(l[0]),Number(l[1]));i.location=c}}catch(h){n.e(h)}finally{n.f()}t(r)}}))}))}!function(e){e[e.none=0]="none",e[e.readingFile=1]="readingFile",e[e.processing=2]="processing",e[e.done=3]="done",e[e.error=4]="error"}(rt||(rt={})),function(e){e[e.zoom=0]="zoom",e[e.select=1]="select",e[e.boxzoom=2]="boxzoom",e[e.erase=3]="erase"}(st||(st={}));var lt=function(e){Object(p.a)(a,e);var t=Object(v.a)(a);function a(e){var r;Object(h.a)(this,a),(r=t.call(this,e)).state={processingStatus:rt.none,indexedData:new z([]),hoveredLocation:null,selectedChr:z.ALL_CHRS_KEY,selectedCluster:z.ALL_CLUSTERS_KEY,invertAxis:!1,sampleAmount:2,showComponents:[!0,!0],color:"blue",colors:nt,assignCluster:!1,assigned:!1,applyLog:!1,applyClustering:!1,inputError:!1,value:"0",updatedBins:!1,selectedSample:"",displayMode:st.zoom,sidebar:!0,chosenFile:"",showLinearPlot:!0,showScatterPlot:!0,showDirections:!1,showLog:!1,showCentroidTable:!1,showCentroids:!1,syncScales:!1,scales:{xScale:null,yScale:null},driverGenes:null,showSilhouttes:rt.none,silhouttes:[]},r.handleFileChoosen=r.handleFileChoosen.bind(Object(d.a)(r)),r.handleDemoFileInput=r.handleDemoFileInput.bind(Object(d.a)(r)),r.handleDriverFileChosen=r.handleDriverFileChosen.bind(Object(d.a)(r)),r.handleDemoDrivers=r.handleDemoDrivers.bind(Object(d.a)(r)),r.handleChrSelected=r.handleChrSelected.bind(Object(d.a)(r)),r.handleClusterSelected=r.handleClusterSelected.bind(Object(d.a)(r)),r.handleLocationHovered=y.a.throttle(r.handleLocationHovered.bind(Object(d.a)(r)),50),r.handleAxisInvert=r.handleAxisInvert.bind(Object(d.a)(r)),r.handleAddSampleClick=r.handleAddSampleClick.bind(Object(d.a)(r)),r.handleColorChange=r.handleColorChange.bind(Object(d.a)(r)),r.handleAssignCluster=r.handleAssignCluster.bind(Object(d.a)(r)),r.handleCallBack=r.handleCallBack.bind(Object(d.a)(r)),r.handleClusterAssignmentInput=r.handleClusterAssignmentInput.bind(Object(d.a)(r)),r.updateBrushedBins=r.updateBrushedBins.bind(Object(d.a)(r)),r.onClusterRowsChange=r.onClusterRowsChange.bind(Object(d.a)(r)),r.onClusterColorChange=r.onClusterColorChange.bind(Object(d.a)(r)),r.onSelectedSample=r.onSelectedSample.bind(Object(d.a)(r)),r.handleRemovePlot=r.handleRemovePlot.bind(Object(d.a)(r)),r.setDisplayMode=r.setDisplayMode.bind(Object(d.a)(r)),r.onSideBarChange=r.onSideBarChange.bind(Object(d.a)(r)),r.toggleLog=r.toggleLog.bind(Object(d.a)(r)),r.onToggleLinear=r.onToggleLinear.bind(Object(d.a)(r)),r.onToggleScatter=r.onToggleScatter.bind(Object(d.a)(r)),r.onToggleSync=r.onToggleSync.bind(Object(d.a)(r)),r.goBackToPreviousCluster=r.goBackToPreviousCluster.bind(Object(d.a)(r)),r.handleZoom=r.handleZoom.bind(Object(d.a)(r)),r.onToggleShowCentroids=r.onToggleShowCentroids.bind(Object(d.a)(r)),r.onToggleSilhoutteBarPlot=r.onToggleSilhoutteBarPlot.bind(Object(d.a)(r)),r.onToggleDirections=r.onToggleDirections.bind(Object(d.a)(r)),r.onToggleShowCentroidTable=r.onToggleShowCentroidTable.bind(Object(d.a)(r)),r.onTogglePreviousActionLog=r.onTogglePreviousActionLog.bind(Object(d.a)(r)),r.onClearClustering=r.onClearClustering.bind(Object(d.a)(r));var s=Object(d.a)(r);return w.j("body").on("keypress",(function(){"z"===w.f.key?s.setState({displayMode:st.zoom}):"b"===w.f.key?s.setState({displayMode:st.select}):"e"===w.f.key?s.setState({displayMode:st.erase}):32===w.f.keyCode?s.onSideBarChange(!s.state.sidebar):"l"===w.f.key?s.setState({showLog:!s.state.showLog}):"c"===w.f.key?s.setState({showCentroidTable:!s.state.showCentroidTable}):"s"===w.f.key&&s.onToggleSilhoutteBarPlot()})),w.j("body").on("keydown",(function(){s.state.displayMode===st.zoom&&"Shift"===w.f.key?s.setState({displayMode:st.boxzoom}):"/"===w.f.key||"?"===w.f.key?s.setState({showDirections:!0}):s.state.displayMode!==st.zoom&&s.state.displayMode!==st.erase||"Meta"!==w.f.key?s.state.displayMode!==st.zoom&&s.state.displayMode!==st.select||"Alt"!==w.f.key||s.setState({displayMode:st.erase}):s.setState({displayMode:st.select})})),w.j("body").on("keyup",(function(){s.state.displayMode===st.boxzoom&&"Shift"===w.f.key?s.setState({displayMode:st.zoom}):"/"===w.f.key||"?"===w.f.key?s.setState({showDirections:!1}):(s.state.displayMode===st.select&&"Meta"===w.f.key||s.state.displayMode===st.erase&&"Alt"===w.f.key)&&s.setState({displayMode:st.zoom})})),r}return Object(u.a)(a,[{key:"handleFileChoosen",value:function(){var e=Object(c.a)(b.a.mark((function e(t,a){var r,s,n,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.target.files)&&r[0]){e.next=3;break}return e.abrupt("return");case 3:return this.setState({chosenFile:r[0].name}),this.setState({processingStatus:rt.readingFile}),s="",e.prev=6,e.next=9,tt(r[0]);case 9:s=e.sent,e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(6),console.error(e.t0),this.setState({processingStatus:rt.error}),e.abrupt("return");case 17:return this.setState({processingStatus:rt.processing}),n=null,e.prev=19,e.next=22,it(s,this.state.applyLog,a);case 22:i=e.sent,n=new z(i),e.next=31;break;case 26:return e.prev=26,e.t1=e.catch(19),console.error(e.t1),this.setState({processingStatus:rt.error}),e.abrupt("return");case 31:this.setState({indexedData:n,processingStatus:rt.done});case 32:case"end":return e.stop()}}),e,this,[[6,12],[19,26]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleDemoFileInput",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var a=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({chosenFile:"a12.tsv"}),this.setState({processingStatus:rt.readingFile}),fetch("https://raw.githubusercontent.com/elkebir-group/cnaviz/master/data/a12.tsv").then((function(e){return e.text()})).then((function(e){a.setState({processingStatus:rt.processing}),it(e,a.state.applyLog,t).then((function(e){var t=new z(e);a.setState({indexedData:t,processingStatus:rt.done})})).catch((function(e){console.error(e),a.setState({processingStatus:rt.error})}))}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleDriverFileChosen",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var a,r,s,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t.target.files)&&a[0]){e.next=3;break}return e.abrupt("return");case 3:return r="",e.prev=4,e.next=7,tt(a[0]);case 7:r=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(e.t0),e.abrupt("return");case 14:return s=null,e.prev=15,e.next=18,ot(r);case 18:n=e.sent,s=n,e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(15),console.error(e.t1),e.abrupt("return");case 26:this.setState({driverGenes:s});case 27:case"end":return e.stop()}}),e,this,[[4,10],[15,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleDemoDrivers",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://raw.githubusercontent.com/elkebir-group/cnaviz/master/data/drivers.tsv").then((function(e){return e.text()})).then((function(e){ot(e).then((function(e){t.setState({driverGenes:e})})).catch((function(e){console.error(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChrSelected",value:function(e){this.setState({selectedChr:e.target.value}),this.state.indexedData.setChrFilter(e.target.value)}},{key:"handleClusterSelected",value:function(e){this.setState({selectedCluster:e.target.value}),this.state.indexedData.setClusterFilters([e.target.value])}},{key:"handleLocationHovered",value:function(e){e?this.setState({hoveredLocation:e}):this.setState({hoveredLocation:null})}},{key:"handleClusterAssignmentInput",value:function(e){this.setState({value:e.target.value})}},{key:"handleCallBack",value:function(e){this.state.indexedData.updateCluster(Number(e)),this.setState({assignCluster:!1}),this.state.indexedData.setChrFilter(this.state.selectedChr)}},{key:"updateBrushedBins",value:function(e){this.state.indexedData.setbrushedBins(e),this.setState({updatedBins:!0})}},{key:"handleAxisInvert",value:function(){this.setState({invertAxis:!this.state.invertAxis})}},{key:"handleAddSampleClick",value:function(){var e=this.state.showComponents.concat([!0]);this.setState({showComponents:e}),this.setState({sampleAmount:this.state.sampleAmount+1})}},{key:"handleRemovePlot",value:function(e){var t=Object(l.a)(this.state.showComponents);t.splice(e,1),this.setState({showComponents:t}),this.setState({sampleAmount:this.state.sampleAmount-1})}},{key:"handleAssignCluster",value:function(){this.setState({assignCluster:!this.state.assignCluster})}},{key:"handleColorChange",value:function(e){this.setState({color:e.hex})}},{key:"getStatusCaption",value:function(){switch(this.state.processingStatus){case rt.readingFile:return Object(K.jsxs)("div",{children:["Reading file... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]});case rt.processing:return Object(K.jsxs)("div",{children:["Processing data... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]});case rt.error:return"ERROR";case rt.none:case rt.done:default:return""}}},{key:"onToggleDirections",value:function(){this.setState({showDirections:!this.state.showDirections})}},{key:"toggleLog",value:function(){this.setState({applyLog:!this.state.applyLog}),this.state.indexedData.setShouldRecalculateSilhouttes(!0)}},{key:"toggleClustering",value:function(){this.setState({applyClustering:!this.state.applyClustering})}},{key:"onClusterRowsChange",value:function(e){this.state.indexedData.setClusterFilters(e.selectedRows.map((function(e){return String(e.key)}))),this.setState({indexedData:this.state.indexedData})}},{key:"onClusterColorChange",value:function(e){var t,a=[],r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var s=t.value;a.push(s)}}catch(n){r.e(n)}finally{r.f()}this.setState({colors:a})}},{key:"onSelectedSample",value:function(e){this.setState({selectedSample:e})}},{key:"setDisplayMode",value:function(e){this.setState({displayMode:e})}},{key:"onSideBarChange",value:function(e){this.setState({sidebar:e})}},{key:"onToggleScatter",value:function(){this.setState({showScatterPlot:!this.state.showScatterPlot})}},{key:"onToggleLinear",value:function(){this.setState({showLinearPlot:!this.state.showLinearPlot})}},{key:"onToggleSync",value:function(){this.setState({syncScales:!this.state.syncScales})}},{key:"onToggleShowCentroids",value:function(){this.setState({showCentroids:!this.state.showCentroids})}},{key:"onToggleShowCentroidTable",value:function(){this.setState({showCentroidTable:!this.state.showCentroidTable})}},{key:"goBackToPreviousCluster",value:function(){this.state.indexedData.undoClusterUpdate(),this.setState({indexedData:this.state.indexedData})}},{key:"handleZoom",value:function(e){this.setState({scales:e})}},{key:"onTogglePreviousActionLog",value:function(){this.setState({showLog:!this.state.showLog})}},{key:"onClearClustering",value:function(){this.state.indexedData.clearClustering(),this.setState({indexedData:this.state.indexedData})}},{key:"onToggleSilhoutteBarPlot",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.state.showSilhouttes===rt.none?(this.setState({showSilhouttes:rt.processing}),this.state.indexedData.recalculateSilhouttes(this.state.applyLog).then((function(e){void 0!==e&&(t.setState({silhouttes:e}),t.setState({showSilhouttes:rt.done}))}))):this.setState({showSilhouttes:rt.none});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.indexedData,r=t.selectedChr,s=t.selectedCluster,n=t.hoveredLocation,i=t.invertAxis,l=t.color,c=t.assignCluster,h=t.updatedBins,u=t.value,d=t.sampleAmount,p=a.getSampleList(),v=a.getBrushedBins(),f=a.getAllRecords(),g=null,b=a.getClusterTableInfo(),m=[Object(K.jsx)("option",{value:z.ALL_CHRS_KEY,children:"ALL"},z.ALL_CHRS_KEY)],S=a.getActions();if(this.state.processingStatus===rt.done&&!a.isEmpty()){var C=a.getClusterTableInfo(),j={data:a,hoveredLocation:n||void 0,onLocationHovered:this.handleLocationHovered,invertAxis:i,chr:r,cluster:s,customColor:l,colors:this.state.colors,assignCluster:c,onBrushedBinsUpdated:this.updateBrushedBins,parentCallBack:this.handleCallBack,brushedBins:v,updatedBins:h,onSelectedSample:this.onSelectedSample,selectedSample:this.state.selectedSample,dispMode:this.state.displayMode,onRemovePlot:this.handleRemovePlot,onAddSample:this.handleAddSampleClick,clusterTableData:C,applyLog:this.state.applyLog,onClusterSelected:this.handleClusterSelected,onUndoClick:this.goBackToPreviousCluster,showCentroids:this.state.showCentroids,driverGenes:this.state.driverGenes};(m=a.getAllChromosomes().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}))).push(Object(K.jsx)("option",{value:z.ALL_CHRS_KEY,children:"ALL"},z.ALL_CHRS_KEY)),a.getAllClusters().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)})).push(Object(K.jsx)("option",{value:z.ALL_CLUSTERS_KEY,children:"ALL"},z.ALL_CLUSTERS_KEY)),g=Object(K.jsx)("div",{id:"grid-container",children:Object(K.jsx)("div",{className:"sampleviz-wrapper-row",children:y.a.times(d,(function(t){return p.length>t&&e.state.showComponents[t]&&Object(K.jsx)(ke,Object(o.a)(Object(o.a)({},j),{},{initialSelectedSample:p[t],plotId:t,showLinearPlot:e.state.showLinearPlot,showScatterPlot:e.state.showScatterPlot,showSidebar:e.state.sidebar,sampleAmount:d,syncScales:e.state.syncScales,handleZoom:e.handleZoom,scales:e.state.scales}),t)}))})})}var A=this.getStatusCaption();return Object(K.jsxs)("div",{className:"container-fluid",children:[Object(K.jsx)("div",{children:Object(K.jsx)(Me,{selectedChr:r,onChrSelected:this.handleChrSelected,chrOptions:m,onAddSample:this.handleAddSampleClick,onAssignCluster:this.handleAssignCluster,tableData:b,onClusterRowsChange:this.onClusterRowsChange,onClusterColorChange:this.onClusterColorChange,currentClusterFilters:a.getFilteredClusters(),handleClusterAssignmentInput:this.handleClusterAssignmentInput,value:u,setDisplayMode:this.setDisplayMode,currentDisplayMode:this.state.displayMode,colors:this.state.colors,onSidebarChange:this.onSideBarChange,data:f,onFileChosen:this.handleFileChoosen,chosenFile:this.state.chosenFile,show:this.state.sidebar,onToggleLog:this.toggleLog,onToggleLinear:this.onToggleLinear,onToggleScatter:this.onToggleScatter,showScatter:this.state.showScatterPlot,showLinear:this.state.showLinearPlot,onToggleSync:this.onToggleSync,syncScales:this.state.syncScales,logData:S,onToggleShowCentroids:this.onToggleShowCentroids,showCentroids:this.state.showCentroids,onDriverFileChosen:this.handleDriverFileChosen,onToggleSilhouttes:this.onToggleSilhoutteBarPlot,showSilhouttes:this.state.showSilhouttes,onToggleDirections:this.onToggleDirections,onToggleShowCentroidTable:this.onToggleShowCentroidTable,onTogglePreviousActionLog:this.onTogglePreviousActionLog,onClearClustering:this.onClearClustering,handleDemoFileInput:this.handleDemoFileInput,handleDemoDrivers:this.handleDemoDrivers})}),Object(K.jsxs)("div",{className:this.state.sidebar?"marginContent":"",children:[A&&Object(K.jsx)("div",{className:"App-status-pane",children:A}),g,this.state.showDirections&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showDirections&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:"Directions"}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:this.onToggleDirections,children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)("h5",{children:" Selection/Erasing "}),Object(K.jsx)("li",{children:' Hold down "Command/Control" in Zoom mode to temporarily enter Select mode '}),Object(K.jsx)("li",{children:' Hold down "Alt" in Zoom mode to temporarily enter Erase mode '}),Object(K.jsx)("li",{children:" To completely clear your selection, click anywhere in the plot while in Select/Erase mode "}),Object(K.jsx)("li",{children:" To stay in Select mode without holding a button, you can click b or switch the toggle button in the sidebar "}),Object(K.jsx)("li",{children:" To stay in Erase mode without holding a button, you can click e "}),Object(K.jsx)("h5",{children:" Zoom Mode "}),Object(K.jsx)("li",{children:" The default mode is zoom mode"}),Object(K.jsx)("li",{children:" In zoom mode, if you hold down shift, it will act as a bounding box zoom (in the scatterplot) "}),Object(K.jsx)("h5",{children:" Other Key Modifiers "}),Object(K.jsx)("li",{children:' Click "l" to toggle a log of previous actions '}),Object(K.jsx)("li",{children:" Click space to toggle the sidebar "}),Object(K.jsx)("li",{children:' Hold down "?" or "/" button to open direction panel '}),Object(K.jsx)("li",{children:' Click "c" to toggle a table of the centroids of each cluster for each sample '}),Object(K.jsx)("li",{children:' Click "s" to toggle a bar plot displaying approximate average silhoutte scores for each cluster '})]}),this.state.showLog&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showLog&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Previous Actions "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:function(){return e.setState({showLog:!e.state.showLog})},children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)(De,{data:S,onClusterColorChange:this.onClusterColorChange,onClusterRowsChange:this.onClusterRowsChange,colName:"Actions (Starting from most recent)"})]}),this.state.showCentroidTable&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showCentroidTable&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Centroid Table "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:function(){return e.setState({showCentroidTable:!e.state.showCentroidTable})},children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)(xe,{data:a.getCentroidData(),onClusterColorChange:this.onClusterColorChange,onClusterRowsChange:this.onClusterRowsChange,colors:nt,currentFilters:[""],centroidTable:!0,colOneName:"Cluster",colTwoName:"Sample",colThreeName:"Centroid",cols:[{name:"Cluster",type:"key"},{name:"Sample",type:"sample"},{name:"Centroid",type:"centroid"}]})]}),this.state.showSilhouttes===rt.done&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showSilhouttes===rt.done&&Object(K.jsx)(et,{silhoutteData:this.state.silhouttes,avgClusterSilhoutte:this.state.indexedData.getAvgSilhoutte(),clusterDistances:this.state.indexedData.getClusterDistanceMatrix(),clusterTableData:b,colors:nt,onToggleSilhoutteBarPlot:this.onToggleSilhoutteBarPlot})]})]})}}]),a}(s.a.Component);i.a.render(Object(K.jsx)(lt,{}),document.getElementById("root"))}},[[361,1,2]]]);
//# sourceMappingURL=main.46d0c132.chunk.js.map