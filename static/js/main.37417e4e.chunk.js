(this.webpackJsonpcnaviz=this.webpackJsonpcnaviz||[]).push([[0],{112:function(e,t,s){},192:function(e,t,s){},193:function(e,t,s){},194:function(e,t,s){},217:function(e,t,s){},231:function(e,t){},233:function(e,t){},244:function(e,t,s){},246:function(e,t,s){},247:function(e,t,s){},358:function(e,t,s){},359:function(e,t,s){},361:function(e,t,s){"use strict";s.r(t);var r=s(1),a=s.n(r),n=s(196),i=s.n(n),o=(s(217),s(28)),l=s(18),c=s(33),h=s(10),u=s(11),d=s(8),p=s(15),v=s(14),f=s(9),g=s(17),b=s.n(g),m=s(135),S=s.n(m),C=s(6),y=s.n(C),j=function(e){function t(e,s){if(Object(h.a)(this,t),this.start=e,this.end=s,s<e)throw new RangeError("End cannot be less than start");this.start=e,this.end=s}return Object(u.a)(t,[{key:e,value:b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.start;case 2:return e.next=4,this.end;case 4:case"end":return e.stop()}}),e,this)}))},{key:"getLength",value:function(){return this.end-this.start}},{key:"getCenter",value:function(){return.5*(this.start+this.end)}},{key:"hasOverlap",value:function(e){return Math.max(this.start,e.start)<Math.min(this.end,e.end)}},{key:"toString",value:function(){return"[".concat(this.start,", ").concat(this.end,")")}}]),t}(Symbol.iterator),A=function(){function e(t,s,r){if(Object(h.a)(this,e),this.chr=void 0,this._interval=void 0,s<0)throw new RangeError("Start cannot be negative");this.chr=t,this._interval=new j(s,r)}return Object(u.a)(e,[{key:"start",get:function(){return this._interval.start}},{key:"end",get:function(){return this._interval.end}},{key:"getLength",value:function(){return this._interval.getLength()}},{key:"hasOverlap",value:function(e){return this.chr===e.chr&&this._interval.hasOverlap(e._interval)}},{key:"toString",value:function(){return"".concat(this.chr,":").concat(this.start,"-").concat(this.end)}},{key:"endsRoundedToMultiple",value:function(t){if(t<=0)throw new RangeError("Cannot round to a multiple <= 0 (got ".concat(t,")"));return new e(this.chr,Math.floor(this.start/t)*t,Math.ceil(this.end/t)*t)}}],[{key:"parse",value:function(t){var s=t.match(/([\w:]+)\W+(\d+)\W+(\d+)/);if(s)return new e(s[1],Number.parseInt(s[2],10),Number.parseInt(s[3],10));throw new RangeError("Could not parse interval")}}]),e}(),x=s(63),O={toChromosomeInterval:function(e){return new A(e["#CHR"],e.START,e.END)},flattenNestedBins:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=0,r=e.length;s<r;s++){var a=e[s];Array.isArray(a)?this.flattenNestedBins(a,t):t.push(a)}return t}},_=s(51),k=s(59),w=s(4);function D(e,t){t||(t=e.currentTarget);var s=t.getBoundingClientRect();return{x:e.clientX-s.left,y:e.clientY-s.top}}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0,r=e;if(s&&(r-=s),r<0)return"";var a=Math.floor(r);return a>=75e4?"".concat((a/1e6).toFixed(t)," Mb"):a>=1e4?"".concat((a/1e3).toFixed(t)," kb"):"".concat(a," bp")}function L(e,t,s){if(e.length!==t.length)throw Error("Calculate Euclidean Distance - pointOne dim does not match pointTwo dim");for(var r=0,a=0;a<e.length;a++){var n=Number(e[a])-Number(t[a]);r+=n*n}return!0===s?Math.sqrt(r):r}var R=function(e){var t=w.e(e);if(null!==t){var s=t.rgb();return[s.r/255,s.g/255,s.b/255,s.opacity]}},T=function(e,t){var s,r=[],a=Object(f.a)(t);try{for(a.s();!(s=a.n()).done;){var n=s.value;r.push(L(e,n,!0))}}catch(i){a.e(i)}finally{a.f()}return y.a.mean(r)},E=function(e,t){var s=[];if(1===t.length)return 0;var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var n=L(e,r.value,!0);0!==n&&s.push(n)}}catch(i){a.e(i)}finally{a.f()}return y.a.mean(s)};function P(e,t,s,r){var a=Object(l.a)(t.keys()),n=new Map;if(1===a.length)return[];for(var i=0,o=e.length>0?.01:1,c=0;c<e.length;c++){var h=e[c],u=s[c],d=new Map,p=t.get(u);if(!p)throw new Error("Key error: Cluster not found");if(1!==p.length){var v,g=M(p,o),b=E(h,g),m=1/0,S=Object(f.a)(a);try{for(S.s();!(v=S.n()).done;){var C=v.value;if(C!==u){var j=t.get(C);if(!j)throw new Error("Key error: Cluster not found");var A=M(j,o),x=T(h,A);d.set(Number(C),x),x<m&&(m=x)}}}catch(I){S.e(I)}finally{S.f()}var O=y.a.max([m,b]);if(O){var _=(m-b)/O;if(i+=_,n.has(u)){var k=n.get(u);k&&(k.push(_),n.set(u,k))}else n.set(u,[_])}r.set(u,d)}else if(n.has(u)){var w=n.get(u);w&&(w.push(0),n.set(u,w))}else n.set(u,[0])}var D,B=[],L=Object(f.a)(a);try{for(L.s();!(D=L.n()).done;){var R=D.value,P=n.get(Number(R));if(void 0!==P){var N={cluster:Number(R),avg:y.a.mean(P)};B.push(N)}}}catch(I){L.e(I)}finally{L.f()}var F=i/e.length;return console.log(F),y.a.sortBy(B,"cluster")}function M(e,t){for(var s=new Set,r=e.length,a=t*r;s.size<a;){var n=e[Math.floor(Math.random()*r)];s.add(n)}return Object(l.a)(s)}var N=function(e){return Array.isArray(e)&&e.every((function(e){return"object"===typeof e&&!(e instanceof Array)}))},F=function(e,t){var s,r=t=t||(s=e,Array.from(s.map((function(e){return Object.keys(e)})).reduce((function(e,t){return new Set([].concat(Object(l.a)(e),Object(l.a)(t)))}),[]))),a=t;N(t)&&(r=t.map((function(e){return e.label})),a=t.map((function(e){return e.key})));var n=e.map((function(e){return a.map((function(t){return I(t,e)}))}));return[r].concat(Object(l.a)(n))},I=function(e,t){var s=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce((function(e,t,s,r){return void 0===e[t]?(r.splice(1),null):e[t]}),t);return void 0===s?e in t?t[e]:"":s},U=function(e){return"undefined"===typeof e||null===e?"":e},Y=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",";return e.filter((function(e){return e})).map((function(e){return e.map((function(e){return U(e)})).map((function(e){return"".concat(e)})).join(t)})).join("\n")},G=function(e,t,s,r){if(N(e))return function(e,t,s,r){return Y(F(e,t),s,r)}(e,t,s,r);if(a=e,Array.isArray(a)&&a.every((function(e){return Array.isArray(e)})))return function(e,t,s,r){return Y(t?[t].concat(Object(l.a)(e)):e,s,r)}(e,t,s,r);var a;if("string"===typeof e)return function(e,t,s,r){return t?"".concat(t.join(s),"\n").concat(e):e}(e,t,s);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};function H(e,t,s){return new Promise((function(r,a){for(var n=[],i=[],o=new Map,l=t?"logRD":"RD",c=0;c<s.length;c+=e.length){for(var h=[],u=s[c].CLUSTER,d=c;d<c+e.length;d++){if(!(d<s.length))throw Error("Out of Range Error. There are bins missing in the data (bin must exist across all samples).");var p=s[d];d===c&&i.push(u),h.push(p.reverseBAF),h.push(p[l])}if(n.push(h),o.has(u)){var v=o.get(u);void 0!==v&&(v.push(h),o.set(u,v))}else o.set(u,[h])}r({multiDimData:n,clusterToData:o,labels:i})}))}var z=function(){function e(t){Object(h.a)(this,e),this._rdRanges=void 0,this._logRdRanges=void 0,this._locationGroupedData=void 0,this.brushedBins=void 0,this.brushedCrossfilter=void 0,this.brushedClusterDim=void 0,this._ndx=void 0,this._sample_dim=void 0,this._cluster_dim=void 0,this._chr_dim=void 0,this._genomic_pos_dim=void 0,this._samples=void 0,this._clusters=void 0,this._chrs=void 0,this._sampleGroupedData=void 0,this.clusterTableInfo=void 0,this.allRecords=void 0,this._cluster_filters=void 0,this.historyStack=void 0,this._clusterAmounts=void 0,this.logOfActions=void 0,this.centroids=void 0,this.centroidPts=void 0,this.chrToClusters=void 0,this.centroidDistances=void 0,this.shouldCalculatesilhouettes=void 0,this.currentsilhouettes=void 0,this.overallSilhouette=void 0,this.clusterDistanceMatrix=void 0,this._locationGroupedData={},this.initializeLocationGroupedData(t),this._sampleGroupedData={},this._rdRanges={},this._logRdRanges={},this._samples=[],this._chrs=[],this._clusters=[],this.brushedBins=[],this.brushedCrossfilter=Object(_.a)(this.brushedBins),this.brushedClusterDim=this.brushedCrossfilter.dimension((function(e){return e.CLUSTER})),this._cluster_filters=[],this.historyStack=[],this._ndx=Object(_.a)(t),this.logOfActions=[],this.centroidPts={},this.centroids=[],this.chrToClusters={},this.centroidDistances={},this.shouldCalculatesilhouettes=!0,this.currentsilhouettes=[],this.clusterDistanceMatrix=new Map,this.overallSilhouette=0;var s,r=Object(f.a)(t);try{for(r.s();!(s=r.n()).done;){var a=s.value;this.chrToClusters[a["#CHR"]]?this.chrToClusters[a["#CHR"]].add(String(a.CLUSTER)):this.chrToClusters[a["#CHR"]]=new Set([String(a.CLUSTER)])}}catch(K){r.e(K)}finally{r.f()}for(var n=y.a.groupBy(t,"SAMPLE"),i=0,o=Object.entries(n);i<o.length;i++){var l=Object(x.a)(o[i],2),c=l[0],u=l[1];this._samples.push(c);var d=y.a.groupBy(u,"CLUSTER");this._clusters=y.a.union(this._clusters,Object.keys(d));for(var p=0,v=Object.values(d);p<v.length;p++){var g=v[p],b=y.a.groupBy(g,"#CHR");this._chrs=y.a.union(this._chrs,Object.keys(b))}}for(var m=y.a.groupBy(t,"CLUSTER"),S=0,C=Object.entries(m);S<C.length;S++){for(var j=Object(x.a)(C[S],2),A=j[0],O=j[1],w=y.a.groupBy(O,"SAMPLE"),D={},B=0,L=Object.entries(w);B<L.length;B++){var R=Object(x.a)(L[B],2),T=R[0],E=R[1],P=this.calculateCentroid(E,"RD"),M={cluster:parseInt(A),point:P};if(this.centroidPts[T]&&this.centroidPts[A])this.centroidPts[T][A].push(M);else if(this.centroidPts[T])this.centroidPts[T][A]=[M];else{var N={};N[A]=[M],this.centroidPts[T]=N}var F="("+P[0].toFixed(2)+","+P[1].toFixed(2)+")";D[T]=F}var I={key:A,sample:D};this.centroids.push(I)}if(this._cluster_filters=this._clusters,this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this._genomic_pos_dim=this._ndx.dimension((function(e){return e.genomicPosition})),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE"),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),t.length>0){var U,Y=Object(f.a)(this._samples);try{for(Y.s();!(U=Y.n()).done;){var G=U.value,H=this._sampleGroupedData[G],z=[y.a.minBy(H,"RD").RD,y.a.maxBy(H,"RD").RD],X=[y.a.minBy(H,"logRD").logRD,y.a.maxBy(H,"logRD").logRD];this._rdRanges[G]=z,this._logRdRanges[G]=X}}catch(K){Y.e(K)}finally{Y.f()}}this.initializeCentroidDistMatrix(),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.filterRecordsByScales=Object(k.a)(this.filterRecordsByScales)}return Object(u.a)(e,[{key:"setShouldRecalculatesilhouettes",value:function(e){this.shouldCalculatesilhouettes=e}},{key:"getClusterDistanceMatrix",value:function(){return this.clusterDistanceMatrix}},{key:"getAvgSilhouette",value:function(){return this.overallSilhouette}},{key:"recalculatesilhouettes",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.shouldCalculatesilhouettes){e.next=16;break}return s=null,e.prev=2,e.next=5,H(this._samples,t,this.allRecords);case 5:s=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return");case 12:r=P(s.multiDimData,s.clusterToData,s.labels,this.clusterDistanceMatrix),this.overallSilhouette=Number((a=r,y.a.meanBy(a,"avg")).toFixed(3)),this.currentsilhouettes=r,this.shouldCalculatesilhouettes=!1;case 16:return e.abrupt("return",this.currentsilhouettes);case 17:case"end":return e.stop()}var a}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeCentroidDistMatrix",value:function(){var e,t=Object(f.a)(this._samples);try{for(t.s();!(e=t.n()).done;){var s=e.value;this.centroidDistances[s]=[];var r,a=this.getCentroidPoints(s),n=Object(f.a)(a);try{for(n.s();!(r=n.n()).done;){var i,o=r.value,l=Object(f.a)(a);try{for(l.s();!(i=l.n()).done;){var c=i.value,h=L(o.point,c.point);this.centroidDistances[s].push({cluster1:o.cluster,cluster2:c.cluster,dist:h})}}catch(u){l.e(u)}finally{l.f()}}}catch(u){n.e(u)}finally{n.f()}}}catch(u){t.e(u)}finally{t.f()}}},{key:"getCentroidDistMatrix",value:function(e){return this.centroidDistances[e]}},{key:"calculateCentroid",value:function(e,t){return[y.a.meanBy(e,(function(e){return e.reverseBAF})),y.a.meanBy(e,(function(e){return e[t]}))]}},{key:"getCentroidData",value:function(){return this.centroids}},{key:"getCentroidPoints",value:function(e,t){var s,r=this.centroidPts[e],a=this._cluster_filters;s=t?this.chrToClusters[t]:new Set(a);var n,i=[],o=Object(f.a)(a);try{for(o.s();!(n=o.n()).done;){var l=n.value;s.has(l)&&r[l.valueOf()]&&i.push(r[l.valueOf()][0])}}catch(c){o.e(c)}finally{o.f()}return i}},{key:"calculateClusterTableInfo",value:function(){var e,t=this._cluster_dim.group().all(),s=[],r=Object(f.a)(t);try{for(r.s();!(e=r.n()).done;){var a=e.value,n=Number((Number(a.value)/this.allRecords.length*100).toFixed(2));s.push({key:Number(a.key),value:n})}}catch(i){r.e(i)}finally{r.f()}return s}},{key:"initializeLocationGroupedData",value:function(e){this._locationGroupedData={};var t,s=Object(f.a)(e);try{for(s.s();!(t=s.n()).done;){var r=t.value,a=O.toChromosomeInterval(r).toString();this._locationGroupedData[a]?this._locationGroupedData[a].push(r):this._locationGroupedData[a]=[r]}}catch(n){s.e(n)}finally{s.f()}}},{key:"isEmpty",value:function(){return 0===this.getSampleList().length}},{key:"getRdRange",value:function(e,t){var s=t?this._logRdRanges[e]:this._rdRanges[e];return[s[0],s[1]]}},{key:"getSampleList",value:function(){return this._samples}},{key:"getAllChromosomes",value:function(){return this._chrs}},{key:"getAllClusters",value:function(){return this._clusters}},{key:"setFilters",value:function(e,t,s){t&&this._chr_dim.filter((function(e){return e===t})),s&&this._cluster_dim.filter((function(e){return-1!==s.indexOf(String(e))}))}},{key:"setChrFilter",value:function(e){e?(this._chr_dim.filterAll(),this._chr_dim.filter((function(t){return t===e}))):this._chr_dim.filterAll(),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"setChrFilters",value:function(t){t&&1===t.length&&t[0]===e.ALL_CHRS_KEY?this._chr_dim.filterAll():t&&(this._chr_dim.filterAll(),this._chr_dim.filter((function(e){return-1!==t.indexOf(String(e))})))}},{key:"setClusterFilters",value:function(t){t&&1===t.length&&t[0]===e.ALL_CLUSTERS_KEY?this._cluster_dim.filterAll():t&&(this._cluster_dim.filterAll(),this._cluster_dim.filter((function(e){return-1!==t.indexOf(String(e))}))),t&&(this._cluster_filters=t),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"setGenomicPositionFilter",value:function(e){this._genomic_pos_dim.filterAll(),this._genomic_pos_dim.filter((function(t){return t>e[0]&&t<e[1]})),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"clearAllFilters",value:function(){this._sample_dim.filterAll(),this._cluster_dim.filterAll(),this._chr_dim.filterAll(),this._sampleGroupedData=y.a.groupBy(this._ndx.allFiltered(),"SAMPLE")}},{key:"getActions",value:function(){return this.logOfActions}},{key:"updateCluster",value:function(e){if(this.brushedBins&&0!==this.brushedBins.length){this.historyStack.push(JSON.parse(JSON.stringify(this.brushedBins)));var t=this.brushedTableData(),s="Assigned to cluster "+e+" | ";s+="Clusters selected: ";var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var n=r.value;s+=String(n.key)+" ("+String(n.value)+"%), "}}catch(I){a.e(I)}finally{a.f()}s+=" | ";var i=[y.a.minBy(this.brushedBins,"RD").RD,y.a.maxBy(this.brushedBins,"RD").RD],o=[y.a.minBy(this.brushedBins,"reverseBAF").reverseBAF,y.a.maxBy(this.brushedBins,"reverseBAF").reverseBAF];s+="RD Range of Selected: ["+i[0].toFixed(2)+", "+i[1].toFixed(2)+"] | ",s+="Allelic Imbalance Range of Selected: ["+o[0].toFixed(2)+", "+o[1].toFixed(2)+"]",this.logOfActions.unshift({action:s});for(var l=0;l<this.brushedBins.length;l++){var c=O.toChromosomeInterval(this.brushedBins[l]).toString();if(this._locationGroupedData[c])for(var h=0;h<this._locationGroupedData[c].length;h++)this._locationGroupedData[c][h].CLUSTER=e}var u=Object.values(this._locationGroupedData),d=O.flattenNestedBins(u);this.centroids=[],this.centroidPts={},this.chrToClusters={};var p,v=Object(f.a)(d);try{for(v.s();!(p=v.n()).done;){var g=p.value;this.chrToClusters[g["#CHR"]]?this.chrToClusters[g["#CHR"]].add(String(g.CLUSTER)):this.chrToClusters[g["#CHR"]]=new Set([String(g.CLUSTER)])}}catch(I){v.e(I)}finally{v.f()}for(var b=y.a.groupBy(d,"CLUSTER"),m=0,S=Object.entries(b);m<S.length;m++){for(var C=Object(x.a)(S[m],2),j=C[0],A=C[1],k=y.a.groupBy(A,"SAMPLE"),w={},D=0,B=Object.entries(k);D<B.length;D++){var L=Object(x.a)(B[D],2),R=L[0],T=L[1],E=this.calculateCentroid(T,"RD"),P={cluster:parseInt(j),point:E};if(this.centroidPts[R]&&this.centroidPts[j])this.centroidPts[R][j].push(P);else if(this.centroidPts[R])this.centroidPts[R][j]=[P];else{var M={};M[j]=[P],this.centroidPts[R]=M}var N="("+E[0].toFixed(2)+","+E[1].toFixed(2)+")";w[R]=N}var F={key:j,sample:w};this.centroids.push(F)}this.initializeCentroidDistMatrix(),this._ndx.remove(),this._ndx=Object(_.a)(d),this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this.brushedBins=[],this.brushedCrossfilter.remove(),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.allRecords=this.allRecords.filter((function(e){return-2!==e.CLUSTER})),this._cluster_filters.includes(String(e))||this._cluster_filters.push(String(e)),this.setClusterFilters(this._cluster_filters),this.shouldCalculatesilhouettes=!0}}},{key:"clearClustering",value:function(){this.brushedBins=Object(l.a)(this.allRecords),this.updateCluster(-1)}},{key:"undoClusterUpdate",value:function(){if(0!==this.historyStack.length){var e=this.historyStack[this.historyStack.length-1];this.historyStack.pop();for(var t=0;t<e.length;t++){var s=e[t],r=O.toChromosomeInterval(s).toString(),a=s.CLUSTER;if(this._cluster_filters.includes(String(a))||this._cluster_filters.push(String(a)),this._locationGroupedData[r])for(var n=0;n<this._locationGroupedData[r].length;n++)this._locationGroupedData[r][n].CLUSTER=a}var i=Object.values(this._locationGroupedData),o=O.flattenNestedBins(i);this.initializeCentroidDistMatrix(),this._ndx.remove(),this._ndx=Object(_.a)(o),this._sample_dim=this._ndx.dimension((function(e){return e.SAMPLE})),this._cluster_dim=this._ndx.dimension((function(e){return e.CLUSTER})),this._chr_dim=this._ndx.dimension((function(e){return e["#CHR"]})),this.brushedBins=[],this.brushedCrossfilter.remove(),this._clusterAmounts=y.a.cloneDeep(this._cluster_dim.group().all()),this.allRecords=this._ndx.all(),this.clusterTableInfo=this.calculateClusterTableInfo(),this.allRecords=this.allRecords.filter((function(e){return-2!==e.CLUSTER})),this.setClusterFilters(this._cluster_filters),this.setShouldRecalculatesilhouettes(!0)}}},{key:"brushedTableData",value:function(){var e=this._samples.length,t=this._clusterAmounts,s={};t.forEach((function(t){return s[Number(t.key)]=Number(t.value)/e}));var r,a=this.brushedBins.length,n=this.brushedClusterDim.group().all(),i=[],o=this._ndx.all().length,l=Object(f.a)(n);try{for(l.s();!(r=l.n()).done;){var c=r.value;i.push({key:Number(c.key),value:Number((Number(c.value)/Number(s[Number(c.key)])*100).toFixed(2)),selectPerc:Number((Number(c.value)/Number(a)*100).toFixed(2)),binPerc:Number((Number(c.value)/Number(o/e)*100).toFixed(2))})}}catch(h){l.e(h)}finally{l.f()}return i}},{key:"getRecords",value:function(e,t,s,r,a,n){return e in this._sampleGroupedData?this.filterRecordsByScales(this._sampleGroupedData[e],t,s,r,a,n):[]}},{key:"filterRecordsByScales",value:function(e,t,s,r,a,n){var i=t?"logRD":"RD";return s&&r&&a&&n?e.filter((function(e){return e.genomicPosition>s&&e.genomicPosition<r&&e.reverseBAF>a[0]&&e.reverseBAF<a[1]&&e[i]>n[0]&&e[i]<n[1]})):s&&r&&a?e.filter((function(e){return e.genomicPosition>s&&e.genomicPosition<r&&e.reverseBAF>a[0]&&e.reverseBAF<a[1]})):s&&r&&n?e.filter((function(e){return e.genomicPosition>s&&e.genomicPosition<r&&e[i]>n[0]&&e[i]<n[1]})):a&&n?e.filter((function(e){return e.reverseBAF>a[0]&&e.reverseBAF<a[1]&&e[i]>n[0]&&e[i]<n[1]})):a?e.filter((function(e){return e.reverseBAF>a[0]&&e.reverseBAF<a[1]})):n?e.filter((function(e){return e[i]>n[0]&&e[i]<n[1]})):e}},{key:"getAllRecords",value:function(){return this.allRecords}},{key:"getClusterTableInfo",value:function(){return this.clusterTableInfo}},{key:"getFilteredClusters",value:function(){return this._cluster_filters}},{key:"setbrushedBins",value:function(e){console.log("Setting Brushed Bins: ",e.length),this.brushedBins=[],this.brushedBins=e,this.brushedCrossfilter.remove(),this.brushedCrossfilter=Object(_.a)(e),this.brushedClusterDim=this.brushedCrossfilter.dimension((function(e){return e.CLUSTER}))}},{key:"getBrushedBins",value:function(){return this.brushedBins}},{key:"getClusterDim",value:function(){return this._cluster_dim}},{key:"_getData",value:function(e,t,s,r){return(e[t][r]||{})[s]||[]}}]),e}();z.ALL_CHRS_KEY="",z.ALL_CLUSTERS_KEY="";var X=s(61),K=(s(244),s(2)),Q=60,Z=20,V=35,J=60,W="#999999",q="rgba(232, 232, 232, 1)",$="-1",ee="-2",te="scatterplot-scale",se="circles",re=0,ae=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;Object(h.a)(this,s),(r=t.call(this,e))._svg=void 0,r._circleIdPrefix=void 0,r._clusters=void 0,r.brushedNodes=void 0,r.previous_brushed_nodes=void 0,r.quadTree=void 0,r._canvas=void 0,r._currXScale=void 0,r._currYScale=void 0,r._original_XScale=void 0,r._original_YScale=void 0,r._original_transform=void 0,r._current_transform=void 0,r.scatter=void 0,r.zoom=void 0,r.onTrigger=function(e){r.props.parentCallBack(e)},r.onBrushedBinsUpdated=function(e){r.props.onBrushedBinsUpdated(e)},r._svg=null,r._canvas=null,r.scatter=null,r._circleIdPrefix=re,re++,r.computeScales=Object(k.a)(r.computeScales),r.handleMouseMove=r.handleMouseMove.bind(Object(d.a)(r)),r.onTrigger=r.onTrigger.bind(Object(d.a)(r)),r.onBrushedBinsUpdated=r.onBrushedBinsUpdated.bind(Object(d.a)(r)),r._clusters=r.initializeListOfClusters(),r.state={selectedCluster:r._clusters.length>0?r._clusters[0]:$},r.brushedNodes=new Set,r.previous_brushed_nodes=new Set,r.onZoom=r.onZoom.bind(Object(d.a)(r)),r.resetZoom=r.resetZoom.bind(Object(d.a)(r)),r.zoom=null;var a=r.computeScales(r.props.rdRange,e.width,e.height),n=a.bafScale,i=a.rdrScale;r._currXScale=n,r._currYScale=i,r._original_XScale=r._currXScale,r._original_YScale=r._currYScale;var o=e.data;return r.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(t){return t[e.yAxisToPlot]})).addAll(o),r._original_transform=w.o.translate(0,0).scale(1),r._current_transform=r._original_transform,r}return Object(u.a)(s,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;e.sort((function(e,t){return e.key>t.key?1:e.key<t.key?-1:0})),this._clusters=[];var t,s=Object(f.a)(e);try{for(s.s();!(t=s.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(a){s.e(a)}finally{s.f()}for(;this._clusters.length>0&&(this._clusters[0]===$||this._clusters[0]===ee);)this._clusters.shift();return this._clusters}},{key:"handleMouseMove",value:function(e){var t=D(e),s=t.x,r=t.y,a={rd:this._currYScale.invert(r),baf:this._currXScale.invert(s)};if(a.baf>this._currXScale.domain()[0]&&a.baf<this._currXScale.domain()[1]&&a.rd>this._currYScale.domain()[0]&&a.rd<this._currYScale.domain()[1]){var n=Math.abs(this._currXScale.invert(s)-this._currXScale.invert(s-20));this.props.onRecordsHovered(this.quadTree.find(a.baf,a.rd,n)||null)}else this.props.onRecordsHovered(null)}},{key:"renderTooltipAtRdBaf",value:function(e,t,s){if(!s)return null;var r=this._currYScale(e)||0,a=(this._currXScale(t)||0)+10;return Object(K.jsx)("div",{className:"Scatterplot-tooltip",style:{position:"absolute",top:r-150,left:a,width:275,height:150,pointerEvents:"none"},children:s})}},{key:"renderTooltip",value:function(){var e=this.props,t=e.data,s=e.hoveredLocation,r=e.yAxisToPlot;if(!s)return null;var n=[];if(0===(n=t.filter((function(e){var t=O.toChromosomeInterval(e);return s.chr===t.chr&&s.start===t.start&&s.end===t.end}))).length&&(n=t.filter((function(e){return O.toChromosomeInterval(e).hasOverlap(s)}))),n[0]){var i=this._currXScale(n[0].reverseBAF),o=this._currYScale(n[0][r]),l=this._currXScale.range(),c=this._currYScale.range();if(1===n.length&&i&&o&&i>l[0]&&i<l[1]&&o<c[0]&&o>c[1]){var h=n[0],u=O.toChromosomeInterval(h);return this.renderTooltipAtRdBaf(h[r],h.reverseBAF,Object(K.jsxs)(a.a.Fragment,{children:[Object(K.jsxs)("p",{children:[Object(K.jsx)("b",{children:u.toString()}),Object(K.jsx)("br",{}),"(",B(u.getLength()),")"]}),Object(K.jsxs)("div",{children:[" RDR: ",h[r].toFixed(2)]}),Object(K.jsxs)("div",{children:[" 0.5 - BAF: ",h.reverseBAF.toFixed(2)]}),Object(K.jsxs)("div",{children:[" Cluster ID: ",h.CLUSTER]})]}))}}return null}},{key:"render",value:function(){var e=this,t=this.props,s=t.width,r=t.height,a=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));return a.unshift(Object(K.jsx)("option",{value:$,children:$},$)),a.unshift(Object(K.jsx)("option",{value:ee,children:ee},ee)),Object(K.jsxs)("div",{ref:function(t){return e.scatter=t},className:"Scatterplot",style:{width:s,height:r},children:[Object(K.jsx)("canvas",{ref:function(t){return e._canvas=t},width:s,height:r,className:"canvas",style:{position:"absolute",top:V,zIndex:-4,left:Q,width:s-Q-Z,height:r-V-J}}),Object(K.jsx)("svg",{ref:function(t){return e._svg=t},style:{zIndex:100},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+s+" "+r,onMouseMove:this.handleMouseMove}),Object(K.jsx)("div",{className:"Scatterplot-tools",children:Object(K.jsx)("button",{className:"custom-button",onClick:this.resetZoom,children:"Reset View"})}),this.renderTooltip()]})}},{key:"resetZoom",value:function(){if(this._svg){this._currXScale=this._original_XScale,this._currYScale=this._original_YScale;var e={xScale:this._currXScale.domain(),yScale:this._currYScale.domain()};this.props.onZoom(e),this.redraw()}}},{key:"componentDidMount",value:function(){this.redraw(),this.forceHover(this.props.hoveredLocation)}},{key:"propsDidChange",value:function(e,t){var s=this;return t.some((function(t){return s.props[t]!==e[t]}))}},{key:"componentDidUpdate",value:function(e){var t=this;if(!this.props.scales.xScale&&!this.props.scales.yScale&&e.scales.xScale&&e.scales.yScale)this.resetZoom();else if(this.props.scales.xScale&&e.scales.xScale&&this.props.scales.xScale[0]!==e.scales.xScale[0]&&this.props.scales.xScale[1]!==e.scales.xScale[1]||this.props.scales.xScale&&!e.scales.xScale){this._currXScale.domain(this.props.scales.xScale),this.props.scales.yScale&&this._currYScale.domain(this.props.scales.yScale);var s=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(s),this.redraw()}else if(this.props.scales.yScale&&e.scales.yScale&&this.props.scales.yScale[0]!==e.scales.yScale[0]&&this.props.scales.yScale[1]!==e.scales.yScale[1]||this.props.scales.yScale&&!e.scales.yScale){this.props.scales.xScale&&this._currXScale.domain(this.props.scales.xScale),this._currYScale.domain(this.props.scales.yScale);var r=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(r),this.redraw()}else if(this.props.assignCluster)this.onTrigger(this.state.selectedCluster),this.brushedNodes=new Set;else if(this.props.hoveredLocation!==e.hoveredLocation)this.forceUnhover(),this.forceHover(this.props.hoveredLocation);else if(this.propsDidChange(e,["showCentroids","displayMode","colors","brushedBins","width","height"])){var a=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(a),this.redraw(),this.forceHover(this.props.hoveredLocation)}else if(!y.a.isEqual(this.props.data,e.data)||this.props.yAxisToPlot!==e.yAxisToPlot){var n=this.computeScales(this.props.rdRange,this.props.width,this.props.height),i=n.bafScale,o=n.rdrScale;if(this._currXScale.domain()[0]===this._original_XScale.domain()[0]&&this._currXScale.domain()[1]===this._original_XScale.domain()[1]&&this._currYScale.domain()[0]===this._original_YScale.domain()[0]&&this._currYScale.domain()[1]===this._original_YScale.domain()[1])this._currXScale=i,this._currYScale=o,this._original_XScale=this._currXScale,this._original_YScale=this._currYScale;else{if(this.props.yAxisToPlot!==e.yAxisToPlot){var l=this._currYScale.domain();if("logRD"===this.props.yAxisToPlot){l[0]<=0&&(l[0]=.1),l[1]<=0&&(l[1]=.1);var c=[Math.log2(l[0]),Math.log2(l[1])];this._currYScale=w.i().domain(c).range(this._currYScale.range())}else{var h=[Math.pow(2,l[0]),Math.pow(2,l[1])];this._currYScale=w.i().domain(h).range(this._currYScale.range())}}this._original_XScale=i,this._original_YScale=o}var u=this.props.data;this.quadTree=w.g().x((function(e){return e.reverseBAF})).y((function(e){return e[t.props.yAxisToPlot]})).addAll(u);var d={xScale:this._currXScale.domain(),yScale:this._currYScale.domain()};this.props.onZoom(d),this.redraw(),this.forceHover(this.props.hoveredLocation)}this.props.clusterTableData!==e.clusterTableData&&this.initializeListOfClusters()}},{key:"computeScales",value:function(e,t,s,r,a){var n=[Q,t-Z],i=[s-J,V],o=a?e[0]:this.props.applyLog?-2:0,l=r||[-1e-4,.5001];return{bafScale:w.i().domain(l).range(n),rdrScale:w.i().domain([o,e[1]]).range(i)}}},{key:"onZoom",value:function(e){this.props.onZoom(e)}},{key:"redraw",value:function(){var e=this;if(this._svg&&this._canvas&&this.scatter){var t=this,s=this.props,r=s.width,a=s.height,n=s.customColor,i=s.brushedBins,o=s.data,c=s.colors,h=s.yAxisToPlot,u=s.centroidPts,d=this.props.displayMode,p=this._currXScale,v=this._currYScale,g="RD"===h?"RDR":"log RDR",b=w.j(this._svg);b.selectAll(".scatterplot-scale").remove(),b.append("text").classed(te,!0).attr("text-anchor","middle").attr("x",y.a.mean(this._currXScale.range())).attr("y",a-J+40).style("text-anchor","middle").text("Allelic Imbalance (0.5 - BAF)"),b.append("text").classed(te,!0).attr("y",Q-40).attr("x",0-y.a.mean(this._currYScale.range())).attr("transform","rotate(-90)").style("text-anchor","middle").text(g);var m=function(e,t){return e.classed(te,!0).attr("transform","translate(0, ".concat(a-J,")")).call(w.a(t))},S=function(e,t){return e.classed(te,!0).attr("transform","translate(".concat(Q,", 0)")).call(w.b(t))},C=[];i.forEach((function(e){return C.push(O.toChromosomeInterval(e).toString())})),this.previous_brushed_nodes=new Set(C);var j=this.previous_brushed_nodes,A=b.append("g"),x=b.append("g"),_=w.o,k=w.n().scaleExtent([0,100]),D=w.n().scaleExtent([0,100]),B=function(){return w.p(A.node())},L=function(){return w.p(x.node())};A.call(k).attr("pointer-events","none"),x.call(D).attr("pointer-events","none");var T=w.n().on("zoom",(function(){try{var e=w.f.transform,t=e.k/_.k,s=function(e){if(e.sourceEvent)return[e.sourceEvent.layerX,e.sourceEvent.layerY];return[r/2,a/2]}(w.f),n=s[0]>p.range()[0],i=s[1]<v.range()[0];d!==at.zoom&&n&&i||(1===t?(n&&k&&t&&s&&A&&A.call(k.translateBy,(e.x-_.x)/B().k,0),i&&D&&t&&s&&x&&x.call(D.translateBy,0,(e.y-_.y)/L().k)):(n&&k&&t&&s&&A&&A.call(k.scaleBy,t,s),i&&D&&t&&s&&x&&x.call(D.scaleBy,t,s))),_=e,$()}catch(o){console.log("Error: ",o)}})).on("end",(function(){var e={xScale:t._currXScale.domain(),yScale:t._currYScale.domain()};t.props.onZoom(e)})),E=this._canvas.getContext("webgl");E.clearColor(0,0,0,1);var P,M=[],N=Object(f.a)(o);try{for(N.s();!(P=N.n()).done;){var F=P.value;j.has(O.toChromosomeInterval(F).toString())||M.push(F)}}catch(ee){N.e(ee)}finally{N.f()}var I,U=Object(f.a)(o);try{for(U.s();!(I=U.n()).done;){var Y=I.value;j.has(O.toChromosomeInterval(Y).toString())&&M.push(Y)}}catch(ee){U.e(ee)}finally{U.f()}var G=X.webglFillColor().value((function(e){return R(function(e){if(j.has(O.toChromosomeInterval(e).toString()))return n;if(-1===e.CLUSTER)return W;if(-2===e.CLUSTER)return q;var t=e.CLUSTER%c.length;return c[t]}(e))})).data(M),H=X.seriesWebglPoint().xScale(t._currXScale).yScale(t._currYScale).size(3).crossValue((function(e){return e.reverseBAF})).mainValue((function(e){return e[h]})).context(E);if(H.decorate((function(e){G(e),E.depthFunc(E.NEVER),E.disable(E.DEPTH_TEST)})),b.append("clipPath").attr("id","clip").append("rect").attr("x",Q).attr("y",V).attr("width",r-Z-Q).attr("height",a-J-V),b.append("g").classed("eventrect",!0).append("rect").attr("x",Q).attr("y",V).attr("width",r-Z-Q).attr("height",a-J-V).style("fill","none").style("pointer-events","all").attr("clip-path","url(#clip)"),this._canvas.width=r,this._canvas.height=a,$(),d===at.select||d===at.erase){var z=w.c().keyModifiers(!1).extent([[Q-2,V-2],[this.props.width-Z+2,this.props.height-J+2]]).on("end",(function(){e.updatePoints(w.f),b.selectAll(".brush").remove(),e.onBrushedBinsUpdated(Object(l.a)(e.brushedNodes))}));b.append("g").attr("class","brush").call(z)}else if(d===at.zoom)b.selectAll(".brush").remove();else if(d===at.boxzoom){var K=w.c().keyModifiers(!1).extent([[Q-2,V-2],[this.props.width-Z+2,this.props.height-J+2]]).on("start brush",(function(){return e.updatePoints(w.f)})).on("end",(function(){b.selectAll(".brush").remove(),function(){if(!t._svg)return;if(t.props.data){var e=w.f.selection;if(e){var s=[Number(t._currYScale.invert(e[1][1])),Number(t._currYScale.invert(e[0][1]))],n=[Number(t._currXScale.invert(e[0][0])),Number(t._currXScale.invert(e[1][0]))],i=t.computeScales(s,r,a,n,!0),o=i.bafScale,l=i.rdrScale;t._currXScale=o,t._currYScale=l,t.redraw();var c={xScale:t._currXScale.domain(),yScale:t._currYScale.domain()};t.props.onZoom(c)}}}()}));b.append("g").attr("class","brush").call(K)}b.call(T).call(T.transform,w.o.scale(1))}function $(){E.clear(E.COLOR_BUFFER_BIT),E.clearColor(255,255,255,1);var e=B().rescaleX(p),s=L().rescaleY(v);A.call(m,e),x.call(S,s),t._currXScale=e,t._currYScale=s,t._canvas&&(H.xScale(t._currXScale).yScale(t._currYScale),H(M)),b.select(".Centroids").remove(),t.props.showCentroids&&b.select(".eventrect").append("g").attr("clip-path","url(#clip)").classed("Centroids",!0).selectAll("path").data(u).enter().append("path").attr("class","point").attr("d",w.k().type(w.m)).attr("fill",(function(e){return function(e){if(-1===e)return W;if(-2===e)return q;var t=e%c.length;return c[t]}(e.cluster)})).attr("fill-opacity",1).attr("stroke-width",2).attr("stroke","black").attr("transform",(function(e){return"translate("+t._currXScale(e.point[0])+","+t._currYScale(e.point[1])+")"}))}}},{key:"updatePoints",value:function(e){var t=this;if(this._svg){var s=this.props,r=s.brushedBins,a=s.data,n=s.yAxisToPlot,i=s.displayMode;if(a){var o=w.f.selection;if(o){var l=a.filter((function(e){return s=o,r=[t._currXScale(e.reverseBAF),t._currYScale(e[n])],s[0][0]<=r[0]&&r[0]<=s[1][0]&&s[0][1]<=r[1]&&r[1]<=s[1][1];var s,r}));l&&(i===at.select?l=y.a.uniqBy(y.a.union(l,r),(function(e){return e["#CHR"]+"_"+e.START})):i===at.erase&&(l=y.a.difference(r,l)),this.brushedNodes=new Set(l))}else this.brushedNodes=new Set([])}}}},{key:"getElementsForGenomeLocation",value:function(e){var t=this;if(!this._svg||!e||!this._canvas)return[];var s=this.props,r=s.data,a=s.yAxisToPlot,n=[];n=r.filter((function(t){var s=O.toChromosomeInterval(t);return e.chr===s.chr&&e.start===s.start&&e.end===s.end}));var i=this._currXScale.range(),o=this._currYScale.range();0===n.length&&(n=(n=r.filter((function(t){return O.toChromosomeInterval(t).hasOverlap(e)}))).filter((function(e){var s=t._currXScale(e.reverseBAF),r=t._currYScale(e[a]);return s&&r&&s>i[0]&&s<i[1]&&r<o[0]&&r>o[1]})));var l=w.j(this._svg);l.select(".circles").remove(),l.select(".eventrect").append("g").classed(se,!0).selectAll("circle").data(n).enter().append("circle").attr("id",(function(e){return t._circleIdPrefix+O.toChromosomeInterval(e).toString()})).attr("cx",(function(e){return t._currXScale(e.reverseBAF)||0})).attr("cy",(function(e){return t._currYScale(e[a])||0})).attr("r",3).attr("fill",(function(e){if(t.previous_brushed_nodes.has(O.toChromosomeInterval(e).toString()))return t.props.customColor;if(-1===e.CLUSTER)return W;if(-2===e.CLUSTER)return q;var s=e.CLUSTER%t.props.colors.length;return t.props.colors[s]})).attr("fill-opacity",1).attr("stroke-width",2).attr("stroke","black")}},{key:"forceHover",value:function(e){this.getElementsForGenomeLocation(e)}},{key:"forceUnhover",value:function(){this._svg&&w.j(this._svg).select(".circles").remove()}}]),s}(a.a.Component);ae.defaultProps={width:400,height:302,onNewCurveState:y.a.noop,onRecordHovered:y.a.noop};var ne=s(208),ie=(s(246),["onMouseMove","onMouseLeave","style","children"]),oe=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).state={mouseCoordinates:null},r.storeMouseCoordinates=r.storeMouseCoordinates.bind(Object(d.a)(r)),r.clearMouseCoordinates=r.clearMouseCoordinates.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"storeMouseCoordinates",value:function(e){this.setState({mouseCoordinates:D(e)}),this.props.onMouseMove&&this.props.onMouseMove(e)}},{key:"clearMouseCoordinates",value:function(e){this.setState({mouseCoordinates:null}),this.props.onMouseLeave&&this.props.onMouseLeave(e)}},{key:"render",value:function(){var e=this.props,t=(e.onMouseMove,e.onMouseLeave,e.style),s=e.children,r=Object(ne.a)(e,ie),a=Object.assign({position:"relative"},t);return Object(K.jsxs)("div",Object(o.a)(Object(o.a)({onMouseMove:this.storeMouseCoordinates,onMouseLeave:this.clearMouseCoordinates,style:a},r),{},{children:[s,this.state.mouseCoordinates&&Object(K.jsx)(le,{where:this.state.mouseCoordinates})]}))}}]),s}(a.a.Component);function le(e){var t=e.where,s=t.x,r={top:t.y-1,willChange:"top"},n={left:s-1,willChange:"left"};return Object(K.jsxs)(a.a.Fragment,{children:[Object(K.jsx)("div",{className:"Bullseye-horizontal-line",style:r}),Object(K.jsx)("div",{className:"Bullseye-vertical-line",style:n})]})}s(112);var ce=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).handleCallBack=function(e){r.props.parentCallBack(e)},r.state={selectedSample:e.initialSelectedSample},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleRecordsHovered=r.handleRecordsHovered.bind(Object(d.a)(r)),r.handleCallBack=r.handleCallBack.bind(Object(d.a)(r)),r.handleUpdatedBrushedBins=r.handleUpdatedBrushedBins.bind(Object(d.a)(r)),r.onRemovePlot=r.onRemovePlot.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e.target.value}),this.props.onSelectedSample(e.target.value)}},{key:"handleRecordsHovered",value:function(e){var t=e?O.toChromosomeInterval(e):null;this.props.onLocationHovered(t)}},{key:"handleUpdatedBrushedBins",value:function(e){this.props.onBrushedBinsUpdated(e)}},{key:"onRemovePlot",value:function(){this.props.onRemovePlot(this.props.plotId)}},{key:"render",value:function(){var e=this.props,t=e.data,s=e.width,r=e.height,a=e.hoveredLocation,n=e.invertAxis,i=e.customColor,o=e.assignCluster,l=e.brushedBins,c=e.updatedBins,h=e.dispMode,u=e.onZoom,d=e.rdRange,p=e.clusterTableData,v=e.applyLog,f=e.scales,g=e.centroidPts,b=e.showCentroids;return Object(K.jsx)("div",{className:"SampleViz-scatter",children:Object(K.jsx)(oe,{className:"SampleViz-pane",children:Object(K.jsx)(ae,{parentCallBack:this.handleCallBack,data:t,rdRange:d,width:s,height:r,hoveredLocation:a,onRecordsHovered:this.handleRecordsHovered,invertAxis:n||!1,customColor:i,colors:this.props.colors,col:this.props.colors[0],assignCluster:o,onBrushedBinsUpdated:this.handleUpdatedBrushedBins,brushedBins:l,updatedBins:c,displayMode:h,onZoom:u,clusterTableData:p,applyLog:v,yAxisToPlot:v?"logRD":"RD",onClusterSelected:this.props.onClusterSelected,scales:f,centroidPts:g,showCentroids:b})})})}}]),s}(a.a.Component);ce.defaultProps={onLocationHovered:y.a.noop,invertAxis:!1,customColor:"#1b9e77"};s(247);var he="linearplot-scale",ue="#999999",de="rgba(232, 232, 232, 1)",pe=50,ve=10,fe=10,ge=35;var be=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e))._svg=void 0,r._canvas=void 0,r._clusters=void 0,r.brushedNodes=void 0,r._currXScale=void 0,r._currYScale=void 0,r._original_XScale=void 0,r._original_YScale=void 0,r.previewDriver=void 0,r.lockedDrivers=void 0,r._svg=null,r._canvas=null,r.getXScale=Object(k.a)(r.getXScale),r.handleMouseMove=r.handleMouseMove.bind(Object(d.a)(r)),r.handleMouseLeave=r.handleMouseLeave.bind(Object(d.a)(r)),r._clusters=r.initializeListOfClusters(),r.brushedNodes=new Set,r._currXScale=r.getXScale(e.width,e.genome,e.chr,r.props.implicitStart,r.props.implicitEnd),r._currYScale=w.i().domain([r.props.yMin,r.props.yMax]).range([r.props.height-ge,fe]),r._original_XScale=r._currXScale,r._original_YScale=r._currYScale,r.previewDriver=null,r.lockedDrivers=new Set,r}return Object(u.a)(s,[{key:"initializeListOfClusters",value:function(){var e=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),t=Object(l.a)(new Set(this.props.data.map((function(e){return String(e.CLUSTER)})))).sort(e.compare);return"-2"===t[0]&&t.shift(),"-1"===t[0]&&t.shift(),t}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"propsDidChange",value:function(e,t){var s=this;return t.some((function(t){return s.props[t]!==e[t]}))}},{key:"componentDidUpdate",value:function(e){null!==this.props.driverGeneUpdate.gene&&this.props.driverGeneUpdate.destination===this.props.dataKeyToPlot&&(this.lockedDrivers.has(this.props.driverGeneUpdate.gene)?this.lockedDrivers.delete(this.props.driverGeneUpdate.gene):this.lockedDrivers.add(this.props.driverGeneUpdate.gene),this.props.handleDriverGenesChange({gene:null,destination:null})),this.propsDidChange(e,["chr"])?"RD"===this.props.dataKeyToPlot||"logRD"===this.props.dataKeyToPlot?this.props.onLinearPlotZoom(null,null,!0):this.props.onLinearPlotZoom(null,null,!1):this.propsDidChange(e,["driverGenes","displayMode","implicitEnd","implicitStart","yMin","yMax","colors","brushedBins","width","height","chr"])?(0===this.props.brushedBins.length&&(this._clusters=this.initializeListOfClusters()),this.redraw()):y.a.isEqual(this.props.data,e.data)&&this.props.dataKeyToPlot===e.dataKeyToPlot||this.redraw()}},{key:"getXScale",value:function(e,t,s,r,a){var n=[0,0];return null!=r&&null!=a?(n[0]=r,n[1]=a):s?(n[0]=t.getChrStartMap()[s],n[1]=n[0]+t.getLength(s)):n[1]=t.getLength(),w.i().domain(n).range([pe,e-ve])}},{key:"createNewBrush",value:function(){var e=w.j(this._svg),t=w.c().keyModifiers(!0).extent([[pe,fe],[this.props.width-ve,this.props.height-ge]]).on("end",(function(){e.selectAll(".brush").remove()}));e.append("g").attr("class","brush").call(t)}},{key:"redraw",value:function(){var e=this;if(this._svg){var t,s=this,r=this.props,a=r.data,n=r.width,i=r.height,o=r.genome,c=r.chr,h=r.dataKeyToPlot,u=r.yMin,d=r.yMax,p=r.yLabel,v=r.customColor,g=r.brushedBins,b=r.colors,m=r.displayMode,S=r.driverGenes,C=this.getXScale(n,o,c,this.props.implicitStart,this.props.implicitEnd),j=w.i().domain([u,d]).range([i-ge,fe]),A=o.getChromosomeList(),x=[],_=o.getChrStartMap(),k=Object(f.a)(A);try{for(k.s();!(t=k.n()).done;){var D=t.value,L=_[D.name];L>=C.domain()[0]&&L<=C.domain()[1]&&x.push(D)}}catch(te){k.e(te)}finally{k.f()}var T=w.j(this._svg);T.selectAll(".linearplot-scale").remove(),T.append("text").classed(he,!0).attr("text-anchor","middle").attr("font-size",11).attr("x",y.a.mean(C.range())).attr("y",i-ge+30).text(c||o.getName()),T.append("text").classed(he,!0).attr("transform","rotate(-90, ".concat(pe,", ").concat(y.a.mean(j.range()),")")).text(p||h).attr("x",(i-ge-fe)/2-1).attr("y",pe/2+5).attr("text-anchor","middle");var E=function(e,t){return e.classed(he,!0).attr("transform","translate(0, ".concat(i-ge,")")).call(w.a(t).tickValues(o.getChromosomeStarts2(x,t.domain()[0],t.domain()[1])).tickFormat((function(e,t){return function(e){var t=e.match(/\d+/);return t?t[0]:e}(x[t].name)})))},P=function(e,t){return e.classed(he,!0).attr("transform","translate(0, ".concat(i-ge,")")).call(w.a(t).tickFormat((function(e){return B(Number(e.valueOf()),0,_[c])})))},M=function(e,t){return e.classed(he,!0).attr("transform","translate(".concat(pe,", 0)")).call(w.b(t).ticks((t.range()[0]-t.range()[1])/15))},N=T.append("g"),F=T.append("g"),I=w.o,U=w.n().scaleExtent([0,100]),Y=w.n().scaleExtent([0,100]),G=function(){return w.p(N.node())},H=function(){return w.p(F.node())};N.call(U).attr("pointer-events","none"),F.call(Y).attr("pointer-events","none");var z=w.n().on("zoom",(function(){try{var e=w.f.transform,t=e.k/I.k,s=function(e){if(e.sourceEvent)return[e.sourceEvent.layerX,e.sourceEvent.layerY];return[n/2,i/2]}(w.f),r=s[0]>C.range()[0],a=s[1]<j.range()[0];m!==at.zoom&&r&&a||(1===t?(r&&U&&t&&s&&N&&N.call(U.translateBy,(e.x-I.x)/G().k,0),a&&Y&&t&&s&&F&&F.call(Y.translateBy,0,(e.y-I.y)/H().k)):(r&&U&&t&&s&&N&&N.call(U.scaleBy,t,s),a&&Y&&t&&s&&F&&F.call(Y.scaleBy,t,s))),I=e,ee()}catch(o){console.log("Error: ",o)}})).on("end",(function(){"RD"===e.props.dataKeyToPlot||"logRD"===e.props.dataKeyToPlot?s.props.onLinearPlotZoom([s._currXScale.domain()[0],s._currXScale.domain()[1]],[s._currYScale.domain()[0],s._currYScale.domain()[1]],!0):s.props.onLinearPlotZoom([s._currXScale.domain()[0],s._currXScale.domain()[1]],[s._currYScale.domain()[0],s._currYScale.domain()[1]],!1)}));if(this._canvas){this._canvas.width=800,this._canvas.height=150;var K=[];g.forEach((function(e){return K.push(O.toChromosomeInterval(e).toString())}));var Q=new Set(K),Z=this._canvas.getContext("webgl");Z.clearColor(0,0,0,1);var V=X.webglFillColor().value((function(e){return R(function(e){if(Q.has(O.toChromosomeInterval(e).toString()))return v;if(-1===e.CLUSTER)return ue;if(-2===e.CLUSTER)return de;var t=e.CLUSTER%b.length;return b[t]}(e))})).data(this.props.data),J=X.seriesWebglPoint().size(3).crossValue((function(e){return o.getImplicitCoordinates(O.toChromosomeInterval(e)).getCenter()})).mainValue((function(e){return e[h]})).context(Z);J.decorate((function(e){return V(e)})),T.append("clipPath").attr("id","clip2").append("rect").attr("x",pe).attr("y",fe).attr("width",n).attr("height",i).attr("fill","red"),T.append("g").classed("eventrect",!0).append("rect").attr("x",pe).attr("y",fe).attr("width",n-ve-pe).attr("height",i-ge-fe).style("fill","none").style("pointer-events","all").attr("clip-path","url(#clip2)");var W=function(e){s.previewDriver=e},q=function(e){s.previewDriver=null};ee();var $=null;m===at.select||m===at.erase?($=w.c().keyModifiers(!1).extent([[pe,fe],[this.props.width,this.props.height-ge]]).on("start brush",(function(){var t=w.f.selection;if(t&&t[0][0]!==t[1][0]&&t[0][1]!==t[1][1]){var s=a.filter((function(e){var s,r,a=O.toChromosomeInterval(e),n=o.getImplicitCoordinates(a);return s=t,r=[C(n.getCenter()),j(e[h])],s[0][0]<=r[0]&&r[0]<=s[1][0]&&s[0][1]<=r[1]&&r[1]<=s[1][1]}));s&&(m===at.select?s=y.a.uniqBy(y.a.union(s,g),(function(e){return e["#CHR"]+"_"+e.START})):m===at.erase&&(s=y.a.difference(g,s)),e.brushedNodes=new Set(s))}else e.brushedNodes=new Set([])})).on("end",(function(){T.selectAll(".brush").remove(),e.props.onBrushedBinsUpdated(Object(l.a)(e.brushedNodes))})),T.append("g").attr("class","brush").call($)):m!==at.boxzoom&&m!==at.zoom||($=w.d().extent([[pe,fe],[this.props.width,this.props.height-ge]]).on("end",(function(){T.selectAll(".brush").remove();var t=w.f.selection;try{var r={start:t[0],end:t[1]},a=C.invert(r.start),n=C.invert(r.end);"RD"===e.props.dataKeyToPlot||"logRD"===e.props.dataKeyToPlot?e.props.onLinearPlotZoom([a,n],[s._currYScale.domain()[0],s._currYScale.domain()[1]],!0):e.props.onLinearPlotZoom([a,n],[s._currYScale.domain()[0],s._currYScale.domain()[1]],!1)}catch(i){}})),T.append("g").attr("class","brush").call($)),T.call(z).call(z.transform,w.o.scale(1))}}function ee(){Z.clear(Z.COLOR_BUFFER_BIT),Z.clearColor(255,255,255,1);var e=H().rescaleY(j);if(F.call(M,e),s._currYScale=e,c){var t=G().rescaleX(C);N.call(P,t),s._currXScale=t,J.xScale(t).yScale(e)}else{var r=G().rescaleX(C);N.call(E,r),s._currXScale=r,J.xScale(r).yScale(e)}J(a),S&&(T.select(".Drivers").remove(),T.select(".eventrect").append("g").attr("clip-path","url(#clip2)").classed("Drivers",!0).selectAll("circle").data(S).enter().append("circle").attr("class","point").attr("d",w.k().type(w.l)).attr("fill","red").attr("fill-opacity",1).attr("stroke-width",2).attr("r",2).attr("transform",(function(t){return"translate("+s._currXScale(o.getImplicitCoordinates(t.location).getCenter())+","+((s._currYScale(e.domain()[0])||0)+3)+")"})).on("mouseover",W).on("mouseleave",q).on("click",(function(e){var t="";t="reverseBAF"===h&&s.props.applyLog?"logRD":"reverseBAF"===h?"RD":"reverseBAF",s.lockedDrivers.has(e)?s.lockedDrivers.delete(e):s.lockedDrivers.add(e),s.props.handleDriverGenesChange({gene:e,destination:t})})))}}},{key:"renderHighlight",value:function(){var e=this.props,t=e.width,s=e.genome,r=e.chr,a=e.hoveredLocation;if(!a)return null;if(null!=this.previewDriver)return null;var n=this.getXScale(t,s,r,this.props.implicitStart,this.props.implicitEnd),i=s.getImplicitCoordinates(a),o=n(i.start),l=Math.ceil((n(i.end)||0)-(o||0));return Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:o,width:l,height:"100%",backgroundColor:"rgba(0,0,0,1)",border:"1px solid rgba(0,0,0,1)",zIndex:1}})}},{key:"handleMouseMove",value:function(e){var t=this.props,s=t.width,r=t.genome,a=t.chr,n=t.onLocationHovered,i=this.getXScale(s,r,a,this.props.implicitStart,this.props.implicitEnd),o=i.range(),l=D(e).x;if(l<o[0]||l>o[1])this.handleMouseLeave();else{var c=i.invert(l);n(r.getChromosomeLocation(c))}}},{key:"handleMouseLeave",value:function(){this.props.onLocationHovered(null)}},{key:"render",value:function(){var e=this,t=this.props,s=t.width,r=t.height,a=t.dataKeyToPlot;return Object(K.jsxs)("div",{className:"LinearPlot",style:{position:"relative",width:s,height:r},onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,children:[this.renderLockedDrivers(),this.renderTooltip(),this.renderHighlight(),Object(K.jsx)("canvas",{ref:function(t){return e._canvas=t},width:s,height:r,className:"canvas",style:{position:"absolute",top:fe,zIndex:-1,left:pe,width:s-pe-ve,height:r-fe-ge}}),Object(K.jsx)("svg",{ref:function(t){return e._svg=t},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+s+" "+r}),Object(K.jsx)("div",{className:"LinearPlot-tools",children:("RD"===a||"logRD"===a)&&Object(K.jsx)("button",{className:"custom-button linear-plot-button",onClick:function(){e.props.onLinearPlotZoom(null,null,!0,!0)},children:"Reset View"})})]})}},{key:"renderLockedDrivers",value:function(){var e=this,t=this.props,s=t.width,r=t.genome,n=t.chr,i=t.height,o=!1;null!=this.previewDriver&&this.lockedDrivers.has(this.previewDriver)&&(this.lockedDrivers.delete(this.previewDriver),o=!0);var c=Object(l.a)(this.lockedDrivers).sort((function(e,t){return e.location.start-t.location.start}));null!=this.previewDriver&&o&&this.lockedDrivers.add(this.previewDriver);var h=[];return c.map((function(t,o){var l,c=e.getXScale(s,r,n,e.props.implicitStart,e.props.implicitEnd),u=r.getImplicitCoordinates(t.location),d=c(u.start)||0,p=Math.ceil((c(u.end)||0)-(d||0)),v=t.symbol,g=Object(K.jsx)(a.a.Fragment,{children:Object(K.jsxs)("div",{children:[" ",v," "]})}),b=!0,m=v.length>4?40+5*(v.length-4):40,S=[d-m/2,d+m/2],C=Object(f.a)(h);try{for(C.s();!(l=C.n()).done;){var y=l.value;if(y[0]>S[0]&&y[0]<S[1]){b=!1;break}if(S[0]>y[0]&&S[0]<y[1]){b=!1;break}}}catch(j){C.e(j)}finally{C.f()}return b&&h.push(S),d>pe&&d<s-ve?Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{style:{position:"absolute",left:d-m/2,width:m,bottom:i,border:"1px solid rgba(0,0,0,0)",zIndex:o,pointerEvents:"none",display:b?"":"none"},children:g}),Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:d,width:p,height:"75%",backgroundColor:"rgba(255,165,0,1)",border:"1px solid rgba(255,165,0,1)",zIndex:o}})]},e.props.dataKeyToPlot+v):null}))}},{key:"renderTooltip",value:function(){var e=this.props,t=e.driverGenes,s=e.hoveredLocation,r=e.width,n=e.genome,i=e.chr,o=e.height;if(!s)return null;if(!t)return null;if(!this.previewDriver)return null;var l=this.getXScale(r,n,i,this.props.implicitStart,this.props.implicitEnd),c=n.getImplicitCoordinates(this.previewDriver.location),h=l(c.start)||0,u=Math.ceil((l(c.end)||0)-(h||0)),d=this.previewDriver.symbol,p=Object(K.jsx)(a.a.Fragment,{children:Object(K.jsxs)("div",{children:[" ",d," "]})}),v=d.length>4?40+5*(d.length-4):40;return Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{style:{position:"absolute",left:h-v/2,bottom:o+1,backgroundColor:"white",border:"1px solid rgba(0,0,0,0)",zIndex:2},children:p}),Object(K.jsx)("div",{className:"highlight",style:{position:"absolute",left:h,width:u+1,height:"75%",backgroundColor:this.lockedDrivers.has(this.previewDriver)?"red":"rgba(0, 200 , 0, 1)",zIndex:0}})]})}}]),s}(a.a.PureComponent);function me(e){var t=e.data,s=e.chr,r=e.rdRange,a=e.hoveredLocation,n=e.onLocationHovered,i=e.onBrushedBinsUpdated,o=e.brushedBins,l=e.customColor,c=e.colors,h=e.yScale,u=e.clusterTableData,d=e.applyLog,p=e.displayMode,v=e.width,f=e.onLinearPlotZoom,g=e.implicitStart,b=e.implicitEnd,m=e.onZoom,S=e.driverGenes;return Object(K.jsx)(be,{data:t,dataKeyToPlot:d?"logRD":"RD",applyLog:d,genome:st,chr:s,hoveredLocation:a,onLocationHovered:n,onBrushedBinsUpdated:i,yMin:h?h[0]:d?-2:0,yMax:h?h[1]:r[1],yLabel:d?"log RDR":"RDR",brushedBins:o,customColor:l,colors:c,clusterTableData:u,displayMode:p,width:v,onZoom:m,onLinearPlotZoom:f,implicitStart:g,implicitEnd:b,driverGenes:S,driverGeneUpdate:e.driverGeneUpdate,handleDriverGenesChange:e.handleDriverGenesChange})}function Se(e){var t=e.data,s=e.chr,r=e.hoveredLocation,a=e.onLocationHovered,n=e.onBrushedBinsUpdated,i=e.brushedBins,o=e.customColor,l=e.colors,c=e.xScale,h=e.clusterTableData,u=e.displayMode,d=e.width,p=e.onLinearPlotZoom,v=e.implicitStart,f=e.implicitEnd,g=e.onZoom,b=e.driverGenes,m=e.applyLog;return Object(K.jsx)(be,{data:t,chr:s,dataKeyToPlot:"reverseBAF",applyLog:m,genome:st,hoveredLocation:r,onLocationHovered:a,onBrushedBinsUpdated:n,yMin:c?c[0]:0,yMax:c?c[1]:.5,yLabel:"0.5 - BAF",brushedBins:i,customColor:o,colors:l,clusterTableData:h,displayMode:u,width:d,onLinearPlotZoom:p,implicitStart:v,implicitEnd:f,onZoom:g,driverGenes:b,driverGeneUpdate:e.driverGeneUpdate,handleDriverGenesChange:e.handleDriverGenesChange})}be.defaultProps={width:600,height:150,onLocationHovered:y.a.noop};var Ce=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).state={selectedSample:e.initialSelectedSample,sentDriver:{gene:null,destination:null}},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleDriverGenesChange=r.handleDriverGenesChange.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e.target.value})}},{key:"handleDriverGenesChange",value:function(e){this.setState({sentDriver:e})}},{key:"render",value:function(){var e,t=this.props,s=t.data,r=t.chr,a=t.hoveredLocation,n=t.onLocationHovered,i=t.onBrushedBinsUpdated,o=t.brushedBins,l=t.customColor,c=t.yScale,h=t.xScale,u=t.rdRange,d=t.clusterTableData,p=t.applyLog,v=t.displayMode,f=t.width,g=t.onLinearPlotZoom,b=t.implicitRange,m=t.onZoom,S=t.driverGenes;return e=Object(K.jsxs)(oe,{className:"SampleViz-pane",children:[Object(K.jsx)(me,{data:s,chr:r,rdRange:u,hoveredLocation:a,onLocationHovered:n,onBrushedBinsUpdated:i,brushedBins:o,customColor:l,colors:this.props.colors,yScale:c,xScale:h,clusterTableData:d,applyLog:p,displayMode:v,width:f,onLinearPlotZoom:g,implicitStart:b?b[0]:b,implicitEnd:b?b[1]:b,onZoom:m,driverGenes:S,handleDriverGenesChange:this.handleDriverGenesChange,driverGeneUpdate:this.state.sentDriver}),Object(K.jsx)("div",{className:"SampleViz-separator"}),Object(K.jsx)(Se,{data:s,chr:r,hoveredLocation:a,onLocationHovered:n,onBrushedBinsUpdated:i,brushedBins:o,customColor:l,colors:this.props.colors,yScale:c,xScale:h,clusterTableData:d,applyLog:p,displayMode:v,width:f,onLinearPlotZoom:g,onZoom:m,implicitStart:b?b[0]:b,implicitEnd:b?b[1]:b,driverGenes:S,handleDriverGenesChange:this.handleDriverGenesChange,driverGeneUpdate:this.state.sentDriver})]}),Object(K.jsx)("div",{className:"SampleViz-linear",children:e})}}]),s}(a.a.Component),ye=s(62),je=s.n(ye),Ae=s(207),xe=(s(192),function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).table_data=void 0,r.table_data=e.data,r.handleColorChange=r.handleColorChange.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"shouldComponentUpdate",value:function(e){return this.props.data!==e.data||this.props.colors!==e.colors}},{key:"handleColorChange",value:function(e,t){this.props.colors[t]=e.hex;var s=y.a.cloneDeep(this.props.colors);this.props.onClusterColorChange(s),this.forceUpdate()}},{key:"componentDidUpdate",value:function(e){this.props.updatedClusterTable&&this.props.updatedClusterTable()}},{key:"render",value:function(){var e=this,t=this.props,s=t.colOneName,r=t.colTwoName,a=t.colThreeName,n=t.colFourName,i=t.data,o=t.expandable,l=t.selectable,c=t.colors,h=function(t){return Object(K.jsx)("div",{children:Object(K.jsx)(Ae.a,{width:"100%",color:e.props.colors[t.data.key],onChangeComplete:function(s){return e.handleColorChange(s,t.data.key)}})})},u=[{when:function(e){return e},style:function(e){return{backgroundColor:-1===Number(e.key)?"#999999":c[Number(e.key)%c.length],alignItems:"center",justifyContent:"center",innerWidth:50,outerWidth:50}}}],d=[{name:s,selector:"key",sortable:!0,compact:!0,wrap:!0,innerWidth:40,outerWidth:40,width:"50",center:!0},{name:r,selector:"value",sortable:!0,right:!0,compact:!0,wrap:!0,innerWidth:40,outerWidth:40,width:"50",center:!0}],p=[{name:s,selector:"key",sortable:!0,compact:!0,wrap:!0,center:!0},{name:r,selector:"value",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0},{name:a,selector:"selectPerc",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0},{name:n,selector:"binPerc",sortable:!0,right:!0,compact:!0,wrap:!0,center:!0}];if(t.centroidTable){var v=[];if(null!==i&&void 0!==i&&i.length>0){v.push({name:"Cluster ID",type:"key"});for(var f=0,g=Object.keys(i[0].sample);f<g.length;f++){var b=g[f];v.push({name:b,type:"sample."+b})}}for(var m=[],S=0,C=v;S<C.length;S++){var y=C[S],j={name:y.name,selector:y.type,sortable:!0,compact:!0,wrap:!0,center:!0};m.push(j)}return Object(K.jsx)(je.a,{columns:m,data:i,pagination:!0,dense:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0,conditionalRowStyles:u})}return o||l?Object(K.jsx)("div",{className:"scroll",children:Object(K.jsx)(je.a,{columns:d,data:i,selectableRows:!0,onSelectedRowsChange:this.props.onClusterRowsChange,selectableRowSelected:function(t){if(e.props.currentFilters.includes(String(t.key)))return t},expandableRows:!0,expandableRowsComponent:Object(K.jsx)(h,{}),expandableRowDisabled:function(e){return-1===e.key||-2===e.key},pagination:!0,dense:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0,conditionalRowStyles:u})}):Object(K.jsx)(je.a,{columns:p,data:i,pagination:!0,dense:!0,paginationPerPage:3,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[3,5,10,20],noContextMenu:!0,noHeader:!0,noDataComponent:Object(K.jsx)("div",{style:{padding:10},children:"No Records Selected"}),conditionalRowStyles:u})}}]),s}(a.a.Component)),Oe="-1",_e="-2",ke=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e))._clusters=void 0,r._clusters=r.initializeListOfClusters(),r.state={selectedSample:e.initialSelectedSample||e.data.getSampleList()[0],scales:{xScale:null,yScale:null},selectedCluster:r._clusters.length>0?r._clusters[0]:Oe,implicitRange:null},r.handleSelectedSampleChanged=r.handleSelectedSampleChanged.bind(Object(d.a)(r)),r.handleSelectedSampleChange=r.handleSelectedSampleChange.bind(Object(d.a)(r)),r.handleZoom=r.handleZoom.bind(Object(d.a)(r)),r.handleLinearPlotZoom=r.handleLinearPlotZoom.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;this._clusters=[];var t,s=Object(f.a)(e);try{for(s.s();!(t=s.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(a){s.e(a)}finally{s.f()}for(;this._clusters.length>0&&(Number(this._clusters[0])===Number(Oe)||Number(this._clusters[0])===Number(_e));)this._clusters.shift();return this._clusters}},{key:"componentDidUpdate",value:function(e){if(this.props.clusterTableData!==e.clusterTableData)this.initializeListOfClusters();else if(this.props.applyLog!==e.applyLog){var t={xScale:this.state.scales.xScale,yScale:null};this.setState({scales:t})}}},{key:"handleSelectedSampleChanged",value:function(e){this.setState({selectedSample:e})}},{key:"handleSelectedSampleChange",value:function(e){this.setState({selectedSample:e.target.value})}},{key:"handleZoom",value:function(e){var t=this.props,s=t.syncScales,r=t.handleZoom;s?r(e):this.setState({scales:e})}},{key:"handleLinearPlotZoom",value:function(e,t,s,r){if(r){this.setState({implicitRange:null});this.setState({scales:{xScale:null,yScale:null}})}else{this.setState({implicitRange:e});var a=s?{xScale:this.state.scales.xScale,yScale:t}:{xScale:t,yScale:this.state.scales.yScale};this.setState({scales:a})}}},{key:"render",value:function(){var e=this,t=this.props,s=t.data,r=t.initialSelectedSample,a=t.applyLog,n=t.showLinearPlot,i=t.showScatterPlot,l=t.dispMode,c=(t.showSidebar,t.sampleAmount),h=t.syncScales,u=this.state.implicitRange,d=this.state.selectedSample,p=s.getRdRange(d,a),v=s.getSampleList().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)})),f=[],g=h?this.props.scales:this.state.scales;if(null!==u||null!==g.xScale||null!==g.yScale){var b=u?u[0]:null,m=u?u[1]:null;f=s.getRecords(d,a,b,m,g.xScale,g.yScale)}else f=s.getRecords(d,a,null,null,null,null);p[1]+=.5;var S=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));S.unshift(Object(K.jsx)("option",{value:Oe,children:Oe},Oe)),S.unshift(Object(K.jsx)("option",{value:_e,children:_e},_e));var C=0===s.getBrushedBins().length;return Object(K.jsxs)("div",{className:"SampleViz-wrapper",children:[Object(K.jsxs)("div",{style:{verticalAlign:"middle"},children:[(n||i)&&Object(K.jsxs)("div",{className:"SampleViz-select",children:[Object(K.jsx)("span",{children:"Sample: "}),Object(K.jsx)("select",{value:d,onChange:this.handleSelectedSampleChange,children:v}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onAddSample,disabled:c>=v.length,children:" Add Sample "}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onRemovePlot,disabled:c<=1,children:" Remove Sample "})]}),(n||i)&&Object(K.jsxs)("div",{className:"SampleViz-select",children:[Object(K.jsx)("span",{children:"Cluster: "}),Object(K.jsx)("select",{name:"Select Cluster",title:"Cluster",className:"Sampleviz-cluster-select",value:this.state.selectedCluster,disabled:C,onChange:function(t){e.setState({selectedCluster:t.target.value})},children:S}),Object(K.jsx)("button",{className:"custom-button",onClick:function(){e.props.parentCallBack(e.state.selectedCluster),e.props.onBrushedBinsUpdated([])},disabled:C,children:"Assign Cluster"}),Object(K.jsx)("button",{className:"custom-button",onClick:function(){e.initializeListOfClusters();var t=e._clusters;t.sort((function(e,t){return Number(e)-Number(t)}));for(var s=(t.length>0?Number(t[t.length-1]):-1)+1,r=0;r<t.length;r++)if(Number(t[r])!==r){s=r;break}e.props.parentCallBack(s),e.props.onBrushedBinsUpdated([])},disabled:C,children:"New Cluster"}),Object(K.jsx)("button",{className:"custom-button",onClick:this.props.onUndoClick,children:" Undo"})]})]}),Object(K.jsxs)("div",{className:"SampleViz-plots",children:[i&&Object(K.jsx)(ce,Object(o.a)(Object(o.a)({},this.props),{},{data:f,onSelectedSample:this.handleSelectedSampleChanged,selectedSample:d,initialSelectedSample:r,onZoom:this.handleZoom,rdRange:p,implicitRange:this.state.implicitRange,scales:h?this.props.scales:this.state.scales,centroidPts:s.getCentroidPoints(d,this.props.chr)})),n&&Object(K.jsx)(Ce,Object(o.a)(Object(o.a)({},this.props),{},{data:f,onLinearPlotZoom:this.handleLinearPlotZoom,onZoom:this.handleZoom,yScale:this.state.scales.yScale,xScale:this.state.scales.xScale,selectedSample:this.state.selectedSample,initialSelectedSample:r,rdRange:p,displayMode:l,width:600,implicitRange:this.state.implicitRange}))]}),(n||i)&&Object(K.jsx)("div",{className:n&&i?"SampleViz-clusters":"",children:Object(K.jsx)(xe,{data:s.brushedTableData(),onClusterRowsChange:function(){},onClusterColorChange:function(){},currentFilters:["-1"],colOneName:"Cluster ID",colTwoName:"Cluster (%)",colThreeName:"Selection (%)",colFourName:"Bin (%)",cols:"",expandable:!1,selectable:!1,colors:this.props.colors})})]})}}]),s}(a.a.Component),we="data:image/gif;base64,R0lGODlhEAAQAPQAAP///wAAAPDw8IqKiuDg4EZGRnp6egAAAFhYWCQkJKysrL6+vhQUFJycnAQEBDY2NmhoaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAAFdyAgAgIJIeWoAkRCCMdBkKtIHIngyMKsErPBYbADpkSCwhDmQCBethRB6Vj4kFCkQPG4IlWDgrNRIwnO4UKBXDufzQvDMaoSDBgFb886MiQadgNABAokfCwzBA8LCg0Egl8jAggGAA1kBIA1BAYzlyILczULC2UhACH5BAkKAAAALAAAAAAQABAAAAV2ICACAmlAZTmOREEIyUEQjLKKxPHADhEvqxlgcGgkGI1DYSVAIAWMx+lwSKkICJ0QsHi9RgKBwnVTiRQQgwF4I4UFDQQEwi6/3YSGWRRmjhEETAJfIgMFCnAKM0KDV4EEEAQLiF18TAYNXDaSe3x6mjidN1s3IQAh+QQJCgAAACwAAAAAEAAQAAAFeCAgAgLZDGU5jgRECEUiCI+yioSDwDJyLKsXoHFQxBSHAoAAFBhqtMJg8DgQBgfrEsJAEAg4YhZIEiwgKtHiMBgtpg3wbUZXGO7kOb1MUKRFMysCChAoggJCIg0GC2aNe4gqQldfL4l/Ag1AXySJgn5LcoE3QXI3IQAh+QQJCgAAACwAAAAAEAAQAAAFdiAgAgLZNGU5joQhCEjxIssqEo8bC9BRjy9Ag7GILQ4QEoE0gBAEBcOpcBA0DoxSK/e8LRIHn+i1cK0IyKdg0VAoljYIg+GgnRrwVS/8IAkICyosBIQpBAMoKy9dImxPhS+GKkFrkX+TigtLlIyKXUF+NjagNiEAIfkECQoAAAAsAAAAABAAEAAABWwgIAICaRhlOY4EIgjH8R7LKhKHGwsMvb4AAy3WODBIBBKCsYA9TjuhDNDKEVSERezQEL0WrhXucRUQGuik7bFlngzqVW9LMl9XWvLdjFaJtDFqZ1cEZUB0dUgvL3dgP4WJZn4jkomWNpSTIyEAIfkECQoAAAAsAAAAABAAEAAABX4gIAICuSxlOY6CIgiD8RrEKgqGOwxwUrMlAoSwIzAGpJpgoSDAGifDY5kopBYDlEpAQBwevxfBtRIUGi8xwWkDNBCIwmC9Vq0aiQQDQuK+VgQPDXV9hCJjBwcFYU5pLwwHXQcMKSmNLQcIAExlbH8JBwttaX0ABAcNbWVbKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICSRBlOY7CIghN8zbEKsKoIjdFzZaEgUBHKChMJtRwcWpAWoWnifm6ESAMhO8lQK0EEAV3rFopIBCEcGwDKAqPh4HUrY4ICHH1dSoTFgcHUiZjBhAJB2AHDykpKAwHAwdzf19KkASIPl9cDgcnDkdtNwiMJCshACH5BAkKAAAALAAAAAAQABAAAAV3ICACAkkQZTmOAiosiyAoxCq+KPxCNVsSMRgBsiClWrLTSWFoIQZHl6pleBh6suxKMIhlvzbAwkBWfFWrBQTxNLq2RG2yhSUkDs2b63AYDAoJXAcFRwADeAkJDX0AQCsEfAQMDAIPBz0rCgcxky0JRWE1AmwpKyEAIfkECQoAAAAsAAAAABAAEAAABXkgIAICKZzkqJ4nQZxLqZKv4NqNLKK2/Q4Ek4lFXChsg5ypJjs1II3gEDUSRInEGYAw6B6zM4JhrDAtEosVkLUtHA7RHaHAGJQEjsODcEg0FBAFVgkQJQ1pAwcDDw8KcFtSInwJAowCCA6RIwqZAgkPNgVpWndjdyohACH5BAkKAAAALAAAAAAQABAAAAV5ICACAimc5KieLEuUKvm2xAKLqDCfC2GaO9eL0LABWTiBYmA06W6kHgvCqEJiAIJiu3gcvgUsscHUERm+kaCxyxa+zRPk0SgJEgfIvbAdIAQLCAYlCj4DBw0IBQsMCjIqBAcPAooCBg9pKgsJLwUFOhCZKyQDA3YqIQAh+QQJCgAAACwAAAAAEAAQAAAFdSAgAgIpnOSonmxbqiThCrJKEHFbo8JxDDOZYFFb+A41E4H4OhkOipXwBElYITDAckFEOBgMQ3arkMkUBdxIUGZpEb7kaQBRlASPg0FQQHAbEEMGDSVEAA1QBhAED1E0NgwFAooCDWljaQIQCE5qMHcNhCkjIQAh+QQJCgAAACwAAAAAEAAQAAAFeSAgAgIpnOSoLgxxvqgKLEcCC65KEAByKK8cSpA4DAiHQ/DkKhGKh4ZCtCyZGo6F6iYYPAqFgYy02xkSaLEMV34tELyRYNEsCQyHlvWkGCzsPgMCEAY7Cg04Uk48LAsDhRA8MVQPEF0GAgqYYwSRlycNcWskCkApIyEAOwAAAAAAAAAAAA==",De=(s(193),function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).table_data=void 0,r.table_data=e.data,r}return Object(u.a)(s,[{key:"shouldComponentUpdate",value:function(e){return this.props.data!==e.data}},{key:"render",value:function(){var e,t=this.props,s=t.colName,r=t.data,a=[{name:s,selector:"action",compact:!0,wrap:!0}],n=[],i=Object(f.a)(r);try{for(i.s();!(e=i.n()).done;){var o=e.value;n.push(o)}}catch(l){i.e(l)}finally{i.f()}return Object(K.jsx)("div",{children:Object(K.jsx)(je.a,{columns:a,data:n,pagination:!0,paginationPerPage:5,paginationComponentOptions:{rowsPerPageText:"",selectAllRowsItem:!0},paginationRowsPerPageOptions:[5,10,15,20],noContextMenu:!0,noHeader:!0})})}}]),s}(a.a.Component)),Be=function(){function e(t,s){Object(h.a)(this,e),this._name=void 0,this._chromosomes=void 0,this._chrStarts=void 0,this._length=void 0,this.nameToChr=void 0,this._name=s||"",this._chromosomes=t,this._chrStarts={},this._length=0;var r,a=Object(f.a)(t);try{for(a.s();!(r=a.n()).done;){var n=r.value,i=n.name;if(void 0!==this._chrStarts[i])throw new Error('Duplicate chromosome name "'.concat(i,'" in genome "').concat(s,'"'));this._chrStarts[i]=this._length,this._length+=n.length}}catch(u){a.e(u)}finally{a.f()}this.nameToChr={};var o,l=Object(f.a)(this._chromosomes);try{for(l.s();!(o=l.n()).done;){var c=o.value;this.nameToChr[c.name]=c}}catch(u){l.e(u)}finally{l.f()}}return Object(u.a)(e,[{key:"getName",value:function(){return this._name}},{key:"getChromosomeList",value:function(){return this._chromosomes}},{key:"getChromosomeStarts",value:function(){var e=this;return this._chromosomes.map((function(t){return e._chrStarts[t.name]}))}},{key:"getChrStartMap",value:function(){return this._chrStarts}},{key:"getChromosomeStarts2",value:function(e,t,s){var r=this;return e.map((function(e){return r._chrStarts[e.name]}))}},{key:"getLength",value:function(e){return e?e in this._chrStarts?this._chromosomes.find((function(t){return t.name===e})).length:0:this._length}},{key:"getLength2",value:function(e){var t,s=0,r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){s+=t.value.length}}catch(a){r.e(a)}finally{r.f()}return s}},{key:"getImplicitCoordinates",value:function(e){var t=e.chr,s=e.start,r=e.end;if(!(t in this._chrStarts))throw new Error('Chromosome "'.concat(t,'" not in this genome'));var a=this._chrStarts[t];return new j(a+s,a+r)}},{key:"getChromosomeLocation",value:function(e){e<0?e=0:e>=this.getLength()&&(e=this.getLength()-1);var t=Object.values(this._chrStarts).sort((function(e,t){return e-t})),s=y.a.sortedLastIndex(t,e)-1,r=e-t[s];return new A(this._chromosomes[s].name,r,r+1)}},{key:"getChrs",value:function(e){var t,s=[],r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;s.push(this.nameToChr[a])}}catch(n){r.e(n)}finally{r.f()}return s}}]),e}();new Be([{name:"chr1",length:248956422},{name:"chr2",length:242193529},{name:"chr3",length:198295559},{name:"chr4",length:190214555},{name:"chr5",length:181538259},{name:"chr6",length:170805979},{name:"chr7",length:159345973},{name:"chr8",length:145138636},{name:"chr9",length:138394717},{name:"chr10",length:133797422},{name:"chr11",length:135086622},{name:"chr12",length:133275309},{name:"chr13",length:114364328},{name:"chr14",length:107043718},{name:"chr15",length:101991189},{name:"chr16",length:90338345},{name:"chr17",length:83257441},{name:"chr18",length:80373285},{name:"chr19",length:58617616},{name:"chr20",length:64444167},{name:"chr21",length:46709983},{name:"chr22",length:50818468}],"hg38"),s(358);function Le(e){return new Promise((function(t,s){var r=Object.keys(e[0]),a=r.slice(0,r.length-3);t(G(e,a,"\t"," "))}))}var Re=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e)).csvLink=void 0,r.csvLink=a.a.createRef(),r.state={loading:!1},r.handleFileDownload=r.handleFileDownload.bind(Object(d.a)(r)),r}return Object(u.a)(s,[{key:"handleFileDownload",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t,s,r,a,n,i,o,l,c,h,u,d,p,v,g,m,S,C,y,j,A;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),t="",e.prev=2,e.next=5,Le(this.props.data);case 5:t=e.sent,e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return");case 12:for((s=document.createElement("a")).href="data:text/tab-separated-values,"+encodeURIComponent(t),r=this.props.fileName,a=r.split("."),n="",i=0;i<a.length-1;i++)n+=a[i],i!==a.length-2&&(n+=".");o=n.split("_"),l=new Date,(c=String(l.getMonth()+1)).length<2&&(c="0"+c),(h=String(l.getDate())).length<2&&(h="0"+h),u=l.getFullYear()+c+h,d=String(l.getHours()),p=String(l.getMinutes()),v=String(l.getSeconds()),d.length<2&&(d="0"+d),p.length<2&&(p="0"+p),v.length<2&&(v="0"+v),g=d+p+v,m=[],S=Object(f.a)(this.props.logData);try{for(S.s();!(C=S.n()).done;)y=C.value,m.push(y.action)}catch(b){S.e(b)}finally{S.f()}"",j=m.join("\n"),(A=document.createElement("a")).href="data:text/plain,"+encodeURIComponent(j),A.download=o[0]+"-log_"+u+"_"+g,A.click(),s.download=o[0]+"_"+u+g+".tsv",s.click(),this.setState({loading:!1});case 44:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(K.jsxs)("div",{children:[Object(K.jsx)("button",{type:"button",onClick:this.handleFileDownload,style:{display:"none"},children:"Export"}),this.state.loading&&Object(K.jsxs)("div",{children:["Reading file... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]})]})}}]),s}(a.a.Component),Te=s(27),Ee=s(206);var Pe=function(e){var t=e.chosenFile;return t.length>35&&(t=t.substring(0,34)+"..."),Object(K.jsxs)("div",{className:e.show?"sidebar active":"sidebar",children:[Object(K.jsxs)("div",{className:"closemenu",onClick:function(){e.onSidebarChange(!e.show)},children:[Object(K.jsx)("div",{children:" "}),e.show?Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.a,{})}):Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.b,{})})]}),Object(K.jsx)("div",{className:"closemenu2",onClick:function(){return e.setDisplayMode(at.select)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.c,{color:e.currentDisplayMode===at.select?"red":"black"})})}),Object(K.jsx)("div",{className:"closemenu3",onClick:function(){return e.setDisplayMode(at.zoom)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Te.e,{color:e.currentDisplayMode===at.zoom||e.currentDisplayMode===at.boxzoom?"red":"black"})})}),Object(K.jsx)("div",{className:"closemenu4",onClick:function(){return e.setDisplayMode(at.erase)},children:Object(K.jsx)("div",{className:"arrow-container",children:Object(K.jsx)(Ee.a,{color:e.currentDisplayMode===at.erase?"red":"black"})})}),Object(K.jsxs)("div",{className:"contents",children:[Object(K.jsxs)("div",{className:"row-contents",children:[" ",Object(K.jsx)("h1",{children:"CNAViz"})," "]}),Object(K.jsx)("div",{className:"title-bar"}),Object(K.jsxs)("div",{className:"row-contents",children:[" Chosen File: ",t]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"file",id:"fileUpload",onChange:function(t){return e.onFileChosen(t,!0)}}),"Import"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)(Re,{data:e.data,logData:e.logData,fileName:e.chosenFile}),"Export"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:function(t){return e.handleDemoFileInput(!0)}}),"Demo"]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"file",id:"fileUpload",onChange:function(t){return e.onDriverFileChosen(t,!0)}}),"Import Driver Genes"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:function(t){return e.handleDemoDrivers()}}),"CGC Drivers"]})]}),Object(K.jsx)("div",{className:"row-contents",children:Object(K.jsxs)("div",{children:[Object(K.jsx)("label",{htmlFor:"Select Chromosome",style:{margin:10},children:" Chromosome: "}),Object(K.jsx)("select",{name:"Select Chromosome",id:"Select Chromosome",value:e.selectedChr,onChange:e.onChrSelected,children:e.chrOptions})]})}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Log RDR: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleLog})]}),Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Centroids: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleShowCentroids,checked:e.showCentroids,readOnly:!0})]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Scatterplots: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleScatter,checked:e.showScatter,readOnly:!0})]}),Object(K.jsxs)("label",{children:[Object(K.jsx)("span",{className:"App-CheckBox-explanation",children:"Linear Plots: "}),Object(K.jsx)("input",{type:"checkbox",onClick:e.onToggleLinear,checked:e.showLinear,readOnly:!0})]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:function(){e.onTogglesilhouettes()}}),"Analytics (s)"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onToggleShowCentroidTable}),"Centroids (c)"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onToggleDirections}),"Usage (?)"]})]}),Object(K.jsxs)("div",{className:"row-contents",children:[Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onClearClustering}),"Clear Clustering"]}),Object(K.jsxs)("label",{className:"custom-file-upload",children:[Object(K.jsx)("input",{type:"button",id:"custom-button",onClick:e.onTogglePreviousActionLog}),"Previous Actions (l)"]})]})]}),Object(K.jsx)("div",{className:"contents2",children:Object(K.jsx)(xe,{data:e.tableData,onClusterRowsChange:e.onClusterRowsChange,onClusterColorChange:e.onClusterColorChange,currentFilters:e.currentClusterFilters,colOneName:"Cluster ID",colTwoName:"Bin (%)",cols:"",expandable:!0,selectable:!0,colors:e.colors})})]})},Me=(s(194),0),Ne=0,Fe=0,Ie=0,Ue=0,Ye=0,Ge=0,He=50,ze=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e))._svg=void 0,r.state={showTooltip:!1,tooltipX:0,tooltipY:0},r._svg=null,r}return Object(u.a)(s,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"componentDidUpdate",value:function(e){this.propsDidChange(e,[])&&this.redraw()}},{key:"propsDidChange",value:function(e,t){var s=this;return t.some((function(t){return s.props[t]!==e[t]}))}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"renderTooltipContent",value:function(e){var t=this.props,s=(t.width,t.height,this.state),r=s.showTooltip;s.tooltipX,s.tooltipY;if(!e)return null;if(!r)return null;return Object(K.jsx)("div",{className:"Scatterplot-tooltip",style:{position:"absolute",top:"90%",left:"1%",pointerEvents:"none"},children:e})}},{key:"renderTooltip",value:function(){return this.renderTooltipContent(Object(K.jsx)(a.a.Fragment,{children:Object(K.jsx)("div",{children:"Note: The Silhouette coefficient ranges from -1 to 1 where the larger the number the more tightly grouped the cluster "})}))}},{key:"render",value:function(){return Object(K.jsx)("div",{id:"chart-container",children:this.renderTooltip()})}},{key:"redraw",value:function(){var e=this,t=this.props,s=t.width,r=t.height,a=t.data,n=t.colors,i=y.a.sortBy(a,"avg"),o=Ie/s*100+"%",l=Me/s*100+"%",c=Ne/s*100+"%",h=Fe/s*100+"%",u=w.j("div#chart-container").append("svg").style("padding",l+" "+c+" "+h+" "+o+" ").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 "+(s+Ue+Ge)+" "+(r+Ye+He)),d=w.i().domain([-1,1]).range([15,s-10]);u.append("text").classed("scale",!0).attr("text-anchor","middle").attr("font-size",20).attr("x",y.a.mean([15,s-10])).attr("y",r+40).text("Approximate Average Silhouette Coefficient").on("mouseover",(function(){e.setState({showTooltip:!0}),e.setState({tooltipX:w.f.offsetX,tooltipY:w.f.offsetY})})).on("mouseleave",(function(){e.setState({showTooltip:!1})})),u.append("g").attr("transform","translate(0,"+r+")").call(w.a(d)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var p=w.h().range([0,r]).domain(i.map((function(e){return String(e.cluster)}))).padding(.1);u.selectAll("myRect").data(i).enter().append("rect").attr("class",(function(e){return"bar bar--"+(e.avg<0?"negative":"positive")})).attr("x",(function(e){return d(Math.min(0,e.avg))||0})).attr("y",(function(e){return p(String(e.cluster))||0})).attr("width",(function(e){return Math.abs((d(e.avg)||0)-(d(0)||0))})).attr("height",p.bandwidth()).attr("fill",(function(e){return-1===e.cluster?"#999999":n[e.cluster%n.length]})),u.append("g").call(w.b(p).tickSize(0).tickPadding(6)).attr("transform","translate("+d(0)+",0)")}}]),s}(a.a.Component),Xe=0,Ke=0,Qe=0,Ze=0,Ve=10,Je=0,We=0,qe=50,$e=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e))._svg=void 0,r._svg=null,r}return Object(u.a)(s,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"componentDidUpdate",value:function(e){this.propsDidChange(e,["selectedCluster"])&&this.redraw()}},{key:"propsDidChange",value:function(e,t){var s=this;return t.some((function(t){return s.props[t]!==e[t]}))}},{key:"componentDidMount",value:function(){this.redraw()}},{key:"render",value:function(){var e=this,t=this.props,s=t.width,r=t.height,a=Ze/s*100+"%",n=Xe/s*100+"%",i=Ke/s*100+"%",o=Qe/s*100+"%";return Object(K.jsx)("div",{id:"chart-container2",children:Object(K.jsx)("svg",{ref:function(t){return e._svg=t},style:{padding:n+" "+i+" "+o+" "+a+" "},preserveAspectRatio:"xMinYMin meet",viewBox:"0 0 "+(s+Ve+We)+" "+(r+Je+qe)})})}},{key:"redraw",value:function(){var e=this.props,t=e.width,s=e.height,r=e.data,a=e.colors;if(this._svg){var n=[];void 0!==r&&(n=Array.from(r,(function(e){return{key:e[0],value:e[1]}}))),n=y.a.sortBy(n,"value");var i=w.j(this._svg);i.selectAll(".scales").remove();var o=y.a.maxBy(n,"value"),l=w.i().domain([0,o?o.value:1]).range([30,t-10]);i.append("text").classed("scales",!0).attr("text-anchor","middle").attr("font-size",20).attr("x",y.a.mean([0,t])).attr("y",s+40).text("Approximate Average Euclidean Distance"),i.append("g").classed("scales",!0).attr("transform","translate(0,"+s+")").call(w.a(l)).selectAll("text").attr("transform","translate(-10,0)rotate(-45)").style("text-anchor","end");var c=w.h().range([0,s]).domain(n.map((function(e){return String(e.key)}))).padding(.1);i.selectAll(".bar").remove(),i.selectAll("myRect").classed("bars",!0).data(n).enter().append("rect").attr("class",(function(e){return"bar bar--"+(e.value<0?"negative":"positive")})).attr("x",(function(e){return l(Math.min(0,e.value))||0})).attr("y",(function(e){return c(String(e.key))||0})).attr("width",(function(e){return Math.abs((l(e.value)||0)-(l(0)||0))})).attr("height",c.bandwidth()).attr("fill",(function(e){return-1===e.key?"#999999":a[e.key%a.length]})),i.append("g").classed("scales",!0).call(w.b(c).tickSize(0).tickPadding(6)).attr("transform","translate("+l.range()[0]+",0)")}}}]),s}(a.a.Component),et=(s(359),function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;return Object(h.a)(this,s),(r=t.call(this,e))._clusters=void 0,r._clusters=r.initializeListOfClusters(),r.state={selectedCluster:r._clusters[0]},r}return Object(u.a)(s,[{key:"initializeListOfClusters",value:function(){var e=this.props.clusterTableData;this._clusters=[];var t,s=Object(f.a)(e);try{for(s.s();!(t=s.n()).done;){var r=t.value;this._clusters.push(r.key)}}catch(a){s.e(a)}finally{s.f()}for(;this._clusters.length>0&&(Number(this._clusters[0])===Number("-1")||Number(this._clusters[0])===Number("-2"));)this._clusters.shift();return this._clusters}},{key:"componentDidUpdate",value:function(e){this.props.clusterTableData!==e.clusterTableData&&this.initializeListOfClusters()}},{key:"render",value:function(){var e=this,t=this.props,s=t.silhouetteData,r=t.clusterDistances,a=t.colors,n=this._clusters.map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}));return Object(K.jsxs)("div",{className:"Directions2",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Cluster Analytics "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:this.props.onToggleSilhoutteBarPlot,children:Object(K.jsx)(Te.d,{})}),Object(K.jsxs)("div",{className:"Bar-Select",children:[Object(K.jsxs)("div",{className:"ClusterDistances-Select",children:[Object(K.jsxs)("div",{className:"Overall-Average",children:[" Average Cluster Silhouette Score: ",Object(K.jsx)("b",{children:this.props.avgClusterSilhouette||0})," "]}),Object(K.jsxs)("label",{className:"cluster-select",children:[" Cluster:",Object(K.jsx)("select",{name:"Select Cluster",title:"Cluster",value:this.state.selectedCluster,onChange:function(t){e.setState({selectedCluster:t.target.value})},children:n})]})]}),Object(K.jsxs)("div",{className:"BarPlots",children:[Object(K.jsx)(ze,{width:700,height:700,data:s,avgClusterSilhouette:this.props.avgClusterSilhouette,colors:a}),Object(K.jsx)($e,{data:r.get(Number(this.state.selectedCluster)),selectedCluster:Number(this.state.selectedCluster),width:700,height:700,colors:a})]})]})]})}}]),s}(a.a.Component));function tt(e){return new Promise((function(t,s){var r=new FileReader;r.readAsText(e),r.onload=function(){t(r.result)},r.onerror=s,r.onabort=s}))}var st,rt,at,nt=["#d3fe14","#c9080a","#fec7f8","#0b7b3e","#3957ff","#0bf0e9","#c203c8","#fd9b39","#906407","#98ba7f","#fe6794","#10b0ff","#ac7bff","#fee7c0","#964c63","#1da49c","#0ad811","#bbd9fd","#fe6cfe","#d1a09c","#78579e","#81ffad","#739400","#ca6949","#d9bf01","#646a58","#d5097e","#bb73a9","#ccf6e9","#9cb4b6","#b6a7d4","#9e8c62","#6e83c8","#01af64","#a71afd","#cfe589","#d4ccd1","#fd4109","#bf8f0e","#2f786e","#4ed1a5","#d8bb7d","#a54509","#6a9276","#a4777a","#fc12c9","#606f15","#3cc4d9","#f31c4e","#73616f","#f097c6","#fc8772","#92a6fe","#875b44","#699ab3","#94bc19","#7d5bf0","#d24dfe","#c85b74","#68ff57","#b62347","#994b91","#646b8c","#977ab4","#d694fd","#c4d5b5","#fdc4bd","#1cae05","#7bd972","#e9700a","#d08f5d","#8bb9e1","#fde945","#a29d98","#1682fb","#9ad9e0","#d6cafe","#8d8328","#b091a7","#647579","#1f8d11","#e7eafd","#b9660b","#a4a644","#fec24c","#b1168c","#188cc1","#7ab297","#c949a6","#d48295","#eb6dc2","#d5b0cb","#ff9ffb","#fdb082","#af4d44","#a759c4","#a9e03a","#0d906b","#9ee3bd","#5b8846","#0d8995","#f25c58","#70ae4f","#847f74","#9094bb","#ffe2f1","#a67149","#936c8e","#d04907","#c3b8a6","#cef8c4","#7a9293","#fda2ab","#2ef6c5","#807242","#cb94cc","#b6bdd0","#b5c75d","#fde189","#b7ff80","#fa2d8e","#839a5f","#28c2b5","#e5e9e1","#bc79d8","#7ed8fe","#9f20c3","#4f7a5b","#f511fd","#09c959","#bcd0ce","#8685fd","#98fcff","#afbff9","#6d69b4","#aaa87e","#b59dfb","#d9a742","#ac5c86","#9468d5","#a4a2b2","#b1376e","#d43f3d","#05a9d1","#c38375","#24b58e","#6eabaf","#66bf7f","#92cbbb","#ddb1ee","#1be895","#c7ecf9","#a6baa6","#8045cd","#a9d796","#ce62cb","#0e954d","#a97d2f","#fcb8d3","#9bfee3","#4e8d84","#fc6d3f","#7b9fd4","#8c6165","#72805e","#d53762","#f00a1b","#de5c97","#8ea28b","#fccd95","#ba9c57","#b79a82","#7c5a82","#7d7ca4","#958ad6","#cd8126","#bdb0b7","#10e0f8","#dccc69","#d6de0f","#616d3d","#985a25","#30c7fd","#0aeb65","#e3cdb4","#bd1bee","#ad665d","#d77070","#8ea5b8","#76655e","#598100","#86757e","#5ea068","#a590b8","#c1a707","#85c0cd","#e2cde9","#dcd79c","#d8a882","#b256f9","#b13323","#519b3b","#dd80de","#f1884b","#74b2fe","#a0acd2","#d199b0","#f68392","#8ccaa0","#64d6cb","#e0f86a","#75671b","#796e87","#6d8075","#9b8a8d","#f04c71","#61bd29","#bcc18f","#fecd0f","#1e7ac9","#927261","#dc27cf","#979605","#ec9c88","#8c48a3","#676769","#546e64","#8f63a2","#b35b2d","#7b8ca2","#b87188","#4a9bda","#eb7dab","#f6a602","#cab3fe","#ddb8bb","#107959","#885973","#5e858e","#b15bad","#e107a7","#2f9dad","#4b9e83","#b992dc","#6bb0cb","#bdb363","#ccd6e4","#a3ee94","#9ef718","#fbe1d9","#a428a5","#93514c","#487434","#e8f1b6","#d00938","#fb50e1","#fa85e1","#7cd40a","#f1ade1","#b1485d","#7f76d6","#d186b3","#90c25e","#b8c813","#a8c9de","#7d30fe","#815f2d","#737f3b","#c84486","#946cfe","#e55432","#a88674","#c17a47","#b98b91","#fc4bb3","#da7f5f","#df920b","#b7bbba","#99e6d9","#a36170","#c742d8","#947f9d","#a37d93","#889072","#9b924c","#23b4bc","#e6a25f","#86df9c","#a7da6c","#3fee03","#eec9d8","#aafdcb","#7b9139","#92979c","#72788a","#994cff","#c85956","#7baa1a","#de72fe","#c7bad8","#85ebfe","#6e6089","#9b4d31","#297a1d","#9052c0","#698eba","#d46222","#6da095","#b483bb","#04d183","#9bcdfe","#2ffe8c","#9d4279","#c909aa","#826cae"];function it(e,t,s){return new Promise((function(t,r){S()(e,{cast:!0,columns:!0,delimiter:"\t",skip_empty_lines:!0},(function(e,a){if(e)r(e);else{var n,i=0,o=a[0]["#CHR"],l=[],c=Object(f.a)(a);try{for(c.s();!(n=c.n()).done;){var h=n.value;s&&void 0!==h.CLUSTER||(h.CLUSTER=-1),h.logRD=Math.log2(h.RD),o!==h["#CHR"]&&(l.push({name:o,length:i-0}),o=h["#CHR"]),i=Number(h.END),h.reverseBAF=.5-h.BAF}}catch(v){c.e(v)}finally{c.f()}l.push({name:o,length:i-0}),l.sort((function(e,t){return e.name.localeCompare(t.name,void 0,{numeric:!0,sensitivity:"base"})})),st=new Be(l);var u,d=Object(f.a)(a);try{for(d.s();!(u=d.n()).done;){var p=u.value;p.genomicPosition=st.getImplicitCoordinates(new A(p["#CHR"],p.START,p.END)).start}}catch(v){d.e(v)}finally{d.f()}t(a)}}))}))}function ot(e){return new Promise((function(t,s){S()(e,{cast:!0,columns:!0,delimiter:"\t",skip_empty_lines:!0,skip_lines_with_error:!0},(function(e,r){if(e)s(e);else{var a,n=Object(f.a)(r);try{for(n.s();!(a=n.n()).done;){var i=a.value,o=i["Genome Location"].split(":"),l=o[1].split("-"),c=new A(o[0],Number(l[0]),Number(l[1]));i.location=c}}catch(h){n.e(h)}finally{n.f()}t(r)}}))}))}!function(e){e[e.none=0]="none",e[e.readingFile=1]="readingFile",e[e.processing=2]="processing",e[e.done=3]="done",e[e.error=4]="error"}(rt||(rt={})),function(e){e[e.zoom=0]="zoom",e[e.select=1]="select",e[e.boxzoom=2]="boxzoom",e[e.erase=3]="erase"}(at||(at={}));var lt=function(e){Object(p.a)(s,e);var t=Object(v.a)(s);function s(e){var r;Object(h.a)(this,s),(r=t.call(this,e)).state={processingStatus:rt.none,indexedData:new z([]),hoveredLocation:null,selectedChr:z.ALL_CHRS_KEY,selectedCluster:z.ALL_CLUSTERS_KEY,invertAxis:!1,sampleAmount:2,showComponents:[!0,!0],color:"blue",colors:nt,assignCluster:!1,assigned:!1,applyLog:!1,applyClustering:!1,inputError:!1,value:"0",updatedBins:!1,selectedSample:"",displayMode:at.zoom,sidebar:!0,chosenFile:"",showLinearPlot:!0,showScatterPlot:!0,showDirections:!1,showLog:!1,showCentroidTable:!1,showCentroids:!1,syncScales:!1,scales:{xScale:null,yScale:null},driverGenes:null,showSilhouettes:rt.none,silhouettes:[]},r.handleFileChoosen=r.handleFileChoosen.bind(Object(d.a)(r)),r.handleDemoFileInput=r.handleDemoFileInput.bind(Object(d.a)(r)),r.handleDriverFileChosen=r.handleDriverFileChosen.bind(Object(d.a)(r)),r.handleDemoDrivers=r.handleDemoDrivers.bind(Object(d.a)(r)),r.handleChrSelected=r.handleChrSelected.bind(Object(d.a)(r)),r.handleClusterSelected=r.handleClusterSelected.bind(Object(d.a)(r)),r.handleLocationHovered=y.a.throttle(r.handleLocationHovered.bind(Object(d.a)(r)),50),r.handleAxisInvert=r.handleAxisInvert.bind(Object(d.a)(r)),r.handleAddSampleClick=r.handleAddSampleClick.bind(Object(d.a)(r)),r.handleColorChange=r.handleColorChange.bind(Object(d.a)(r)),r.handleAssignCluster=r.handleAssignCluster.bind(Object(d.a)(r)),r.handleCallBack=r.handleCallBack.bind(Object(d.a)(r)),r.handleClusterAssignmentInput=r.handleClusterAssignmentInput.bind(Object(d.a)(r)),r.updateBrushedBins=r.updateBrushedBins.bind(Object(d.a)(r)),r.onClusterRowsChange=r.onClusterRowsChange.bind(Object(d.a)(r)),r.onClusterColorChange=r.onClusterColorChange.bind(Object(d.a)(r)),r.onSelectedSample=r.onSelectedSample.bind(Object(d.a)(r)),r.handleRemovePlot=r.handleRemovePlot.bind(Object(d.a)(r)),r.setDisplayMode=r.setDisplayMode.bind(Object(d.a)(r)),r.onSideBarChange=r.onSideBarChange.bind(Object(d.a)(r)),r.toggleLog=r.toggleLog.bind(Object(d.a)(r)),r.onToggleLinear=r.onToggleLinear.bind(Object(d.a)(r)),r.onToggleScatter=r.onToggleScatter.bind(Object(d.a)(r)),r.onToggleSync=r.onToggleSync.bind(Object(d.a)(r)),r.goBackToPreviousCluster=r.goBackToPreviousCluster.bind(Object(d.a)(r)),r.handleZoom=r.handleZoom.bind(Object(d.a)(r)),r.onToggleShowCentroids=r.onToggleShowCentroids.bind(Object(d.a)(r)),r.onToggleSilhoutteBarPlot=r.onToggleSilhoutteBarPlot.bind(Object(d.a)(r)),r.onToggleDirections=r.onToggleDirections.bind(Object(d.a)(r)),r.onToggleShowCentroidTable=r.onToggleShowCentroidTable.bind(Object(d.a)(r)),r.onTogglePreviousActionLog=r.onTogglePreviousActionLog.bind(Object(d.a)(r)),r.onClearClustering=r.onClearClustering.bind(Object(d.a)(r)),r.setProcessingStatus=r.setProcessingStatus.bind(Object(d.a)(r));var a=Object(d.a)(r);return w.j("body").on("keypress",(function(){"z"===w.f.key?a.setState({displayMode:at.zoom}):"b"===w.f.key?a.setState({displayMode:at.select}):"e"===w.f.key?a.setState({displayMode:at.erase}):32===w.f.keyCode?a.onSideBarChange(!a.state.sidebar):"l"===w.f.key?a.setState({showLog:!a.state.showLog}):"c"===w.f.key?a.setState({showCentroidTable:!a.state.showCentroidTable}):"s"===w.f.key&&a.onToggleSilhoutteBarPlot()})),w.j("body").on("keydown",(function(){a.state.displayMode===at.zoom&&"Shift"===w.f.key?a.setState({displayMode:at.boxzoom}):"/"===w.f.key||"?"===w.f.key?a.setState({showDirections:!0}):a.state.displayMode!==at.zoom&&a.state.displayMode!==at.erase||"Meta"!==w.f.key?a.state.displayMode!==at.zoom&&a.state.displayMode!==at.select||"Alt"!==w.f.key||a.setState({displayMode:at.erase}):a.setState({displayMode:at.select})})),w.j("body").on("keyup",(function(){a.state.displayMode===at.boxzoom&&"Shift"===w.f.key?a.setState({displayMode:at.zoom}):"/"===w.f.key||"?"===w.f.key?a.setState({showDirections:!1}):(a.state.displayMode===at.select&&"Meta"===w.f.key||a.state.displayMode===at.erase&&"Alt"===w.f.key)&&a.setState({displayMode:at.zoom})})),r}return Object(u.a)(s,[{key:"handleFileChoosen",value:function(){var e=Object(c.a)(b.a.mark((function e(t,s){var r,a,n,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t.target.files)&&r[0]){e.next=3;break}return e.abrupt("return");case 3:return this.setState({chosenFile:r[0].name}),this.setState({processingStatus:rt.readingFile}),a="",e.prev=6,e.next=9,tt(r[0]);case 9:a=e.sent,e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(6),console.error(e.t0),this.setState({processingStatus:rt.error}),e.abrupt("return");case 17:return this.setState({processingStatus:rt.processing}),n=null,e.prev=19,e.next=22,it(a,this.state.applyLog,s);case 22:i=e.sent,n=new z(i),e.next=31;break;case 26:return e.prev=26,e.t1=e.catch(19),console.error(e.t1),this.setState({processingStatus:rt.error}),e.abrupt("return");case 31:this.setState({indexedData:n,processingStatus:rt.done});case 32:case"end":return e.stop()}}),e,this,[[6,12],[19,26]])})));return function(t,s){return e.apply(this,arguments)}}()},{key:"handleDemoFileInput",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var s=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({chosenFile:"a12.tsv"}),this.setState({processingStatus:rt.readingFile}),fetch("https://raw.githubusercontent.com/elkebir-group/cnaviz/master/data/demo/a12.tsv").then((function(e){return e.text()})).then((function(e){s.setState({processingStatus:rt.processing});it(e,s.state.applyLog,t).then((function(e){var t=new z(e);s.setState({indexedData:t,processingStatus:rt.done})})).catch((function(e){console.error(e),s.setState({processingStatus:rt.error})}))}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setProcessingStatus",value:function(e){this.setState({processingStatus:e})}},{key:"handleDriverFileChosen",value:function(){var e=Object(c.a)(b.a.mark((function e(t){var s,r,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((s=t.target.files)&&s[0]){e.next=3;break}return e.abrupt("return");case 3:return r="",e.prev=4,e.next=7,tt(s[0]);case 7:r=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(e.t0),e.abrupt("return");case 14:return a=null,e.prev=15,e.next=18,ot(r);case 18:n=e.sent,a=n,e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(15),console.error(e.t1),e.abrupt("return");case 26:this.setState({driverGenes:a});case 27:case"end":return e.stop()}}),e,this,[[4,10],[15,22]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleDemoDrivers",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://raw.githubusercontent.com/elkebir-group/cnaviz/master/data/demo/drivers.tsv").then((function(e){return e.text()})).then((function(e){ot(e).then((function(e){t.setState({driverGenes:e})})).catch((function(e){console.error(e)}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChrSelected",value:function(e){this.setState({selectedChr:e.target.value}),this.state.indexedData.setChrFilter(e.target.value)}},{key:"handleClusterSelected",value:function(e){this.setState({selectedCluster:e.target.value}),this.state.indexedData.setClusterFilters([e.target.value])}},{key:"handleLocationHovered",value:function(e){e?this.setState({hoveredLocation:e}):this.setState({hoveredLocation:null})}},{key:"handleClusterAssignmentInput",value:function(e){this.setState({value:e.target.value})}},{key:"handleCallBack",value:function(e){this.state.indexedData.updateCluster(Number(e)),this.setState({assignCluster:!1}),this.state.indexedData.setChrFilter(this.state.selectedChr)}},{key:"updateBrushedBins",value:function(e){this.state.indexedData.setbrushedBins(e),this.setState({updatedBins:!0})}},{key:"handleAxisInvert",value:function(){this.setState({invertAxis:!this.state.invertAxis})}},{key:"handleAddSampleClick",value:function(){var e=this.state.showComponents.concat([!0]);this.setState({showComponents:e}),this.setState({sampleAmount:this.state.sampleAmount+1})}},{key:"handleRemovePlot",value:function(e){var t=Object(l.a)(this.state.showComponents);t.splice(e,1),this.setState({showComponents:t}),this.setState({sampleAmount:this.state.sampleAmount-1})}},{key:"handleAssignCluster",value:function(){this.setState({assignCluster:!this.state.assignCluster})}},{key:"handleColorChange",value:function(e){this.setState({color:e.hex})}},{key:"getStatusCaption",value:function(){switch(this.state.processingStatus){case rt.readingFile:return Object(K.jsxs)("div",{children:["Reading file... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]});case rt.processing:return Object(K.jsxs)("div",{children:["Processing data... ",Object(K.jsx)("img",{src:we,alt:"Loading"})]});case rt.error:return"ERROR";case rt.none:case rt.done:default:return""}}},{key:"onToggleDirections",value:function(){this.setState({showDirections:!this.state.showDirections})}},{key:"toggleLog",value:function(){this.setState({applyLog:!this.state.applyLog}),this.state.indexedData.setShouldRecalculatesilhouettes(!0)}},{key:"toggleClustering",value:function(){this.setState({applyClustering:!this.state.applyClustering})}},{key:"onClusterRowsChange",value:function(e){this.state.indexedData.setClusterFilters(e.selectedRows.map((function(e){return String(e.key)}))),this.setState({indexedData:this.state.indexedData})}},{key:"onClusterColorChange",value:function(e){var t,s=[],r=Object(f.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;s.push(a)}}catch(n){r.e(n)}finally{r.f()}this.setState({colors:s})}},{key:"onSelectedSample",value:function(e){this.setState({selectedSample:e})}},{key:"setDisplayMode",value:function(e){this.setState({displayMode:e})}},{key:"onSideBarChange",value:function(e){this.setState({sidebar:e})}},{key:"onToggleScatter",value:function(){this.setState({showScatterPlot:!this.state.showScatterPlot})}},{key:"onToggleLinear",value:function(){this.setState({showLinearPlot:!this.state.showLinearPlot})}},{key:"onToggleSync",value:function(){this.setState({syncScales:!this.state.syncScales})}},{key:"onToggleShowCentroids",value:function(){this.setState({showCentroids:!this.state.showCentroids})}},{key:"onToggleShowCentroidTable",value:function(){this.setState({showCentroidTable:!this.state.showCentroidTable})}},{key:"goBackToPreviousCluster",value:function(){this.state.indexedData.undoClusterUpdate(),this.setState({indexedData:this.state.indexedData})}},{key:"handleZoom",value:function(e){this.setState({scales:e})}},{key:"onTogglePreviousActionLog",value:function(){this.setState({showLog:!this.state.showLog})}},{key:"onClearClustering",value:function(){this.state.indexedData.clearClustering(),this.setState({indexedData:this.state.indexedData})}},{key:"onToggleSilhoutteBarPlot",value:function(){var e=Object(c.a)(b.a.mark((function e(){var t=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({processingStatus:rt.processing}),this.state.showSilhouettes===rt.none?(this.setState({showSilhouettes:rt.processing}),this.state.indexedData.recalculatesilhouettes(this.state.applyLog).then((function(e){void 0!==e&&(t.setState({silhouettes:e}),t.setState({showSilhouettes:rt.done}))}))):this.setState({showSilhouettes:rt.none}),this.setState({processingStatus:rt.done});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,s=t.indexedData,r=t.selectedChr,a=t.selectedCluster,n=t.hoveredLocation,i=t.invertAxis,l=t.color,c=t.assignCluster,h=t.updatedBins,u=t.value,d=t.sampleAmount,p=s.getSampleList(),v=s.getBrushedBins(),f=s.getAllRecords(),g=null,b=s.getClusterTableInfo(),m=[Object(K.jsx)("option",{value:z.ALL_CHRS_KEY,children:"ALL"},z.ALL_CHRS_KEY)],S=s.getActions();if(this.state.processingStatus===rt.done&&!s.isEmpty()){var C=s.getClusterTableInfo(),j={data:s,hoveredLocation:n||void 0,onLocationHovered:this.handleLocationHovered,invertAxis:i,chr:r,cluster:a,customColor:l,colors:this.state.colors,assignCluster:c,onBrushedBinsUpdated:this.updateBrushedBins,parentCallBack:this.handleCallBack,brushedBins:v,updatedBins:h,onSelectedSample:this.onSelectedSample,selectedSample:this.state.selectedSample,dispMode:this.state.displayMode,onRemovePlot:this.handleRemovePlot,onAddSample:this.handleAddSampleClick,clusterTableData:C,applyLog:this.state.applyLog,onClusterSelected:this.handleClusterSelected,onUndoClick:this.goBackToPreviousCluster,showCentroids:this.state.showCentroids,driverGenes:this.state.driverGenes};(m=s.getAllChromosomes().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)}))).push(Object(K.jsx)("option",{value:z.ALL_CHRS_KEY,children:"ALL"},z.ALL_CHRS_KEY)),s.getAllClusters().map((function(e){return Object(K.jsx)("option",{value:e,children:e},e)})).push(Object(K.jsx)("option",{value:z.ALL_CLUSTERS_KEY,children:"ALL"},z.ALL_CLUSTERS_KEY)),g=Object(K.jsx)("div",{id:"grid-container",children:Object(K.jsx)("div",{className:"sampleviz-wrapper-row",children:y.a.times(d,(function(t){return p.length>t&&e.state.showComponents[t]&&Object(K.jsx)(ke,Object(o.a)(Object(o.a)({},j),{},{initialSelectedSample:p[t],plotId:t,showLinearPlot:e.state.showLinearPlot,showScatterPlot:e.state.showScatterPlot,showSidebar:e.state.sidebar,sampleAmount:d,syncScales:e.state.syncScales,handleZoom:e.handleZoom,scales:e.state.scales}),t)}))})})}var A=this.getStatusCaption();return Object(K.jsxs)("div",{className:"container-fluid",children:[Object(K.jsx)("div",{children:Object(K.jsx)(Pe,{selectedChr:r,onChrSelected:this.handleChrSelected,chrOptions:m,onAddSample:this.handleAddSampleClick,onAssignCluster:this.handleAssignCluster,tableData:b,onClusterRowsChange:this.onClusterRowsChange,onClusterColorChange:this.onClusterColorChange,currentClusterFilters:s.getFilteredClusters(),handleClusterAssignmentInput:this.handleClusterAssignmentInput,value:u,setDisplayMode:this.setDisplayMode,currentDisplayMode:this.state.displayMode,colors:this.state.colors,onSidebarChange:this.onSideBarChange,data:f,onFileChosen:this.handleFileChoosen,chosenFile:this.state.chosenFile,show:this.state.sidebar,onToggleLog:this.toggleLog,onToggleLinear:this.onToggleLinear,onToggleScatter:this.onToggleScatter,showScatter:this.state.showScatterPlot,showLinear:this.state.showLinearPlot,onToggleSync:this.onToggleSync,syncScales:this.state.syncScales,logData:S,onToggleShowCentroids:this.onToggleShowCentroids,showCentroids:this.state.showCentroids,onDriverFileChosen:this.handleDriverFileChosen,onTogglesilhouettes:this.onToggleSilhoutteBarPlot,showSilhouettes:this.state.showSilhouettes,onToggleDirections:this.onToggleDirections,onToggleShowCentroidTable:this.onToggleShowCentroidTable,onTogglePreviousActionLog:this.onTogglePreviousActionLog,onClearClustering:this.onClearClustering,handleDemoFileInput:this.handleDemoFileInput,handleDemoDrivers:this.handleDemoDrivers,setProcessingStatus:this.setProcessingStatus})}),Object(K.jsxs)("div",{className:this.state.sidebar?"marginContent":"",children:[A&&Object(K.jsx)("div",{className:"App-status-pane",children:A}),g,this.state.showDirections&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showDirections&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:"Directions"}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:this.onToggleDirections,children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)("h5",{children:" Selection "}),Object(K.jsx)("li",{children:' Hold down "Command/Control" in Zoom mode to temporarily enter add-to-selection mode '}),Object(K.jsx)("li",{children:' Hold down "Alt" in Zoom mode to temporarily enter remove-from-selection mode '}),Object(K.jsx)("li",{children:" To completely clear your selection, click anywhere in the plot while in add-to-selection or remove-from-selection modes "}),Object(K.jsx)("li",{children:" To stay in add-to-select mode without holding a button, you can click b or click the mouse pointer button next to the sidebar"}),Object(K.jsx)("li",{children:" To stay in remove-from-select mode without holding a button, you can click e or click the eraser icon next to the sidebar "}),Object(K.jsx)("h5",{children:" Zoom/Pan Mode "}),Object(K.jsx)("li",{children:" To enter zoom/pan mode, click the magnifying glass icon next to the sidebar "}),Object(K.jsx)("li",{children:" In zoom mode, if you hold down shift, it will act as a bounding box zoom "}),Object(K.jsx)("li",{children:" To pan, just click and drag on the scatter plot or axes "}),Object(K.jsx)("h5",{children:" Other Key Modifiers "}),Object(K.jsx)("li",{children:' Click "l" to toggle a log of previous actions '}),Object(K.jsx)("li",{children:" Click space to toggle the sidebar "}),Object(K.jsx)("li",{children:' Hold down "?" or "/" button to open direction panel '}),Object(K.jsx)("li",{children:' Click "c" to toggle a table of the centroids of each cluster for each sample '}),Object(K.jsx)("li",{children:' Click "s" to toggle a bar plot displaying approximate average silhoutte scores for each cluster '})]}),this.state.showLog&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showLog&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Previous Actions "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:function(){return e.setState({showLog:!e.state.showLog})},children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)(De,{data:S,onClusterColorChange:this.onClusterColorChange,onClusterRowsChange:this.onClusterRowsChange,colName:"Actions (Starting from most recent)"})]}),this.state.showCentroidTable&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showCentroidTable&&Object(K.jsxs)("div",{className:"Directions",children:[Object(K.jsx)("h2",{className:"pop-up-window-header",children:" Centroid Table "}),Object(K.jsx)("div",{className:"Exit-Popup",onClick:function(){return e.setState({showCentroidTable:!e.state.showCentroidTable})},children:Object(K.jsx)(Te.d,{})}),Object(K.jsx)(xe,{data:s.getCentroidData(),onClusterColorChange:this.onClusterColorChange,onClusterRowsChange:this.onClusterRowsChange,colors:nt,currentFilters:[""],centroidTable:!0,colOneName:"Cluster",colTwoName:"Sample",colThreeName:"Centroid",cols:[{name:"Cluster",type:"key"},{name:"Sample",type:"sample"},{name:"Centroid",type:"centroid"}]})]}),this.state.showSilhouettes===rt.done&&Object(K.jsx)("div",{className:"black_overlay"}),this.state.showSilhouettes===rt.done&&Object(K.jsx)(et,{silhouetteData:this.state.silhouettes,avgClusterSilhouette:this.state.indexedData.getAvgSilhouette(),clusterDistances:this.state.indexedData.getClusterDistanceMatrix(),clusterTableData:b,colors:nt,onToggleSilhoutteBarPlot:this.onToggleSilhoutteBarPlot})]})]})}}]),s}(a.a.Component);i.a.render(Object(K.jsx)(lt,{}),document.getElementById("root"))}},[[361,1,2]]]);
//# sourceMappingURL=main.37417e4e.chunk.js.map